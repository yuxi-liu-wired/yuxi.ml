<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yuxi Liu">
<meta name="dcterms.date" content="2024-05-04">
<meta name="description" content="What every graduate student should know about analytical mechanics, delivered with economic style and many illustrations. Particular focus on particle-wave duality and old quantum theory. Prerequisites: multivariate calculus and mathematical maturity.">

<title>Analytical Mechanics – Yuxi on the Wired</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../img/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-c590cb3103796f9f406a17afdd3881b8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-493ec8732bc442be923a7677f0a4f8b4.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../../site_libs/bootstrap/bootstrap-c590cb3103796f9f406a17afdd3881b8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Analytical Mechanics – Yuxi on the Wired">
<meta property="og:description" content="What every graduate student should know about analytical mechanics, delivered with economic style and many illustrations. Particular focus on particle-wave duality and old quantum theory. Prerequisites: multivariate calculus and mathematical maturity.">
<meta property="og:image" content="https://yuxi.ml/essays/posts/analytical-mechanics/figure/banner/banner_1.png">
<meta property="og:site_name" content="Yuxi on the Wired">
<meta property="og:image:height" content="768">
<meta property="og:image:width" content="1232">
<meta property="og:image:alt" content="A brutalist representation of the particle-wave duality of the Hamiltonian--Jacobi equation. The stacked platforms represent the Hamilton principal function according to the field-theoretic wave interpretation, and the steel rebars are the characteristic rays, with balls rolling along them representing the particle interpretation. Made in Ideogram V1 with the following prompt: 'A brutalist terraced mountain made of concrete and steel rebar. There are ripples parallel to the ground. The steel rebars go downhill, and many marbles are rolling down along the steel rebars. White background. High contrast, grayscale, black-and-white minimalistic, in the flat style of vector svg art, conceptual art'">
<meta name="twitter:title" content="Analytical Mechanics – Yuxi on the Wired">
<meta name="twitter:description" content="What every graduate student should know about analytical mechanics, delivered with economic style and many illustrations. Particular focus on particle-wave duality and old quantum theory. Prerequisites: multivariate calculus and mathematical maturity.">
<meta name="twitter:image" content="https://yuxi.ml/essays/posts/analytical-mechanics/figure/banner/banner_1.png">
<meta name="twitter:image-height" content="768">
<meta name="twitter:image-width" content="1232">
<meta name="twitter:image:alt" content="A brutalist representation of the particle-wave duality of the Hamiltonian--Jacobi equation. The stacked platforms represent the Hamilton principal function according to the field-theoretic wave interpretation, and the steel rebars are the characteristic rays, with balls rolling along them representing the particle interpretation. Made in Ideogram V1 with the following prompt: 'A brutalist terraced mountain made of concrete and steel rebar. There are ripples parallel to the ground. The steel rebars go downhill, and many marbles are rolling down along the steel rebars. White background. High contrast, grayscale, black-and-white minimalistic, in the flat style of vector svg art, conceptual art'">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed slimcontent quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../img/favicon.ico" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Yuxi on the Wired</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../essays/index.html"> 
<span class="menu-text">Essays</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../sketches/index.html"> 
<span class="menu-text">Sketches</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../logs/index.html"> 
<span class="menu-text">Logs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../notes/index.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../docs/index.html"> 
<span class="menu-text">Docs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:yuxi_liu@berkeley.com"> <i class="bi bi-envelope" role="img" aria-label="email">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../feeds.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Analytical Mechanics</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                  <div>
        <div class="description">
          What every graduate student should know about analytical mechanics, delivered with economic style and many illustrations. Particular focus on particle-wave duality and old quantum theory. Prerequisites: multivariate calculus and mathematical maturity.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">math</div>
                <div class="quarto-category">physics</div>
                <div class="quarto-category">philosophy</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Yuxi Liu </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 4, 2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">May 4, 2024</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#what-this-essay-contains" id="toc-what-this-essay-contains" class="nav-link" data-scroll-target="#what-this-essay-contains">What this essay contains</a></li>
  <li><a href="#conventions" id="toc-conventions" class="nav-link" data-scroll-target="#conventions">Conventions</a></li>
  <li><a href="#why-i-wrote-this" id="toc-why-i-wrote-this" class="nav-link" data-scroll-target="#why-i-wrote-this">Why I wrote this</a></li>
  </ul></li>
  <li><a href="#optimization-as-making-money" id="toc-optimization-as-making-money" class="nav-link" data-scroll-target="#optimization-as-making-money">Optimization as making money</a>
  <ul class="collapse">
  <li><a href="#the-shortest-line-problem" id="toc-the-shortest-line-problem" class="nav-link" data-scroll-target="#the-shortest-line-problem">The shortest line problem</a></li>
  <li><a href="#economic-interpretation" id="toc-economic-interpretation" class="nav-link" data-scroll-target="#economic-interpretation">Economic interpretation</a></li>
  <li><a href="#lagranges-devil-at-disneyland" id="toc-lagranges-devil-at-disneyland" class="nav-link" data-scroll-target="#lagranges-devil-at-disneyland">Lagrange’s devil at Disneyland</a></li>
  <li><a href="#isoperimetric-problem" id="toc-isoperimetric-problem" class="nav-link" data-scroll-target="#isoperimetric-problem">Isoperimetric problem</a></li>
  </ul></li>
  <li><a href="#lagrangian-and-hamiltonian-mechanics" id="toc-lagrangian-and-hamiltonian-mechanics" class="nav-link" data-scroll-target="#lagrangian-and-hamiltonian-mechanics">Lagrangian and Hamiltonian mechanics</a>
  <ul class="collapse">
  <li><a href="#derivatives-of-h" id="toc-derivatives-of-h" class="nav-link" data-scroll-target="#derivatives-of-h">Derivatives of <span class="math inline">\(H\)</span></a></li>
  <li><a href="#hamiltonian-equations-of-motion" id="toc-hamiltonian-equations-of-motion" class="nav-link" data-scroll-target="#hamiltonian-equations-of-motion">Hamiltonian equations of motion</a></li>
  <li><a href="#eulerlagrange-equations-of-motion" id="toc-eulerlagrange-equations-of-motion" class="nav-link" data-scroll-target="#eulerlagrange-equations-of-motion">Euler–Lagrange equations of motion</a></li>
  <li><a href="#what-does-it-all-mean" id="toc-what-does-it-all-mean" class="nav-link" data-scroll-target="#what-does-it-all-mean">What does it all mean?</a></li>
  <li><a href="#cyclic-coordinates" id="toc-cyclic-coordinates" class="nav-link" data-scroll-target="#cyclic-coordinates">Cyclic coordinates</a></li>
  <li><a href="#bonus-routhian-mechanics" id="toc-bonus-routhian-mechanics" class="nav-link" data-scroll-target="#bonus-routhian-mechanics">Bonus: Routhian mechanics</a></li>
  </ul></li>
  <li><a href="#bonus-higher-order-lagrangians-and-hamiltonians" id="toc-bonus-higher-order-lagrangians-and-hamiltonians" class="nav-link" data-scroll-target="#bonus-higher-order-lagrangians-and-hamiltonians">Bonus: Higher-order Lagrangians and Hamiltonians</a>
  <ul class="collapse">
  <li><a href="#when-lagrangian-also-depends-on-acceleration" id="toc-when-lagrangian-also-depends-on-acceleration" class="nav-link" data-scroll-target="#when-lagrangian-also-depends-on-acceleration">When Lagrangian also depends on acceleration</a></li>
  <li><a href="#ostrogradsky-instability-and-the-anthropic-principle" id="toc-ostrogradsky-instability-and-the-anthropic-principle" class="nav-link" data-scroll-target="#ostrogradsky-instability-and-the-anthropic-principle">Ostrogradsky instability and the anthropic principle</a></li>
  <li><a href="#hamiltonian-equations" id="toc-hamiltonian-equations" class="nav-link" data-scroll-target="#hamiltonian-equations">Hamiltonian equations</a></li>
  <li><a href="#eulerlagrange-equations" id="toc-eulerlagrange-equations" class="nav-link" data-scroll-target="#eulerlagrange-equations">Euler–Lagrange equations</a></li>
  <li><a href="#an-unstable-higher-order-oscillator" id="toc-an-unstable-higher-order-oscillator" class="nav-link" data-scroll-target="#an-unstable-higher-order-oscillator">An unstable higher-order oscillator</a></li>
  </ul></li>
  <li><a href="#hamiltonjacobi-equation" id="toc-hamiltonjacobi-equation" class="nav-link" data-scroll-target="#hamiltonjacobi-equation">Hamilton–Jacobi equation</a>
  <ul class="collapse">
  <li><a href="#billiards-in-a-circular-board" id="toc-billiards-in-a-circular-board" class="nav-link" data-scroll-target="#billiards-in-a-circular-board">Billiards in a circular board</a></li>
  <li><a href="#hamiltons-principal-function" id="toc-hamiltons-principal-function" class="nav-link" data-scroll-target="#hamiltons-principal-function">Hamilton’s principal function</a></li>
  <li><a href="#hamiltonjacobi-equation-1" id="toc-hamiltonjacobi-equation-1" class="nav-link" data-scroll-target="#hamiltonjacobi-equation-1">Hamilton–Jacobi equation</a></li>
  <li><a href="#hamilton-characteristic-function" id="toc-hamilton-characteristic-function" class="nav-link" data-scroll-target="#hamilton-characteristic-function">Hamilton characteristic function</a></li>
  <li><a href="#two-more-proofs-of-hje" id="toc-two-more-proofs-of-hje" class="nav-link" data-scroll-target="#two-more-proofs-of-hje">Two more proofs of HJE</a></li>
  <li><a href="#bonus-noethers-theorem" id="toc-bonus-noethers-theorem" class="nav-link" data-scroll-target="#bonus-noethers-theorem">Bonus: Noether’s theorem</a></li>
  </ul></li>
  <li><a href="#sec-geometric-optics" id="toc-sec-geometric-optics" class="nav-link" data-scroll-target="#sec-geometric-optics">Hamiltonian optics</a>
  <ul class="collapse">
  <li><a href="#isotropic-case" id="toc-isotropic-case" class="nav-link" data-scroll-target="#isotropic-case">Isotropic case</a></li>
  <li><a href="#anisotropic-case" id="toc-anisotropic-case" class="nav-link" data-scroll-target="#anisotropic-case">Anisotropic case</a></li>
  </ul></li>
  <li><a href="#the-particle-wave-duality" id="toc-the-particle-wave-duality" class="nav-link" data-scroll-target="#the-particle-wave-duality">The particle-wave duality</a>
  <ul class="collapse">
  <li><a href="#particle-in-free-space" id="toc-particle-in-free-space" class="nav-link" data-scroll-target="#particle-in-free-space">Particle in free space</a></li>
  <li><a href="#particle-wave-in-free-space" id="toc-particle-wave-in-free-space" class="nav-link" data-scroll-target="#particle-wave-in-free-space">Particle-wave in free space</a></li>
  <li><a href="#particle-in-a-potential-field" id="toc-particle-in-a-potential-field" class="nav-link" data-scroll-target="#particle-in-a-potential-field">Particle in a potential field</a></li>
  <li><a href="#deriving-the-time-independent-schrödinger-equation" id="toc-deriving-the-time-independent-schrödinger-equation" class="nav-link" data-scroll-target="#deriving-the-time-independent-schrödinger-equation">Deriving the time-independent Schrödinger equation</a></li>
  <li><a href="#relativistic-particle-in-free-space" id="toc-relativistic-particle-in-free-space" class="nav-link" data-scroll-target="#relativistic-particle-in-free-space">Relativistic particle in free space</a></li>
  </ul></li>
  <li><a href="#periodic-motion" id="toc-periodic-motion" class="nav-link" data-scroll-target="#periodic-motion">Periodic motion</a>
  <ul class="collapse">
  <li><a href="#oscillator-on-a-line" id="toc-oscillator-on-a-line" class="nav-link" data-scroll-target="#oscillator-on-a-line">Oscillator on a line</a></li>
  <li><a href="#action-angle-variables" id="toc-action-angle-variables" class="nav-link" data-scroll-target="#action-angle-variables">Action-angle variables</a></li>
  <li><a href="#adiabaticity" id="toc-adiabaticity" class="nav-link" data-scroll-target="#adiabaticity">Adiabaticity</a></li>
  </ul></li>
  <li><a href="#old-quantum-mechanics" id="toc-old-quantum-mechanics" class="nav-link" data-scroll-target="#old-quantum-mechanics">Old quantum mechanics</a>
  <ul class="collapse">
  <li><a href="#the-adiabatic-hypothesis" id="toc-the-adiabatic-hypothesis" class="nav-link" data-scroll-target="#the-adiabatic-hypothesis">The adiabatic hypothesis</a></li>
  <li><a href="#the-bohrsommerfeld-model" id="toc-the-bohrsommerfeld-model" class="nav-link" data-scroll-target="#the-bohrsommerfeld-model">The Bohr–Sommerfeld model</a></li>
  <li><a href="#the-einsteinbrillouinkeller-quantization" id="toc-the-einsteinbrillouinkeller-quantization" class="nav-link" data-scroll-target="#the-einsteinbrillouinkeller-quantization">The Einstein—Brillouin–Keller quantization</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">






<p><small>Plotting code for the essay is in a <a href="./figure/analytical_mechanics_plotting.ipynb">Jupyter notebook</a>.</small></p>
<section id="introduction" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<section id="what-this-essay-contains" class="level3">
<h3 class="anchored" data-anchor-id="what-this-essay-contains">What this essay contains</h3>
<p>This essay works through what is typically contained in a university course on analytical mechanics. The prerequisites are multivariate calculus and mathematical maturity.</p>
<p>It covers: calculus of variations, Lagrangian, Legendre transform, Hamiltonian, Hamilton’s principal function, Hamilton–Jacobi equation, the particle-wave duality, Schrödinger’s equation, Hamilton’s geometric optics, action-angle variables, Noether’s theorem, adiabaticity, old quantum theory, Bohr–Sommerfeld quantization, Einstein–Brillouin–Keller quantization.</p>
<p>It does not cover: canonical transforms, Poisson bracket, infinitesimal generator, symplectic geometry, symplectic form.</p>
<p>Philosophically, this essay has two undercurrents:</p>
<p>One, that <a href="https://en.wikipedia.org/wiki/Marginalism">thinking on the margins</a> is vital not just in economics, but also in classical mechanics. In my other essay, <a href="https://yuxi-liu-wired.github.io/essays/posts/equilibrium-thermoeconomics"><em>Classical thermodynamics and economics</em></a>, I show that classical thermodynamics is also nothing more than thinking on the margins.</p>
<p>Two, classical mechanics is a leakless leaky abstraction. Though classical mechanics has many equivalent forms, the search for the most elegant form has led us to the Hamilton–Jacobi equation, and the adiabatic theorem, both of which were on the threshold of quantum mechanics. Even though classical mechanics is a self-consistent closed world (thus “leakless”), when viewed in the right light, all its lines and planes seem to angle towards a truer world (thus “leaky”), of which this world is merely a shadow (thus “abstraction”).</p>
</section>
<section id="conventions" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="conventions">Conventions</h3>
<p>We always assume all functions are analytic (that is, they have Taylor expansions).</p>
<p>We would often say “minimize cost” or “maximize revenue” or such, but we always mean “stationarize”. For example, when we say “Let’s maximize <span class="math inline">\(f(x)\)</span>”, what we mean is “Let’s solve <span class="math inline">\(f'(x) = 0\)</span>”. If we were to actually maximize <span class="math inline">\(f(x)\)</span>, we would have to check <span class="math inline">\(f''(x) &lt; 0\)</span> as well, but we don’t. This is not a problem for physics, where the principle of <em>stationary</em> action rules. However, in optimal control and economics, we should check if the solution is actually a minimum/maximum.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Thus, the analogy between classical mechanics and economics is not precise. However, the analogy is precise between classical thermodynamics and economics, since the entropy is actually maximized, and not merely stationarized.</p></div></div><p>Instead of laboriously typing <span class="math inline">\(\vec q\)</span> or <span class="math inline">\(\mathbf{q}\)</span>, I just write <span class="math inline">\(q = (q_1, \dots, q_n)\)</span>, unless there is a serious risk of confusion.</p>
<table class="caption-top table">
<caption>Reference table for the economics-mechanics analogy.</caption>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Mechanics</th>
<th>Economics</th>
<th>Control Theory</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(L\)</span></td>
<td>Lagrangian</td>
<td>time-rate of cost</td>
<td>time-rate of cost</td>
</tr>
<tr class="even">
<td><span class="math inline">\(t\)</span></td>
<td>time</td>
<td>time</td>
<td>time</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(q\)</span></td>
<td>location/coordinate</td>
<td>commodity</td>
<td>state variable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\dot q\)</span></td>
<td>velocity</td>
<td>production rate/consumption rate</td>
<td>control variable</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(S = \int L(t, q, \dot q)dt\)</span></td>
<td>action</td>
<td>total cost</td>
<td>total cost</td>
</tr>
<tr class="even">
<td><span class="math inline">\(p\)</span></td>
<td>momentum</td>
<td>price</td>
<td>co-state variable</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(H = \sum_i p_i\dot q_i - L\)</span></td>
<td>Hamiltonian</td>
<td>market equivalent cash flow<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></td>
<td>Hamiltonian</td>
</tr>
</tbody>
</table>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;also known as “<a href="https://en.wikipedia.org/wiki/Mark-to-market_accounting">mark to market</a> cash flow”</p></div></div></section>
<section id="why-i-wrote-this" class="level3">
<h3 class="anchored" data-anchor-id="why-i-wrote-this">Why I wrote this</h3>
<p>I wrote this as “Analytical Mechanics done right”, or “What every graduate student in physics should know about analytical mechanics, but didn’t learn well, because the textbooks are filled with too many symbols and not enough pictures.”, or “what I wish the textbooks to have said when I first learned the subject”.</p>
<p>In my physics Olympiad years, I saw the Lagrangian a few times, but we had no use for that. During my undergraduate years, I studied analytical mechanics. The construction of the Lagrangian was reasonable enough, and I understood how the Euler–Lagrange equation was derived by <span class="math inline">\(\delta \int L = 0\)</span>. However, as soon as they proceeded to the Hamiltonian, I was entirely lost.</p>
<p>What is <span class="math inline">\(H(p, q) = p \dot q - L(q, \dot q)\)</span>? Why does the right side depend on <span class="math inline">\(\dot q\)</span> but not the left side? How does anyone just <em>make up</em> the Legendre transform out of thin air? It’s named “Legendre transform” – well, if it has such a fancy name, surely this has many more applications than <span class="math inline">\(H = p \dot q - L\)</span>, else, why not call it “Legendre’s one-time trick”? Canonical transform? Point transform? Aren’t they all coordinate transforms? Poisson bracket? Infinitesimal generators? It was all a giant mess. Reading Goldstein’s classic textbook only made my confusion more well-rounded.</p>
<p>Early 2023, I studied mathematical microeconomics. When I was studying <a href="https://en.wikipedia.org/wiki/Ramsey%E2%80%93Cass%E2%80%93Koopmans_model">Ramsey’s theory of optimal saving</a>, I saw, to my great surprise, something they call a “Hamiltonian” <span class="citation" data-cites="campanteAdvancedMacroeconomicsEasy2021">(<a href="#ref-campanteAdvancedMacroeconomicsEasy2021" role="doc-biblioref">Campante, Sturzenegger, and Velasco 2021, chap. 3</a>)</span>. I was shocked, but after studying it carefully, and thinking it over, I realized that it was no mistake – the “Hamiltonian” in economics and in physics really are the same. Physics has an economic interpretation. Everything fell into place over the course of a few hours. Guided by this vision, I worked through analytical mechanics again, this time with true understanding.</p>
<p>It is my experience that everything in undergraduate physics is taught badly, except perhaps Newtonian mechanics. I have written this essay to make analytical mechanics finally make sense. It has made sense for me, and I hope it will make sense for you.</p>
</section>
</section>
<section id="optimization-as-making-money" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="optimization-as-making-money">Optimization as making money</h2>
<section id="the-shortest-line-problem" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-shortest-line-problem">The shortest line problem</h3>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this problem, the so-called “time” <span class="math inline">\(t\)</span> has units of length as well. So, please don’t panic when we see something like <span class="math inline">\(\sqrt{1 + \dot x^2}\)</span>. If it worries we, we can replace <span class="math inline">\(t\)</span> by <span class="math inline">\(v\tau\)</span>, where <span class="math inline">\(v\)</span> is a constant speed of one, and <span class="math inline">\(\tau\)</span> is time.</p>
</div>
</div>
<p>Start with the easiest problem: shortest path problem. What is the shortest path from <span class="math inline">\((0, 0)\)</span> to <span class="math inline">\((A, B)\)</span>? We parametrize the path by a function <span class="math inline">\(t \mapsto (x(t), y(t))\)</span>, with <span class="math inline">\(t\in [0, 1]\)</span>. The problem is then</p>
<p><span class="math display">\[\begin{cases} \min \int_0^1 \sqrt{\dot x^2 + \dot y^2}dt \\ \int_0^1 \dot x dt = A \\ \int_0^1 \dot y dt = B \\ \end{cases}\]</span></p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/shortest_path_problem.svg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">What is the shortest path from <span class="math inline">\((0, 0)\)</span> to <span class="math inline">\((A, B)\)</span>?</figcaption>
</figure>
</div>
<p>This is a standard constraint-optimization problem, and could be solved by the Lagrangian multiplier method:</p>
<p><span class="math display">\[\delta \left(\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt + p_x \left( A - \int_0^1 \dot x dt\right) + p_y \left( B - \int_0^1 \dot y dt\right) \right) = 0\]</span></p>
<p>where <span class="math inline">\(p_x, p_y\)</span> are the Lagrangian multipliers, each responsible for enforcing one constraint.</p>
<p>Varying the path functions <span class="math inline">\(x, y\)</span> gives us</p>
<p><span class="math display">\[\delta \int_0^1 (\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y)dt = 0\]</span></p>
<p>Each of <span class="math inline">\(\dot x, \dot y\)</span> could be independently perturbed with a tiny concentrated “pulse”, so for the integral to be stationary, the integrand must be zero with respect to derivatives of <span class="math inline">\(\dot x, \dot y\)</span>. That is, we have</p>
<p><span class="math display">\[\begin{cases} \partial_{\dot x}(\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y )= 0\\ \partial_{\dot y}(\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y ) = 0 \end{cases}\]</span></p>
<p>and we are faced with the solution</p>
<p><span class="math display">\[(p_x, p_y) = \frac{1}{\sqrt{\dot x^2 + \dot y^2}}(\dot x, \dot y)\]</span></p>
<p>Since <span class="math inline">\(p_x, p_y\)</span> are independent of time, they are constants, and since we have from the above equation <span class="math inline">\(p_x^2 + p_y^2 = 1\)</span>, we find that <span class="math inline">\(p_x = \cos\theta, p_y = \sin\theta\)</span> for some <span class="math inline">\(\theta\)</span>. Thus, the curve is a straight line making an angle <span class="math inline">\(\theta\)</span> to the x-axis.</p>
</section>
<section id="economic-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="economic-interpretation">Economic interpretation</h3>
<p>Interpret <span class="math inline">\(x, y\)</span> as two goods that we can produce (let’s say, tons of steel and tons of copper).</p>
<p>We are a factory manager, and we are given a task: produce <span class="math inline">\(A\)</span> of <span class="math inline">\(x\)</span> (tons of steel), and <span class="math inline">\(B\)</span> of <span class="math inline">\(y\)</span> (tons of copper), in <span class="math inline">\([0, 1]\)</span> (one year). If we don’t do it, we will be sacked. Our problem is to accomplish the task at minimal cost.</p>
<p><span class="math inline">\(\dot x, \dot y\)</span> are the speed at which we produce the goods, which we can freely control. In control theory, we say <span class="math inline">\(x, y\)</span> are state variables, and <span class="math inline">\(\dot x, \dot y\)</span> are control variables.</p>
<p>The cost function is <span class="math inline">\(L(t, x, y, \dot x, \dot y) = \sqrt{\dot x^2 + \dot y^2}\)</span>. Its integral <span class="math inline">\(S = \int_0^1 L dt\)</span> is the total cost of production, which we must minimize.</p>
<p>We are also given a free market on which we are allowed to buy and sell the goods. If we cannot achieve the production target, we buy from the market. If we achieve more than the production target, we sell them off.</p>
<p>Then, the total cost is</p>
<p><span class="math display">\[\left(\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt + p_x \left( A - \int_0^1 \dot x dt\right) + p_y \left( B - \int_0^1 \dot y dt\right) \right)\]</span></p>
<p>where <span class="math inline">\(p_x, p_y\)</span> are the market prices which do not change with time.</p>
<p>If our production plan is optimal, then the plan must have stationary cost. That is, if we make a change in our production plan <span class="math inline">\((\dot x, \dot y)\)</span> by <span class="math inline">\(O(\delta)\)</span>, our production cost must not change by <span class="math inline">\(O(\delta)\)</span>, or else we could achieve lower cost. For example, if the plan <span class="math inline">\((\dot x + \delta \dot x, \dot y + \delta \dot y)\)</span> achieves higher cost, then <span class="math inline">\((\dot x - \delta \dot x, \dot y - \delta \dot y)\)</span> achieves lower cost.</p>
<p>Mathematically, it means the optimal production plan must satisfy</p>
<p><span class="math display">\[\delta \left(\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt + p_x \left( A - \int_0^1 \dot x dt\right) + p_y \left( B - \int_0^1 \dot y dt\right) \right) = 0\]</span></p>
<p>Now, the great thing about the market is that it is always there and we can trade with it, So, we have completely transformed the question into a problem of profit maximization – we’ll always sell to the market, and then buy back from the market right at the end.</p>
<p>Now we can perform profit maximization moment-by-moment: raise production until marginal profit reaches cost:</p>
<p><span class="math display">\[\begin{cases} \partial_{\dot x}(\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y )= 0\\ \partial_{\dot y}(\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y ) = 0 \end{cases}\]</span></p>
<p>which may be solved as before.</p>
<p>Now we can interpret <span class="math inline">\(p_x, p_y\)</span>. What are they? Suppose we perturb <span class="math inline">\(\dot x\)</span> by <span class="math inline">\(\delta \dot x\)</span>, then since the production plan is already optimal, we have</p>
<p><span class="math display">\[\delta \left(\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt + p_x \left( A - \int_0^1 \dot x dt\right) + p_y \left( B - \int_0^1 \dot y dt\right) \right) = 0\]</span></p>
<p>that is,</p>
<p><span class="math display">\[p_x \delta \int_0^1 \dot xd t = \delta\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt\]</span></p>
<p>We have our interpretation <span class="math inline">\(p_x\)</span>: the marginal cost of producing one unit of <span class="math inline">\(A\)</span>, That is, if we want an extra <span class="math inline">\(\delta A\)</span>, we have to incur an extra cost <span class="math inline">\(p_x \delta A\)</span>.</p>
<p>We actually have <span class="math inline">\(p_x = \cos \theta, p_y = \sin\theta\)</span>, which means that when <span class="math inline">\(x, y\)</span> are perturbed by <span class="math inline">\(\delta x, \delta y\)</span>, the shortest length between them is perturbed by</p>
<p><span class="math display">\[p_x \delta x + p_y \delta y = \cos\theta \delta x + \sin\theta \delta y\]</span></p>
<p>which is clearly true by geometry.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="The market inside our head">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The market inside our head
</div>
</div>
<div class="callout-body-container callout-body">
<p>We actually don’t need an external market. We could have put up such a fictional market inside the factory, and simply read out its price <span class="math inline">\(p_x, p_y\)</span> without ever trading with it. Why? Because in this problem, a solution exists, and under some niceness assumptions, there exists a “fair” market price at which we are indifferent to trading with the market – we can sell <span class="math inline">\(\delta x\)</span> and buy <span class="math inline">\(\delta y\)</span>, but there is “no point to it” because it doesn’t change our eventual cost. Thus, although the market exists, we never actually trade with it, so the market might as well be a card-board cutout with a number display of the latest prices. As long as we don’t <em>actually</em> try to trade with it, we would be behaving exactly as if we are facing a real market with the same prices.</p>
<p>It is perhaps best to think of the markets as things inside the head, a system of mental accounting to assign the proper price of everything. If the market prices are truly efficient, then we don’t need a real market to trade with.</p>
<blockquote class="blockquote">
<p>When the producer is ready, the market appears.</p>
<p>When the producer is truly ready, the market disappears.</p>
</blockquote>
</div>
</div>
</section>
<section id="lagranges-devil-at-disneyland" class="level3">
<h3 class="anchored" data-anchor-id="lagranges-devil-at-disneyland">Lagrange’s devil at Disneyland</h3>
<p>This is a parable about maximizing entropy under conservation of energy.</p>
<p>You are going to an amusement park, with many amusements <span class="math inline">\(i = 1, 2, \dots, n\)</span>. You have exactly 1 day to spend there, so you need to spend <span class="math inline">\(p_i\)</span> of a day on amusement <span class="math inline">\(i\)</span>. Now, your total utility at the end of the day is</p>
<p><span class="math display">\[S(p) := \sum_i p_i \ln \frac{1}{p_i}\]</span></p>
<p>a sum of logarithms, the idea being that you gain utility on any amusement at a decreasing rate: The first minute on the rollercoaster is great, but the second is less, and the third even less.</p>
<p>If that’s all there is to the amusement park, then the solution is clear: you should spend an equal amount of time at each amusement. This can be proved by the Lagrange multiplier mechanically, but underneath the algorithm of the Lagrange multiplier is the idea of partial equilibrium, so it’s worth spelling it out in full.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Proof by partial equilibrium">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof by partial equilibrium
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Suppose your parents give you a schedule for your amusement. You look at the schedule and notice that <span class="math inline">\(p_i &lt; p_j\)</span>. You can reject the plan and say, “I can always do better just by spending equal time at <span class="math inline">\(i, j\)</span>, even holding the other times fixed.”. That is, if we are only allowed to trade between time at <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> (a “partial market”), then at partial market equilibrium, the marginal utility of amusements <span class="math inline">\(i, j\)</span> must be equal.</p>
<p>The marginal utility of amusement <span class="math inline">\(i\)</span> is <span class="math inline">\(\ln(1/p_i) - 1\)</span>, and the same for <span class="math inline">\(j\)</span>. So, at partial equilibrium, <span class="math inline">\(p_i = p_j\)</span>, and at general equilibrium, all partial markets are in partial equilibrium.</p>
</div>
</div>
</div>
<p>Unfortunately, the amusement park is actually infinite. You can take this news in two ways: optimistically “I can earn arbitrarily high utility by spending <span class="math inline">\(1/N\)</span> of a day on <span class="math inline">\(N\)</span> amusements each, and let <span class="math inline">\(N\)</span> be as large as I want!” and pessimistically “No matter how much I try, I can never achieve the perfect day.”. Fortunately, the amusement park has a token system: when you enter the park, you would buy a certain number of tokens. Then you spend some tokens at the rides, proportional to the time you spend there.</p>
<p>There are some rules to the game:</p>
<ol type="1">
<li>You will be given a certain number of tokens <span class="math inline">\(E\)</span> at the start of the day.</li>
<li>The prices of amusements are <span class="math inline">\(0 = E_0 \leq E_1 \leq E_2 \leq \cdots\)</span>. Here <span class="math inline">\(E_0\)</span> is the “zero-point energy”, or in other words, “just relax”.</li>
<li>You must spend exactly all your tokens. Your parents hate wastefulness and would beat you up if you don’t use all the tokens.</li>
<li>Your parents are kind enough to supply you with the right number of tokens <span class="math inline">\(E\)</span>, such that you can avoid getting beat up: <span class="math inline">\(E_0 \leq E \leq \max_i E_i\)</span>.</li>
</ol>
<p>Thus we have reduced the problem to <span class="math display">\[
\begin{cases}
    \max S(p) \\
    \sum_i p_i \cdot 1 = 1 \\
    \sum_i p_i \cdot E_i = E
\end{cases}
\]</span></p>
<p>Under these assumptions, there exists a unique schedule that maximizes your fun, or entropy.</p>
<p>Now there is a slight difficulty with your previous approach. Doing partial equilibrium between 2 amusements is not possible now, because you have two constraints of not just time, but also tokens. Suppose you spend less time at <span class="math inline">\(i\)</span> to spend more time at <span class="math inline">\(j\)</span>, this might cause you to under- or over-spend your tokens. So, to make a partial equilibrium calculation, you must use at least 3 amusements, not 2. And you are not allowed to “just relax”, since relaxing is actually “the 0th amusement”, and thus it also costs you tokens and time. That is, you must open partial markets with <span class="math inline">\(i, j, k\)</span> at once, and then you can run the system to partial equilibrium. This is pretty annoying. There’s got to be a better way.</p>
<p>Suddenly, in a puff of smoke, Lagrange’s devil makes an appearance!</p>
<ul>
<li>“You can’t solve the general equilibrium problem, you say? Why not try the Lagrange multipliers?”</li>
<li>“Too annoying.”</li>
<li>“Alright, how about I make you a deal –”</li>
<li>“Sorry, but I don’t sell my soul.”</li>
<li>“Don’t be stupid – only something as stupid as God could still believe in souls these days! I am proposing that you trade happiness for time and for tokens. I will make a set price for time and another set price for tokens. Both prices are in units of your happiness. You can buy happiness with time, or time with happiness, also for tokens.”</li>
<li>“Uhmm…”</li>
<li>“That’s all that I offer. You should read up on microeconomics so you can make the right choice. See you when the day comes!”</li>
</ul>
<p>So the day comes and the devil shows up with the two prices:</p>
<ul>
<li>1 unit of time = <span class="math inline">\(\alpha\)</span> unit of utility.</li>
<li>1 unit of token = <span class="math inline">\(\beta\)</span> unit of utility.</li>
</ul>
<p>So you solve the following problem</p>
<p><span class="math display">\[\max_p \left(S(p) - \alpha \sum_i p_i - \beta \sum_i p_i E_i\right)\]</span></p>
<p>What a great luck that the devil is there – it has split a giant, intercorrelated general equilibrium into so many little, uncorrelated partial equilibria: <span class="math display">\[\forall i,\quad \max_{p_i} \left(p_i \ln \frac{1}{p_i} - \alpha p_i - \beta p_i E_i\right)\]</span></p>
<p>with solution <span class="math inline">\(p_i = e^{-1-\alpha} e^{-\beta E_i}\)</span>.</p>
<p>You are about to go to the devil, but then the devil waves at you to halt, “Don’t make individual trades, but make a bulk one-time trade.”. So you calculate <span class="math inline">\(\sum_i p_i\)</span> and <span class="math inline">\(\sum_i p_i E_i\)</span>, and to your surprise, you find that they equal exactly <span class="math inline">\(1\)</span> and <span class="math inline">\(E\)</span>. That is, you actually would spend all your time and tokens without needing to trade with the devil.</p>
<p>And so you sits there, looking at your two equations in strange amusement:</p>
<p><span class="math display">\[p_i = \frac{e^{-\beta E_i}}{e^{1+\alpha}}, \quad \alpha+1 = \ln\sum_i e^{-\beta E_i} , \quad E = \sum_i E_i \frac{e^{-\beta E_i}}{e^{1+\alpha}}\]</span></p>
<p>A physicist comes and points out that they are better known as</p>
<p><span class="math display">\[p_i =  \frac{e^{-\beta E_i}}{Z}, \quad Z = e^{-\beta F} = \sum_i e^{-\beta E_i}, \quad E = \sum_i p_i E_i\]</span></p>
<p>where <span class="math inline">\(Z\)</span> is called “partition function”, <span class="math inline">\(F\)</span> “Helmholtz free energy”, and <span class="math inline">\(\beta\)</span> “inverse temperature”.</p>
<p>As the devil prepares to leave, you call after it:</p>
<ul>
<li>“I’m grateful for all your help, but, please why did you price your wares this way?”</li>
<li>“Because I don’t want you to actually be happier!”</li>
<li>“What do you mean?”</li>
<li>“If I were to lower the price of tokens, then what would you do? You would realize that you can profit by spending a little less time at every amusement, then sell both the time and the tokens you saved, increasing your happiness! Similarly for any other form of price change. If I priced it in any other way than the equilibrium prices, you would be able to exploit my bad pricing and arbitrage out some happiness.”</li>
<li>“So why did you come to visit me in the first place?”</li>
<li>“It was easy to mess with mortals back before you discovered calculus. Now all I do is help you people discover general equilibrium, because you people have no fun anymore – every arbitrage opportunity is exploited to death. Still, I have to come, because I am the CEO of Hell, and I need to make maximally profitable deals with mortals, no matter how pointless it is.”</li>
</ul>
<blockquote class="blockquote">
<p>When the mortal is ready to make a deal, the devil appears.</p>
<p>When the mortal is truly ready to make a deal, the devil disappears.</p>
</blockquote>
</section>
<section id="isoperimetric-problem" class="level3">
<h3 class="anchored" data-anchor-id="isoperimetric-problem">Isoperimetric problem</h3>
<p>If we have a rope of length <span class="math inline">\(S\)</span>, and wish to span it from <span class="math inline">\((0, 0)\)</span> to <span class="math inline">\((T, h)\)</span>, what shape should the rope have, in order to maximize the area under the rope? In formulas, we model the rope as a differentiable function <span class="math inline">\(x(t): [0, T] \to \mathbb R\)</span>, such that</p>
<p><span class="math display">\[\begin{cases}
\max \int_0^T xdt\\
\int_0^T \sqrt{1 + \dot x^2}dt = S \\
\int_0^T \dot x dt = h
\end{cases}\]</span></p>
<p>Here we have two constraints, but the solution is essentially the same. First, to take care of the two constraints, we open two markets <span class="math inline">\(p_h, p_S\)</span> – one for the price of height, and another for the price of rope. Then, solve for</p>
<p><span class="math display">\[\delta \int_0^T \left(x + p_h \left(\frac hT - \dot x\right) +  p_S\left(\frac ST - \sqrt{1+\dot x^2}\right)\right) dt = 0\]</span></p>
<p>The state variable is <span class="math inline">\(x\)</span>, and the control variable is <span class="math inline">\(\dot x\)</span>. Unlike the previous problem, here we need to maximize the integral of the state variable. Consequently, we consider it as a problem of “profit flows”.</p>
<p>To make things more clear, let’s explicitly write <span class="math inline">\(v\)</span> as a control variable, and say that the control system satisfies:</p>
<p><span class="math display">\[\begin{cases}
v \text{ is a control variable}\\
x \text{ is a state variable}\\
\dot x = v
\end{cases}\]</span></p>
<p>Given that, how do we control the system? Again, it comes down to putting a price on everything, and maximizing at each instant. So, let’s open a market on commodity <span class="math inline">\(x\)</span>, such that the “fair” price is <span class="math inline">\(p(t)\)</span> at time <span class="math inline">\(t\)</span>. With that, we can write down the profit flow</p>
<p><span class="math display">\[H = x + p_h \left(\frac hT - v\right) +  p_S\left(\frac ST - \sqrt{1+v^2}\right) + p v\]</span></p>
<p>and maximizing profit over all time implies maximizing profit flow at every instant:</p>
<p><span class="math display">\[\partial_v H= 0\]</span></p>
<p>This gives us one equation, but we need one more equation. Namely, we need to know how <span class="math inline">\(p(t)\)</span>, the “fair” price of <span class="math inline">\(x\)</span>, changes with time.</p>
<p>The fundamental problem in pricing theory is this: how do we put a price on something? The fundamental reply from pricing theory is: no-arbitrage (no free money).</p>
<p>Here is how the no-arbitrage argument works. Suppose that we have been following our optimal production plan. Then at time <span class="math inline">\(t\)</span>, we suddenly decide to buy an extra <span class="math inline">\(\delta x\)</span> from the market, save it, then sell <span class="math inline">\(\delta x\)</span> at time <span class="math inline">\(t+ \delta t\)</span>.</p>
<p>Now, since <span class="math inline">\(\dot x = v\)</span>, this buying-and-selling plan does not change how much <span class="math inline">\(x\)</span> grows, so after time <span class="math inline">\(\delta t\)</span>, we have <span class="math inline">\(\delta x(t + \delta t) = \delta x(t)\)</span>. Thus, the no-arbitrage equation states:</p>
<p><span class="math display">\[p(t)\delta x(t) = p(t + \delta t)\delta x(t + \delta t)  + \delta x(t) \delta t \implies p(t+ \delta t) = p(t) - \delta t\]</span></p>
<p>and consequently, <span class="math inline">\(\dot p = -1\)</span>. This is the price dynamics. Intuitively, we see that the value of a standing stock of <span class="math inline">\(x\)</span> decreases as we run out of time to use it for producing.</p>
<p>To solve</p>
<p><span class="math display">\[\partial_v  H= 0\]</span></p>
<p>first expand it to</p>
<p><span class="math display">\[-p_h + p - p_S \frac{\dot x}{\sqrt{1 + \dot x^2}} =  0\]</span></p>
<p>then take derivative with respect to <span class="math inline">\(t\)</span>, to obtain</p>
<p><span class="math display">\[-\frac{\ddot x}{(1+\dot x^2)^{3/2}} = \frac{1}{p_S}\]</span></p>
<p>From elementary calculus, we know the item on the left is the curvature, so we find that the line <span class="math inline">\(x(t)\)</span> is a constant-curvature curve – circular arc. The radius of the circle is the inverse of curvature, which is exactly <span class="math inline">\(p_S\)</span>. Thus we find that, if we are given <span class="math inline">\(\delta S\)</span> more rope, we can encircle <span class="math inline">\(R\delta S\)</span> more area under the rope, where <span class="math inline">\(R\)</span> is the radius of curvature for the circular arc.</p>
<p>Notice that there we are not given the sign of <span class="math inline">\(p_S\)</span>. There are in general two solutions, one being a circular arc curving downwards, and the other curving upwards. If we use <span class="math inline">\(p_S &lt; 0\)</span>, then we get the one curving upwards, and so we get the solution that achieves <em>minimal</em> area under the rope. If we use <span class="math inline">\(p_S &gt; 0\)</span>, then we get the <em>maximal</em> solution. This is a general fact about such problems.</p>
</section>
</section>
<section id="lagrangian-and-hamiltonian-mechanics" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="lagrangian-and-hamiltonian-mechanics">Lagrangian and Hamiltonian mechanics</h2>
<p>Generalizing from our experience above, we consider a generic function <span class="math inline">\(L(t, q, v)\)</span>, with finitely many state variables <span class="math inline">\(q_1, ..., q_N\)</span>. For each state variable <span class="math inline">\(q_i\)</span>, we regard its time-derivative as a control variable <span class="math inline">\(v_i\)</span>, which we are free to vary. Our goal is to design a production plan <span class="math inline">\(t \mapsto v(t)\)</span>, such that</p>
<p><span class="math display">\[\delta \int L(t, q(t), v(t)) dt = 0, \quad \dot q = v\]</span></p>
<p>To comply with general sign conventions, we interpret <span class="math inline">\(L\)</span> as cost-per-time, so we <em>say</em> we want to minimize it (even though we only want to stationarize it).</p>
<p>We can understand <span class="math inline">\(i\in\{1, 2,..., N\}\)</span> to denote a commodity, say timber and sugar (let’s say there is such a thing as “negative 1 ton timber” – that is, we can short-sell commodities). Let <span class="math inline">\(p_i\)</span> be the market price of commodity <span class="math inline">\(i\)</span>. Again, there is no need for real market to trade with if the prices are right, since at the right price (no-arbitrage price), we are indifferent between buying and selling, or producing and consuming. It is purely a “mental accounting” device.</p>
<p>With access to a market, our profit flow is:</p>
<p><span class="math display">\[H(t, q, p, v) := \underbrace{\sum_i p_i v_i}_{\text{revenue flow}} - \underbrace{L(t, q, v)}_{\text{cost flow}}\]</span></p>
<p>In words, <span class="math inline">\(H(t, q, p, v)\)</span> is the rate of profit at time <span class="math inline">\(t\)</span> if we hold a stock of commodity <span class="math inline">\(q\)</span>, is producing at rate <span class="math inline">\(v\)</span>, and the market price of commodities is <span class="math inline">\(p\)</span>. This is close to the Hamiltonian, but not yet. We still need to remove the dependence on <span class="math inline">\(v\)</span>.</p>
<p>Moment-by-moment profit-flow maximization is myopic, and could lead us into deadends. That is, it is not a sufficient condition for global profit-maximization. However, it is a necessary condition. That is, suppose we are given a profit-maximizing trajectory, then it must maximize profit flow at every moment, since otherwise we could improve it. In formula:</p>
<p><span class="math display">\[v = \mathop{\mathrm{arg\,max}}_v \left(\sum_i p_i v_i - L(t, q, v)\right)\]</span></p>
<p>So, define the “optimal controller” as</p>
<p><span class="math display">\[v^\ast (t, q, p) = \mathop{\mathrm{arg\,max}}_v \left(\sum_i p_i v_i - L(t, q, v)\right)\]</span></p>
<p>and define <span class="math inline">\(H\)</span> as the “maximal profit flow” function:</p>
<p><span class="math display">\[H(t, q, p) = \max_{v} \left(\sum_i p_i v_i - L(t, q, v)\right) = \sum_i p_i v_i^\ast(t, q, p) - L(t, q, v^\ast(t, q, p))\]</span></p>
<p>By basic convex analysis, if <span class="math inline">\(L\)</span> is strictly convex with respect to <span class="math inline">\(v\)</span>, then <span class="math inline">\(v^*\)</span> is determined uniquely by <span class="math inline">\((t, q, p)\)</span>, and furthermore, it is a continuous function of <span class="math inline">\((t, q, p)\)</span>. Consequently, “profit maximization” allows us to model the system in <span class="math inline">\((t, q, p)\)</span> instead of <span class="math inline">\((t, q, v)\)</span> coordinates, and the dynamics of the system is equivalently specified by either <span class="math inline">\(H\)</span> or <span class="math inline">\(L\)</span>.</p>
<p>This is the mysterious “Legendre transform” that they whisper of. It is better called “convex dual”. I also like to joke that the <em>real</em> reason that momentum is written as <span class="math inline">\(p\)</span> is because it secretly means “price”!</p>
<section id="derivatives-of-h" class="level3">
<h3 class="anchored" data-anchor-id="derivatives-of-h">Derivatives of <span class="math inline">\(H\)</span></h3>
<div id="thm-hotelling-lemma" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Hotelling’s lemma)</strong></span> <span class="math inline">\(H(t, q, p)\)</span> is differentiable with respect to <span class="math inline">\(p\)</span>, and <span class="math display">\[
\begin{cases}
    \partial_t H(t, q, p) &amp;= -(\partial_t L)(t, q, v^\ast(t, q, p)) \\
    \nabla_p H(t, q, p) &amp;= v^\ast(t, q, p) \\
    \nabla_q H(t, q, p) &amp;= -(\nabla_q L)(t, q, v^\ast(t, q, p)) \\
\end{cases}
\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>We prove the first formula. The other two are proved in the same way.</p>
<p>The argument is by no-arbitrage. We can imagine what happens if we were to suffer a little price-shock <span class="math inline">\(\delta p\)</span>, adjust our production plan accordingly to <span class="math inline">\(v + \delta v\)</span>, then <em>hold</em> that production plan and suffer another little price-shock <span class="math inline">\(-\delta p\)</span>. Since we are back to the original price <span class="math inline">\(p\)</span> again, we should have no more than the maximal profit rate. That is, we should have</p>
<p><span class="math display">\[\underbrace{H(t, q, p)}_{\text{maximal rate before shock}} \geq \underbrace{H(t, q, p+\delta p)}_{\text{maximal rate after shock}} + \underbrace{\langle -\delta p, v^\ast(t, q, p+\delta p) \rangle}_{\text{undoing the shock, holding price steady}}\]</span></p>
<p>Since <span class="math inline">\(\delta p\)</span> is infinitesimal, this implies <span class="math inline">\(\left\langle-\delta p , \nabla_v H\right\rangle \geq \left\langle-\delta p , v^*(t, q, p)\right\rangle + O(\delta^2)\)</span> for all <span class="math inline">\(\delta p\)</span>, implying <span class="math inline">\(\nabla_v H = v^\ast(v^*(t, q, p))\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Notation for $\partial_t L$">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Notation for <span class="math inline">\(\partial_t L\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here, we explicitly put a bracket around <span class="math inline">\(\partial_t L\)</span> to emphasize that</p>
<p><span class="math display">\[
\begin{aligned}
(\partial_t L)(t, q, v^\ast(t, q, p))
&amp;= \lim_{\epsilon \to 0} \frac{L(t + \epsilon, q, v^\ast(t, q, p)) - L(t, q, v^\ast(t, q, p))}{\epsilon} \\
&amp;\neq \lim_{\epsilon \to 0} \frac{L(t + \epsilon, q, v^\ast(t + \epsilon, q, p)) - L(t, q, v^\ast(t, q, p))}{\epsilon}
\end{aligned}\]</span></p>
<p>and similarly for <span class="math inline">\(\nabla_q L\)</span>.</p>
</div>
</div>
</section>
<section id="hamiltonian-equations-of-motion" class="level3">
<h3 class="anchored" data-anchor-id="hamiltonian-equations-of-motion">Hamiltonian equations of motion</h3>
<p>We are given free control over <span class="math inline">\(\dot q\)</span>, and we saw that the cost-minimizing trajectory must maximize the profit flow moment-by-moment. That is,</p>
<p><span class="math display">\[\dot q(t) = v^\ast(t, q(t), p(t)) = (\nabla_p H)(t, q(t), p(t))\]</span></p>
<p>or more succinctly (you can see why we tend to be rather sloppy with notations!)</p>
<p><span class="math display">\[\dot q \underbrace{=}_{\text{optimality}} v^\ast \underbrace{=}_{\text{Hotelling's lemma}} \nabla_p H\]</span></p>
<p>More evocatively speaking, we have two opposing forces of greed and no-arbitrage, clashing together to give something interesting:</p>
<p><span class="math display">\[\dot q \underbrace{=}_{\text{we are greedy}} v^\ast \underbrace{=}_{\text{but the market gives us no free money}} \nabla_p H\]</span></p>
<p>It remains to derive <span class="math inline">\(\dot p\)</span> by the no-arbitrage condition: If we shock the system with some <span class="math inline">\(\delta q_i\)</span>, it does not matter if we sell it now, or carry it <span class="math inline">\(\delta t\)</span>, incurring additional cost, and sell it later. That is,</p>
<p><span class="math display">\[p_i(t) \delta q_i = p_i(t+\delta t) \delta q_i - \partial_{q_i} L(t, q, v) \delta q_i \delta t \implies \dot p_i = \partial_{q_i} L(t, q, v)\]</span></p>
<div id="tip-higher-order-infinitesimal" class="callout callout-style-default callout-tip callout-titled" title="Higher-order infinitesimal">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;1: Higher-order infinitesimal
</div>
</div>
<div class="callout-body-container callout-body">
<p>The equality should be more precisely read as “up to a higher-order infinitesimal than <span class="math inline">\(\delta q_i\delta t\)</span>”. That is, we should be writing:</p>
<p><span class="math display">\[
p_i(t) \delta q_i = p_i(t+\delta t) \delta q_i - \partial_{q_i} L(t, q, v) \delta q_i \delta t  + o(\delta q_i\delta t)
\]</span></p>
<p>This detail would come up later in our proof of the <a href="#thm-hje">Hamilton–Jacobi equation</a>.</p>
</div>
</div>
<p>Since we are only concerned with what happens on the optimal trajectory, we always choose <span class="math inline">\(v = v^\ast\)</span>, so</p>
<p><span class="math display">\[\dot p_i = (\partial_{q_i} L)(t, q, v^\ast(t, q, p)) \underbrace{=}_{\text{Hotelling's lemma}} -\partial_{q_i} H(t, q, p)\]</span></p>
<p>Thus, we obtain the two fundamental equations of Hamiltonian mechanics:</p>
<div id="thm-hem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Hamilton equations of motion)</strong></span> <span class="math display">\[\begin{cases}  
\partial_t H &amp;= -\partial_t L \\
\dot p = -\nabla_q H \\     
\dot q = \nabla_p H
\end{cases}\]</span></p>
</div>
</section>
<section id="eulerlagrange-equations-of-motion" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="eulerlagrange-equations-of-motion">Euler–Lagrange equations of motion</h3>
<p>By definition,</p>
<p><span class="math display">\[H(t, q, p) =  \max_{v} \left(\sum_i p_i v_i - L(t, q, v)\right) =  \sum_i p_i v_i^\ast(t, q, p) - L(t, q, v^\ast(t, q, p))\]</span></p>
<p>and since <span class="math inline">\(L\)</span> is strictly convex in <span class="math inline">\(v\)</span>, this can be inverted (this is called “<strong>convex duality</strong>”) to give</p>
<p><span class="math display">\[L(t, q, v) =  \max_{p} \left(\sum_i p_i v_i - H(t, q, p)\right) =  \sum_i p^\ast_i v_i - H(t, q, p^\ast(t, q, p))\]</span></p>
<p>where <span class="math inline">\(p^\ast = \mathop{\mathrm{arg\,max}}_p \sum_i p_i v_i - H(t, q, p)\)</span>. It is a basic theorem in convex geometry that, if <span class="math inline">\(L\)</span> is strictly convex in <span class="math inline">\(v\)</span>, then <span class="math inline">\(H\)</span> is strictly convex in <span class="math inline">\(p\)</span>, so the inversion works.</p>
<p>By the same argument as in Hotelling’s lemma, we have</p>
<p><span class="math display">\[\nabla_v L(t, q, v) = p^\ast(t, q, v)\]</span></p>
<p>By definition of the convex dual, for any <span class="math inline">\(t, q, p, v\)</span>, we have</p>
<p><span class="math display">\[H(t, q, p) + L(t, q, v) \leq \sum_i p_i v_i\]</span></p>
<p>with equality reached iff both <span class="math inline">\(p = p^\ast(t, q, v)\)</span> and <span class="math inline">\(v = v^\ast(t, q, p)\)</span>. Thus, on any optimal trajectory, since <span class="math inline">\(v = v^\ast(t, q, p)\)</span>, we must also have <span class="math inline">\(p = p^\ast(t, q, v)\)</span>, and consequently,</p>
<p><span class="math display">\[\frac{d}{dt} \nabla_v L \underbrace{=}_{\text{Hotelling's lemma}} \dot p^\ast \underbrace{=}_{\text{optimality}} \dot p \underbrace{=}_{\text{no-arbitrage}} \nabla_q L\]</span></p>
<p>This is the famous</p>
<div id="thm-elem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Euler–Lagrange equations of motion)</strong></span> <span class="math display">\[
\frac{d}{dt} (\partial_{v_i} L) = (\nabla_{q_i} L) \quad \forall i \in \{1, 2, \dots, N\}
\]</span></p>
<p>or more succinctly,</p>
<p><span class="math display">\[
\frac{d}{dt} (\nabla_v L) = \nabla_q L
\]</span></p>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Explaining the notation">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Explaining the notation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Physicists are often sloppy with notations, but the Euler–Lagrange equation is particularly egregious in this regard, so I will describe it carefully.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>The function <span class="math inline">\(L\)</span> is a function of type <span class="math inline">\(\underbrace{\mathbb{R}}_{\text{time}} \times \underbrace{\mathbb{R}^N}_{\text{state}} \times \underbrace{\mathbb{R}^N}_{\text{control}} \to \mathbb{R}\)</span>.</p>
<p>The function <span class="math inline">\(\partial_{v_i} L\)</span> is also a function of type <span class="math inline">\(\mathbb{R}\times \mathbb{R}^N \times \mathbb{R}^N \to \mathbb{R}\)</span>. It is obtained by taking derivative of <span class="math inline">\(L\)</span> over its <span class="math inline">\((1 + i)\)</span>-th input. Let’s write that as <span class="math inline">\(f_i\)</span> to make sure we are not confused by it. It is absolutely important to be clear about this! <span class="math inline">\(f_i\)</span> is <em>not</em> a function defined only along a trajectory, but over the entire space of <span class="math inline">\(\mathbb{R}\times \mathbb{R}^N \times \mathbb{R}^N\)</span>. We can similarly define <span class="math inline">\(f_{i + N}\)</span> to be <span class="math inline">\(\partial_{q_i} L\)</span>.</p>
<p>Now, suppose we are given a <em>purportedly optimal</em> trajectory <span class="math inline">\(q: \mathbb{R}\to \mathbb{R}^N\)</span>, then for any coordinate <span class="math inline">\(i \in \{1, 2, \dots, N\}\)</span>, we can define a function <span class="math inline">\(g_i\)</span>, of type <span class="math inline">\(\mathbb{R}\to \mathbb{R}\)</span> by</p>
<p><span class="math display">\[
g_i(t) = f_i(t, q(t), \dot q(t))
\]</span></p>
<p>and similarly, we can define <span class="math inline">\(g_{i + N} = f_{i + N}(t, q(t), \dot q(t))\)</span>.</p>
<p>The Euler–Lagrange equations say that we need only check</p>
<p><span class="math display">\[
g_i'(t) = g_{i+N}(t) \quad \forall t \in [0, T], i \in 1:N
\]</span></p>
<p>to certify that the <em>purportedly</em> stationary trajectory <span class="math inline">\(q\)</span> is truly stationary.</p>
</div>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;I am okay with sloppy notation sometimes, but in this case, the sloppy notation often leads to calculational mistakes and conceptual confusions, as teachers of undergrad courses can testify.</p></div></div></section>
<section id="what-does-it-all-mean" class="level3">
<h3 class="anchored" data-anchor-id="what-does-it-all-mean">What does it all mean?</h3>
<p>In the Lagrangian formalism, we are given a system with <span class="math inline">\(q\)</span> coordinates, and allowed to manipulate <span class="math inline">\(\dot q\)</span> however we want, in order to minimize a “cost” function <span class="math inline">\(\int_0^T L(t, q, \dot q)dt\)</span>.</p>
<p>In the Hamiltonian formalism, we are also given a market to trade with. We attempt to maximize profit by varying production, buying, and selling. However, the market simultaneously adjusts its prices <span class="math inline">\(p\)</span> in just the right way so that we are always indifferent about the market (if we are ever not indifferent, the market is in serious trouble – it doesn’t actually carry any real commodity!), so we never actually make any trade. The market has been in our heads all along, but its effects are real.</p>
<p>Assuming this kind of double optimization (we against the market, and the market against us), the trajectory is uniquely determined by several possible specifications. We may fix it by <span class="math inline">\((t_0, q_0, p_0)\)</span>, or by <span class="math inline">\((t_0, q_0), (t, q)\)</span>, or by <span class="math inline">\((t_0, q_0, v_0)\)</span>, or perhaps more exotic constraints that mix up <span class="math inline">\(t, q, p, v\)</span>.</p>
<p>Ironically, the Hamiltonian equations of motion flow out naturally in this economic interpretation, with no fuss whatsoever. The Euler–Lagrange equations are derived only as an afterthought. This is exactly backwards compared to the usual way of teaching, where the EL equations are derived first, and the Hamiltonian equations are derived by an unmotivated “Let us define <span class="math inline">\(H = \sum_i p_i q_i - L\)</span> …”, followed by some clumsy and unjustified derivations.</p>
<p>In classical control theory, the price vector <span class="math inline">\(p\)</span> is called “costate” since it is multiplied with the state <span class="math inline">\(q\)</span>, and <span class="math inline">\(\dot p= -\nabla_q H\)</span> is called the “costate equation”. The above methods can be generalized to account for constraints, yielding Pontryagin’s maximum principle, among other results.</p>
</section>
<section id="cyclic-coordinates" class="level3">
<h3 class="anchored" data-anchor-id="cyclic-coordinates">Cyclic coordinates</h3>
<p>Given a system defined by a Lagrangian function <span class="math inline">\(L(t, q, v)\)</span>, we say that it is <strong>cyclic</strong> in the coordinate <span class="math inline">\(q_i\)</span> if <span class="math inline">\(L\)</span> does not depend on <span class="math inline">\(q_i\)</span>. By definition of</p>
<p><span class="math display">\[H(t, q, p) = \max_v \left(\sum_i p_i v_i - L(t, q, v)\right)
\]</span></p>
<p>we see that if <span class="math inline">\(L\)</span> does not depend on <span class="math inline">\(q_i\)</span>, then <span class="math inline">\(H\)</span> also does not depend on <span class="math inline">\(q_i\)</span>. Consequently, any optimal trajectory satisfies <span class="math inline">\(\dot p_i = -\partial_{q_i} H = 0\)</span>. That is, <span class="math inline">\(p_i\)</span> is conserved – <strong>conservation of generalized momentum</strong>.</p>
</section>
<section id="bonus-routhian-mechanics" class="level3">
<h3 class="anchored" data-anchor-id="bonus-routhian-mechanics">Bonus: Routhian mechanics</h3>
<p>Suppose that the market does not contain all commodities, but only the last <span class="math inline">\(n\)</span> commodities. That is, let <span class="math inline">\(q_{1:N} = (q_{1:s}, q_{s+1:s+n})\)</span>, and only open markets on <span class="math inline">\(q_{s+1:s+n}\)</span>. The optimal cash flow equation then gives us the “Routhian”:</p>
<p><span class="math display">\[
R(t, q, v_{1:s}, p_{s+1:N}) = \max_{v_{s+1:N}} \left(\sum_{i=s+1}^n p_i v_i - L(t, q, v)\right)
\]</span></p>
<p>As before, the optimal control variables are <span class="math inline">\(v_{s+1:N}^\ast = \mathop{\mathrm{arg\,max}}_{v_{s+1:N}} \left(\sum_{i=s+1}^n p_i v_i - L(t, q, v)\right)\)</span>.</p>
<div id="thm-routhian" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4 (Routhian equations of motion)</strong></span> <span class="math display">\[
\begin{cases}
    \partial_t R &amp;= -\partial_t L \\
    \frac{d}{dt} \partial_{v_i} R = \partial_{q_i}R \quad &amp; i \in 1:s\\
    \begin{cases}
    \dot q_i = \partial_{p_i} R \\ \dot p_i = -\partial_{q_i} R
    \end{cases}\quad &amp; i\in s+1:N
\end{cases}
\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>By the same argument as in Hotelling’s lemma, we have</p>
<p><span class="math display">\[
\begin{cases}
    \partial_t R = -\partial_t L \\
    \nabla_q R = -\nabla_q L \\
    \nabla_{v_{1:s}} R = -\nabla_{v_{1:s}} L \\
    \nabla_{p_{s+1 : N}} R = v^*_{s+1 : N}
\end{cases}
\]</span></p>
<p>Plugging the 2-th and 3-th equations into the original Euler–Lagrange equations, we obtain</p>
<p><span class="math display">\[\frac{d}{dt} \partial_{v_i} R = \partial_{q_i}R \quad i \in 1:s\]</span></p>
<p>The 4-th equation gives</p>
<p><span class="math display">\[\dot q_i =v_i^\ast = \partial_{p_i} R, \quad \forall i\in s+1:N\]</span></p>
<p>For <span class="math inline">\(i\in s+1:N\)</span>, we can obtain the price dynamic of the partial market by the no-arbitrage condition, giving</p>
<p><span class="math display">\[\dot p_i = \partial_{q_i} L = -\partial_{q_i} R\]</span></p>
</div>
</div>
</div>
<p>We see that the first <span class="math inline">\(s\)</span> equations look just like the EL equations, but the next <span class="math inline">\(2n\)</span> equations look just like the Hamiltonian equations. The Routhian equations make an awkward hybrid.</p>
<blockquote class="blockquote">
<p>… as a fundamental entity, the Routhian is a sterile hybrid, combining some of the features of both the Lagrangian and the Hamiltonian pictures. For the development of various formalisms of classical mechanics, the complete Hamiltonian formulation is more fruitful.</p>
<p><span class="citation" data-cites="goldsteinClassicalMechanics2008">(<a href="#ref-goldsteinClassicalMechanics2008" role="doc-biblioref">Goldstein, Poole, and Safko 2008, sec. 8.3</a>)</span></p>
</blockquote>
<section id="application-to-cyclic-coordinates" class="level4">
<h4 class="anchored" data-anchor-id="application-to-cyclic-coordinates">Application to cyclic coordinates</h4>
<p>Though the Routhian equations are theoretically useless, they are useful for solving specific problems. For some worked examples of using the Routhian, see the <a href="https://en.wikipedia.org/wiki/Routhian_mechanics#Examples">Wikipedia page</a>.</p>
<p>While the Euler–Lagrangian equations are <span class="math inline">\(N\)</span> second-degree differential equations, the Hamiltonian equations are <span class="math inline">\(2N\)</span> first-degree differential equations. We are essentially trading derivatives for equation numbers.</p>
<p>Though the EL equations and the Hamiltonian equations are philosophically different, for solving particular problems, they often end up giving the same equations anyway. Specifically, if we are solving the Hamiltonian equations for a concrete example, by eliminating the variables <span class="math inline">\(p\)</span>, we often end up right back to the Euler–Lagrange equations. This would be quite the detour, and if there are cyclic coordinates, the Routhian could save us some trouble.</p>
<p>If we have a system that is cyclic in the last <span class="math inline">\(n\)</span> coordinates, then since <span class="math inline">\(\nabla_q R = -\nabla_q L\)</span>, its Routhian satisfies <span class="math inline">\(\partial_{q_i} R = 0\)</span> for the last <span class="math inline">\(n\)</span> coordinates too. Then we find that the Routhian equations become:</p>
<p><span class="math display">\[
\begin{cases}
\frac{d}{dt} \partial_{v_i} R = \partial_{q_i}R \quad &amp; i \in 1:s\\
\begin{cases}
\dot q_i = \partial_{p_i} R \\  p_i = p_i(0)
\end{cases}\quad &amp; i\in s+1:N
\end{cases}
\]</span></p>
<p>giving us <span class="math inline">\(n\)</span> first-degree equations and <span class="math inline">\(N-n\)</span> second-degree equations. If we were to start with the Hamiltonian equations of motion, we would get</p>
<p><span class="math display">\[
\begin{cases}
\dot q_i = \partial_{p_i} H \\  p_i = p_i(0)
\end{cases}\quad i\in s+1:N
\]</span></p>
<p>by the same reasoning, and then laboriously eliminate the variables <span class="math inline">\(p_i\)</span> for <span class="math inline">\(i \in 1:s\)</span>, and end up with <span class="math inline">\(s\)</span> second-degree differential equations, often exactly the same as the first <span class="math inline">\(s\)</span> Routhian equations:</p>
<p><span class="math display">\[\frac{d}{dt} \partial_{v_i} R = \partial_{q_i}R \quad i \in 1:s\]</span></p>
<p>This is how the Routhian saves us some effort in practical calculations. It is useful in this way, and in this way only.</p>
</section>
</section>
</section>
<section id="bonus-higher-order-lagrangians-and-hamiltonians" class="level2">
<h2 class="anchored" data-anchor-id="bonus-higher-order-lagrangians-and-hamiltonians">Bonus: Higher-order Lagrangians and Hamiltonians</h2>
<p>What happens if we use a Lagrangian with higher-order derivatives? It turns out that even in this case, we can still use economic reasoning to derive its Hamiltonian and Euler–Lagrangian equations</p>
<div id="exr-higher-order-hamiltonian" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> Read the following sections, then generalize the derivation to <span class="math inline">\(n\)</span>-th-order derivatives.</p>
</div>
<p>This construction of Hamiltonians from higher-order Lagrangians is often called <strong>Ostrogradsky theorem</strong> or <strong>Ostrogradsky instability</strong>, because Ostrogradsky published it in 1850 <span class="citation" data-cites="ostrogradskyMemoiresEquationsDifferentielles1850">(<a href="#ref-ostrogradskyMemoiresEquationsDifferentielles1850" role="doc-biblioref">Ostrogradsky 1850</a>)</span> after seeing Hamilton’s paper of 1833 <span class="citation" data-cites="hamiltonGeneralMethodExpressing1833">(<a href="#ref-hamiltonGeneralMethodExpressing1833" role="doc-biblioref">Hamilton 1833</a>)</span>. He did not note its implications for instability, which was first noted by Pais and Uhlenbeck in 1950 <span class="citation" data-cites="paisFieldTheoriesNonLocalized1950">(<a href="#ref-paisFieldTheoriesNonLocalized1950" role="doc-biblioref">Pais and Uhlenbeck 1950</a>)</span>. For this reason, it’s also called the <strong>Pais–Uhlenbeck model</strong>.</p>
<section id="when-lagrangian-also-depends-on-acceleration" class="level3">
<h3 class="anchored" data-anchor-id="when-lagrangian-also-depends-on-acceleration">When Lagrangian also depends on acceleration</h3>
<p>When the Lagrangian depends not just on position and velocity, but also acceleration, the total cost to be optimized is:</p>
<p><span class="math display">\[S(q) := \int L(t, q^{(0)}, q^{(1)}, q^{(2)})dt\]</span></p>
<p>where <span class="math inline">\(q^{(n)}\)</span> is a symbol that <em>suggests</em> itself to be the <span class="math inline">\(n\)</span>-th time-derivative of the optimal trajectory <span class="math inline">\(q\)</span>, although it is actually defined for any tuple of real numbers, even when we don’t have <span class="math inline">\(q^{(1)}(t) = \frac{d}{dt}q^{(0)}(t)\)</span>.</p>
<p>Our previous method, which is to open a market on position <span class="math inline">\(q\)</span>, fails for two reasons:</p>
<ol type="1">
<li>The producer cannot optimize its velocity, because now velocity is no longer a control variable. Now, both position and velocity are state variables, and only acceleration is a control variable.</li>
<li>The producer cannot buy and sell velocity, so it has no price signal to optimize its acceleration (how fast it produces velocity).</li>
</ol>
<p>If the market fails, make it bigger: allow the market to buy and sell not just position, but also velocity.</p>
<p>We open a market of both positions and velocities. The price vector of positions is <span class="math inline">\(p^{(0)}\)</span> and the price vector of velocities is <span class="math inline">\(p^{(1)}\)</span>. Then, the maximal profit flow is</p>
<p><span class="math display">\[H(t,  q^{(0)}, q^{(1)}, p^{(0)}, p^{(1)}) = \max_{ q^{(2)}} (\langle p^{(0)} , q^{(1)}\rangle + \langle p^{(1)} , q^{(2)}\rangle - L(t, q^{(0)}, q^{(1)}, q^{(2)}))\]</span></p>
<p>and the optimal production plan is</p>
<p><span class="math display">\[q^{(2)\ast} = \mathop{\mathrm{arg\,max}}_{ q^{(2)}}(\langle p^{(0)} , q^{(1)}\rangle + \langle p^{(1)} , q^{(2)}\rangle - L)\]</span></p>
</section>
<section id="ostrogradsky-instability-and-the-anthropic-principle" class="level3">
<h3 class="anchored" data-anchor-id="ostrogradsky-instability-and-the-anthropic-principle">Ostrogradsky instability and the anthropic principle</h3>
<p>We will show that the quantity does deserve the name of “Hamiltonian”:</p>
<p><span class="math display">\[H(t,  q^{(0)}, q^{(1)}, p^{(0)}, p^{(1)}) = \langle p^{(0)} , q^{(1)}\rangle + \max_{ q^{(2)}} (\langle p^{(1)} , q^{(2)}\rangle - L(t, q^{(0)}, q^{(1)}, q^{(2)}))\]</span></p>
<p>Assuming that, we have a serious problem. Consider an oscillator with higher-order derivatives. Since its Hamiltonian contains a term <span class="math inline">\(\langle p^{(0)} , q^{(1)}\rangle\)</span>, it is linear with respect to <span class="math inline">\(p^{(0)}\)</span> and <span class="math inline">\(q^{(1)}\)</span>. In other words, it can have arbitrarily <em>low</em> energy states.</p>
<p>Now, this could be alright if we live in a classical world, but we live in a world described by quantum field theory. In QFT, the world is a giant network of oscillators. If a quantum oscillator has higher-order derivatives, then its energy levels can go both infinitely high and low. If there is any coupling at all between its energy levels, it would instantly evaporates into infinitely many positive and negative energy particles, in a blaze of vacuum decay.</p>
<p>This is an anthropic explanation for “Why Newton’s laws?” Newton’s laws, because the Lagrangian depends on only up to velocity. Why? Because if it also depends on acceleration, the vacuum would decay <span class="citation" data-cites="swansonOstrogradskiInstabilityWhy2022">(<a href="#ref-swansonOstrogradskiInstabilityWhy2022" role="doc-biblioref">Swanson 2022</a>)</span>. We can similarly explain anthropically why space has 3 dimensions, and time has 1 dimension.</p>
<blockquote class="blockquote">
<p>With more or less than one time dimension, the partial differential equations of nature would lack the hyperbolicity property that enables observers to make predictions. In a space with more than three dimensions, there can be no traditional atoms and perhaps no stable structures. A space with less than three dimensions allows no gravitational force and may be too simple and barren to contain observers.</p>
<p><span class="citation" data-cites="tegmarkDimensionalitySpacetime1997">(<a href="#ref-tegmarkDimensionalitySpacetime1997" role="doc-biblioref">Tegmark 1997</a>)</span>.</p>
</blockquote>
</section>
<section id="hamiltonian-equations" class="level3">
<h3 class="anchored" data-anchor-id="hamiltonian-equations">Hamiltonian equations</h3>
<p>We can prove the Hotelling’s lemma for this Hamiltonian, using the same no-arbitrage argument as before:</p>
<p><span class="math display">\[\begin{cases}     
    \partial_t H = -\partial_t L \\  
    \nabla_{q^{(0)}} H = -\nabla_{q^{(0)}} L \\     
    \nabla_{q^{(1)}} H = p^{(0)}-\nabla_{q^{(1)}} L \\     
    \nabla_{p^{(0)}} H = q^{(1)} \\     
    \nabla_{p^{(1)}} H = q^{(2)\ast}
\end{cases}\]</span></p>
<p>Along an optimal trajectory, the producer always chooses <span class="math inline">\(\dot q^{(1)} = q^{(2)\ast}\)</span>, and has no choice in <span class="math inline">\(\dot q^{(0)} = q^{(1)}\)</span>, so we have two equations of motion:</p>
<p><span class="math display">\[\begin{cases}     
\dot q^{(1)} = q^{(2)\ast} = \nabla_{p^{(1)}} H\\    
\dot q^{(0)} = q^{(1)} = \nabla_{p^{(0)}} H
\end{cases}\]</span></p>
<p>The market must adjust its prices by the no-arbitrage condition, as before. If we inflict a position shock of <span class="math inline">\(\delta q^{(0)}\)</span>, then by no-arbitrage, selling it now or later is equally (up to order <span class="math inline">\(\delta^2\)</span>) profitable:</p>
<p><span class="math display">\[\langle p^{(0)} , \delta q^{(0)}\rangle = \langle p^{(0)} + \dot p^{(0)} \delta t , \delta q^{(0)}\rangle - \langle \nabla_{q^{(0)}} L , \delta q^{(0)}\rangle \delta t\]</span></p>
<p>yielding <span class="math inline">\(\dot p^{(0)} = \nabla_{q^{(0)}} L = -\nabla_{q^{(0)}} H\)</span>.</p>
<p>For the last equation of motion, inflict a velocity shock of <span class="math inline">\(\delta q^{(1)}\)</span>. The effect of the shock include both its effect on <span class="math inline">\(q^{(0)}\)</span> and <span class="math inline">\(L\)</span>, thus the no-arbitrage equation states:</p>
<p><span class="math display">\[\underbrace{\langle p^{(1)} , \delta q^{(1)}\rangle}_{\text{selling now}} =  \underbrace{\langle p^{(1)} + \dot p^{(1)} \delta t , \delta q^{(1)}\rangle}_{\text{selling later}} + \underbrace{\langle p^{(0)} + \dot p^{(0)} \delta t , \delta q^{(1)}\delta t\rangle}_{\text{profit from extra }p^{(0)}} - \underbrace{\langle \nabla_{q^{(1)}} L , \delta q^{(1)}\rangle \delta t}_{\text{cost from holding extra }p^{(1)}}\]</span></p>
<p>which yields the last equation <span class="math inline">\(\dot p^{(1)} = \nabla_{q^{(1)}} L - p^{(0)} = -\nabla_{q^{(1)}} H\)</span>.</p>
<p>In summary, we have</p>
<div id="thm-higher-hem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5 (higher-order Hamiltonian equations of motion:)</strong></span> <span class="math display">\[
\begin{cases}     
    \dot q^{(1)} = \nabla_{p^{(1)}} H\\     
    \dot q^{(0)} = \nabla_{p^{(0)}} H \\     
    \dot p^{(0)} = -\nabla_{q^{(0)}} H \\     
    \dot p^{(1)} = -\nabla_{q^{(1)}} H  
\end{cases}
\]</span></p>
</div>
</section>
<section id="eulerlagrange-equations" class="level3">
<h3 class="anchored" data-anchor-id="eulerlagrange-equations">Euler–Lagrange equations</h3>
<p>In order to obtain the Euler–Lagrange equations of motion, we need to work backwards from the Hamiltonian equations of motion as before.</p>
<p>From the Hamiltonian, we can go back to the Lagrangian by inverting the convex transform:</p>
<p><span class="math display">\[L(t, q^{(0)}, q^{(1)}, q^{(2)})  = \max_{p^{(0)} ,p^{(1)}} (\langle p^{(0)} , q^{(1)}\rangle + \langle p^{(1)} , q^{(2)}\rangle - H(t,  q^{(0)}, q^{(1)}, p^{(0)}, p^{(1)}))\]</span></p>
<p>Here we are given a hint of the troubles ahead. Since <span class="math inline">\(H\)</span> is linear in <span class="math inline">\(p^{(1)}\)</span>:</p>
<p><span class="math display">\[H(t,  q^{(0)}, q^{(1)}, p^{(0)}, p^{(1)}) = \langle p^{(0)} , q^{(1)}\rangle + \max_{ q^{(2)}} (\langle p^{(1)} , q^{(2)}\rangle - L(t, q^{(0)}, q^{(1)}, q^{(2)}))\]</span></p>
<p>there is no way to fix <span class="math inline">\(p^{(1)}\)</span> in the inverse transform! In detail, we plug the equation for <span class="math inline">\(H\)</span> into the equation for <span class="math inline">\(L\)</span>, to get</p>
<p><span class="math display">\[L(t, q^{(0)}, q^{(1)}, q^{(2)}) = \max_{p^{(0)} ,p^{(1)}} (\langle p^{(1)} , q^{(2)}\rangle - \max_{ q^{(2)}} (\langle p^{(1)} , q^{(2)}\rangle - L(t, q^{(0)}, q^{(1)}, q^{(2)}))\]</span></p>
<p>and we see that there is <em>no</em> optimality constraint on <span class="math inline">\(p^{(0)}\)</span>. This is a hint of instabilities ahead.</p>
<p>Differentiating <span class="math inline">\(L\)</span>, we get</p>
<p><span class="math display">\[\begin{cases}
\partial_t L = -\partial_t H\\
\nabla_{q^{(0)}}L = -\nabla_{q^{(0)}}H \\
\nabla_{q^{(1)}}L = p^{(0)} - \nabla_{q^{(1)}}H \\
\nabla_{q^{(2)}}L = p^{(1)\ast}  
\end{cases}\]</span></p>
<p>Now, along the optimal trajectory, we must have <span class="math inline">\(\nabla_{q^{(2)}}L = p^{(1)\ast}\)</span>, so taking its time-derivative, we get</p>
<p><span class="math display">\[\frac{d}{dt}\nabla_{q^{(2)}}L = \dot p^{(1)} = -\nabla_{q^{(1)}}H = \nabla_{q^{(1)}}L - p^{(0)}\]</span></p>
<p>Take another time-derivative, to obtain the Euler–Lagrange equations of motion:</p>
<p><span class="math display">\[\sum_{i=0}^2\left(-\frac{d}{d t}\right)^i (\nabla_{q^{(i)}} L ) =0\]</span></p>
<p>The generalization to <span class="math inline">\(L(t, q^{(0)}, ..., q^{(N-1)})\)</span> is immediate. It can be derived by a similar argument through the market economy.</p>
</section>
<section id="an-unstable-higher-order-oscillator" class="level3">
<h3 class="anchored" data-anchor-id="an-unstable-higher-order-oscillator">An unstable higher-order oscillator</h3>
<p>It is beyond our scope to discuss Ostrogradsky instability in quantum field theory, however, we can have a taste of it here. Consider the oscillator perturbed by <span class="math inline">\(\epsilon\)</span>:</p>
<p><span class="math display">\[L = \frac 12 m\dot x^2 - \frac 12 kx^2 - \frac 12 \epsilon \ddot x^2\]</span></p>
<p>Its EL equation is</p>
<p><span class="math display">\[\epsilon x^{(4)} + m\ddot x + kx = 0\]</span></p>
<p>a linear order-4 equation, so its solutions are of the form <span class="math inline">\(x = \sum_{i=1}^4 a_i e^{z_i t}\)</span>, where <span class="math inline">\(z_1, z_2, z_3, z_4\)</span> are its fundamental (complex) frequencies. Plug them in the equation and solve it simply:</p>
<p><span class="math display">\[z = \pm \sqrt{-\frac{1}{2\epsilon} (m \pm \sqrt{m^2 - 4\epsilon k})}\]</span></p>
<p>At small <span class="math inline">\(|\epsilon|\)</span> limit, we have</p>
<p><span class="math display">\[z \approx \pm i\sqrt{\frac km}, \pm\sqrt{-\frac m\epsilon}\]</span></p>
<p>and so if <span class="math inline">\(\epsilon &lt; 0\)</span>, one of the modes is exponentially growing at rate <span class="math inline">\(\sqrt{m/|\epsilon|}\)</span>.</p>
<p>If <span class="math inline">\(\epsilon &gt; 0\)</span>, then the oscillator survives, with two modes of oscillation of frequency <span class="math inline">\(\sqrt{\frac km}\)</span> and <span class="math inline">\(\sqrt{\frac{m}{\epsilon}}\)</span>. When there is viscous force, however, this delicate stability is destroyed. <span class="citation" data-cites="nesterenkoInstabilityClassicalDynamics2007">(<a href="#ref-nesterenkoInstabilityClassicalDynamics2007" role="doc-biblioref">Nesterenko 2007</a>)</span></p>
<p>The equation of motion in this case is</p>
<p><span class="math display">\[\epsilon x^{(4)} + m\ddot x + \gamma \dot x + kx = 0\]</span></p>
<p>The algebraic equation to solve is now <span class="math inline">\(\epsilon z^4 - mz^2 + i\gamma z + k = 0\)</span>.</p>
</section>
</section>
<section id="hamiltonjacobi-equation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="hamiltonjacobi-equation">Hamilton–Jacobi equation</h2>
<p>Consider again the integral of Lagrangian: <span class="math inline">\(\int L dt\)</span>. If we fix the starting point <span class="math inline">\((t_0, q_0)\)</span> and the ending point <span class="math inline">\((t, q)\)</span>, then in general there can be a countable number of paths that connect both points. This is a serious problem, but we are saved by the fact that these paths are separated, in the sense that around each path <span class="math inline">\(\gamma\)</span>, there is a small neighborhood, in which there exists no other path <span class="math inline">\(\gamma\)</span> that connects the two points <span class="math inline">\((t_0, q_0), (t, q)\)</span>.</p>
<p>As a prototype, consider a billiard ball in a circular table.</p>
<section id="billiards-in-a-circular-board" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="billiards-in-a-circular-board">Billiards in a circular board</h3>
<p>When both <span class="math inline">\(q_0, q\)</span> are the center of the billiard table, then there are <span class="math inline">\(S^1 \times \mathbb{N}\)</span> ways to go from <span class="math inline">\(q_0\)</span> to <span class="math inline">\(q\)</span> over the interval <span class="math inline">\([t_0,t]\)</span>. Here, <span class="math inline">\(S^1\)</span> denotes the circle of possible directions, and <span class="math inline">\(\mathbb{N}\)</span> denotes the discrete number of starting speeds: <span class="math inline">\(\frac{2R}{t-t_0}, \frac{4R}{t-t_0}, \dots\)</span>.</p>
<p>When not both of them are in the center, then there are only in general <span class="math inline">\(\mathbb{N}\)</span> ways to go from <span class="math inline">\(q_0\)</span> to <span class="math inline">\(q\)</span> over the interval <span class="math inline">\([t_0,t]\)</span>.</p>
<p>Consider a billiard ball in a circular (not elliptical) table. Let <span class="math inline">\(q, q_0\)</span> be any two points inside the table, not both on the center, and <span class="math inline">\(t_0 &lt; t\)</span> be two moments in time, then there are a countable infinity of possible trajectories that reach <span class="math inline">\((t, q)\)</span> from <span class="math inline">\((t_0, q_0)\)</span>.</p>
<p>There are two ways to see this visually, a particle way and a wave way.</p>
<p>For the particle way, define:</p>
<ul>
<li>the billiard’s starting angle is <span class="math inline">\(\theta\)</span>, with <span class="math inline">\(\theta\)</span> chosen such that when <span class="math inline">\(\theta = 0\)</span>, the billiard would move on a diameter of the table.</li>
<li><span class="math inline">\(l(\theta, n)\)</span> is the oriented line segment that starts at the point where the billiard’s hits the table for the <span class="math inline">\(n\)</span>-th time, and ends at the point where it hits for the <span class="math inline">\((n+1)\)</span>-th time.</li>
</ul>
<p>For any <span class="math inline">\(n = 1, 2, ...\)</span>, as <span class="math inline">\(\theta\)</span> moves from <span class="math inline">\(\theta = 0\)</span> to <span class="math inline">\(\theta = \pi\)</span>, the line <span class="math inline">\(l(\theta, n)\)</span> smoothly varies from the diameter in one direction to the diameter in the opposite direction. Now, if you take a diameter in the circle, and smoothly turn it around by <span class="math inline">\(180^\circ\)</span>, then no matter how much you shift the line around in the mean time, you are forced to sweep it over every point at least once.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> Consequently, every point can be reached after <span class="math inline">\(n\)</span> reflections, for any positive integer <span class="math inline">\(n\)</span></p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;If you want a hands-on approach, imagine hammering in a nail at some point <span class="math inline">\(q\)</span> in the circle, and putting a long stick on the diameter. Now grab the stick and start turning it around. There is no way for you to turn it by <span class="math inline">\(180^\circ\)</span> without hitting the nail at some time.</p></div></div><p>For the wave way, imagine simultaneously shooting out a billiard in every direction with constant speed, and watch the “wavefront” of billiards evolve. The wavefront is reflected by the table edges and assumes increasingly complicated shapes, but it remains a closed curve (with possible self-intersections). As the closed curve reverberates across the table again and again, it sweeps across every point in the table again and again at discrete intervals.</p>
<p>However, there is no way to smoothly reach one trajectory from any other – you either have to make a discrete jump in how hard you strike the billiard ball, or in which direction you strike. This contrasts with the case with both <span class="math inline">\(q, q_0\)</span> at the center, where you can smoothly vary your striking angle while keeping the same striking force.</p>
<p>Similarly, for a table with smooth boundary, for almost all point-pairs in the table, there are also a countable infinity of trajectories between them. We must say “almost all” to exclude singular cases such as the two focal points of an ellipse, where there is a whole continuum of trajectories between them.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;Exactly counting the singular cases, and studying polygonal, or even non-convex tables, is an ongoing research program, with the name of “dynamical billiard flow”.</p></div></div><p>What is the general lesson for defining <span class="math inline">\(S\)</span>? In general, we also need to fix a particular optimal path <span class="math inline">\(\tilde\gamma\)</span>, and only consider optimal paths that are in a small neighborhood of <span class="math inline">\(\tilde \gamma\)</span>. This is the same idea as selecting a branch cut when dealing with multi-valued functions like the complex logarithm.</p>
<p>Why are we so concerned with reflections? Read on!</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/waves_rays_circle_table.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="margin-caption">The two ways to find trajectories from <span class="math inline">\(q_0\)</span> to <span class="math inline">\(q\)</span>. The particle way involves sending out rays from <span class="math inline">\(q_0\)</span>, reflecting off the walls of the table, until a ray hits <span class="math inline">\(q\)</span>. The wave way involves sending out an expanding wavefront from <span class="math inline">\(q_0\)</span>, rippling through the table, passing over <span class="math inline">\(q\)</span> again and again. The rays are perpendicular to the wavefront in this case.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/square_billiard.jpg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">Similarly, in a rectangular billiard table, there are infinitely many possible ways to go from one point to another, but one cannot go from one way to another continuously.</figcaption>
</figure>
</div>
</section>
<section id="hamiltons-principal-function" class="level3">
<h3 class="anchored" data-anchor-id="hamiltons-principal-function">Hamilton’s principal function</h3>
<p>Consider a problem in traveling: Given a starting spacetime <span class="math inline">\((t_0, q_0)\)</span> and an ending spacetime <span class="math inline">\((t, q)\)</span>, what is the lowest cost of traveling between them? We want to define it as:</p>
<p><span class="math display">\[
S(t, q; t_0, q_0) = \int_{t_0}^t L(\tau, \gamma(\tau), \dot\gamma(\tau))d\tau
\]</span></p>
<p>where <span class="math inline">\(\gamma(\tau)\)</span> is the <em>unique</em> path from <span class="math inline">\((t_0, q_0)\)</span> to <span class="math inline">\((t, q)\)</span>. However, as we saw in the case of circular billiards, we don’t have a unique path in general. Therefore, we should be a bit more careful.</p>
<p>First, we select a prototypical path <span class="math inline">\(\gamma_{prototype}\)</span>. Next, we smoothly vary <span class="math inline">\(\gamma_{prototype}\)</span> until it becomes some path <span class="math inline">\(\gamma\)</span> that goes from <span class="math inline">\((t_0, q_0)\)</span> to <span class="math inline">\((t, q)\)</span>. Finally, define the Hamilton’s principal function using this particular <span class="math inline">\(\gamma\)</span>. The construction is a bit awkward, but it would allow us to avoid the non-uniqueness problem.</p>
<p>Thus, we define the <strong>Hamilton’s principal function</strong>:</p>
<p><span id="eq-hpf"><span class="math display">\[
S(t, q; t_0, q_0) = \int_{t_0}^t L(\tau, \gamma(\tau), \dot\gamma(\tau))d\tau
\tag{1}\]</span></span></p>
</section>
<section id="hamiltonjacobi-equation-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="hamiltonjacobi-equation-1">Hamilton–Jacobi equation</h3>
<p>For all nice enough Lagrangian <span class="math inline">\(L\)</span>, Hamilton’s principal function <span class="math inline">\(S\)</span> is differentiable with respect to <span class="math inline">\((t, q)\)</span>, so we will study its differential equation.</p>
<p>Let’s first consider the easy case: we simply let the trajectory “run a little longer”. That is, we let the trajectory run from <span class="math inline">\((t_0, q_0)\)</span> to <span class="math inline">\((t, q)\)</span>, then let it keep running for <span class="math inline">\(\delta t\)</span>, reaching <span class="math inline">\((t+\delta t, q + \delta q)\)</span>. It’s clear that we have <span class="math inline">\(\delta q = \dot q(t) \delta t\)</span>, and</p>
<p><span class="math display">\[
S(t+\delta t, q + \delta q; t_0, q_0) - S(t, q; t_0, q_0) = \left(\sum_i p_i \dot q_i - H\right)\delta t
\]</span></p>
<p>so we have:</p>
<p><span id="eq-HJ0"><span class="math display">\[
\partial_t S + \sum_i \partial_{q_i}S \dot q_i = - H + \sum_i p_i \dot q_i
\tag{2}\]</span></span></p>
<p>which strongly suggests</p>
<div id="thm-hj" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6</strong></span> <span id="eq-HJ"><span class="math display">\[
(-\partial_t, \nabla_q)S(t, q; t_0, q_0) = (H, p), \quad (-\partial_{t_0}, \nabla_{q_0})S(t, q; t_0, q_0) = (H_0, p_0)
\tag{3}\]</span></span></p>
</div>
<p>If <a href="#eq-HJ" class="quarto-xref">Equation&nbsp;3</a> is indeed true, then we have</p>
<div id="thm-hje" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7 (Hamilton–Jacobi equation)</strong></span> <span class="math display">\[\partial_t S + H(t, q, \nabla_q S) = 0\]</span></p>
</div>
<p>It suffices to prove <span class="math inline">\(\nabla_q S = p\)</span>, since then <span class="math inline">\(\partial_t S = -H\)</span> follows from <a href="#eq-HJ0" class="quarto-xref">Equation&nbsp;2</a>.</p>
<p>It suffices to prove <span class="math inline">\((-\partial_t, \nabla_q)S(t, q; t_0, q_0) = (H, p)\)</span>, since the other one is proved by the same argument, time-reversed.</p>
<p>Recall the economic construction of <span class="math inline">\(p\)</span>. It is a price vector designed specifically to destroy all arbitrage opportunities. Consequently, we can consider an entire family of paths shown in Figure (a, b).</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/HJ0-derivation.jpg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Derivation of the Hamilton–Jacobi equation.</figcaption>
</figure>
</div>
<p>Here, <span class="math inline">\(\gamma\)</span> is the path from <span class="math inline">\((t_0, q_0)\)</span> to <span class="math inline">\((t, q)\)</span>, and <span class="math inline">\(\gamma + \delta \gamma\)</span> is the path to <span class="math inline">\((t, q+\delta q)\)</span>. We interpolate between them by a family of paths <span class="math inline">\(\{\gamma_\tau\}_{\tau}\)</span>, where <span class="math inline">\(\gamma_\tau\)</span> is the path obtained by first moving on <span class="math inline">\(\gamma\)</span> for time <span class="math inline">\(t\in [t_0, \tau]\)</span>, then making a “jump” by “purchasing from the market”<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> an infinitesimal bundle of commodities so that we fall onto the <span class="math inline">\(\gamma + \delta \gamma\)</span> path, then continue along that path.</p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>&nbsp;We are using the market <em>for real</em> now, so the marketeer had better had stocked up on those commodities!</p></div><div id="fn7"><p><sup>7</sup>&nbsp;More precisely, a higher-order infinitesimal than the area of the parallelogram. See <a href="#tip-higher-order-infinitesimal" class="quarto-xref">Tip&nbsp;1</a>.</p></div></div><p>Now consider two such jumped-paths, <span class="math inline">\(\gamma_{\tau}\)</span> and <span class="math inline">\(\gamma_{\tau + \delta \tau}\)</span>, where <span class="math inline">\(\delta \tau\)</span> is an infinitesimal, shown in Figure (c). The cost difference between them is that between two sides of the parallelogram. By the no-arbitrage construction, the difference is zero.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<p>Thus, we can smoothly “glide”<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> the path <span class="math inline">\(\gamma\)</span> to <span class="math inline">\(\gamma + \delta\gamma\)</span> by the family of jumped-paths <span class="math inline">\(\gamma_\tau\)</span>, with <span class="math inline">\(\tau\)</span> going from <span class="math inline">\(t\)</span> to <span class="math inline">\(t_0\)</span>, with no change in cost.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> Thus, the only cost difference between <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\gamma + \delta\)</span> is the cost it takes to buy the bundle of commodities <span class="math inline">\(\delta q\)</span> at the very last instance:</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>&nbsp;In the jargon of topology, this is a homotopy of paths.</p></div><div id="fn9"><p><sup>9</sup>&nbsp;More precisely, their difference in cost is a higher-order infinitesimal than the area of the curvy triangle between them. Since the curvy triangle is an infinitesimal of order <span class="math inline">\(\delta q\)</span>, the difference in cost is a higher-order infinitesimal than <span class="math inline">\(\delta q\)</span>.</p></div></div><p><span class="math display">\[S(t, q+\delta q; t_0, q_0) - S(t, q; t_0, q_0) = \sum_i p_i \delta q_i\]</span></p>
<p>finishing the proof.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="The usual proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The usual proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The HJE has a standard proof, such as the one appearing in <span class="citation" data-cites="goldsteinClassicalMechanics2008">(<a href="#ref-goldsteinClassicalMechanics2008" role="doc-biblioref">Goldstein, Poole, and Safko 2008, chap. 8</a>)</span>. It does not require reasoning with different orders of infinitesimals, but it is less geometrical.</p>
<p>Sketch of the proof:</p>
<ul>
<li>Start with the original system with configuration space <span class="math inline">\((t, q_{1:N}, \dot q_{1:N})\)</span>.</li>
<li>Move to the Hamiltonian equations on phase space <span class="math inline">\((t, q_{1:N}, p_{1:N})\)</span>.</li>
<li>Regard <em>that</em> as part of a larger system with configuration space <span class="math inline">\((t, q_{1:N}, p_{1:N}, \dot q_{1:N}, \dot q_{1:N}))\)</span></li>
<li>Write down the Euler–Lagrange equations for that larger system.</li>
</ul>
</div>
</div>
</div>
<div id="thm-poincare-cartan" class="theorem">
<p><span class="theorem-title"><strong>Theorem 8 (Poincaré–Cartan integral invariant <span class="citation" data-cites="arnoldMathematicalMethodsClassical2001">(<a href="#ref-arnoldMathematicalMethodsClassical2001" role="doc-biblioref">Arnol’d 2001, 237–38</a>)</span>)</strong></span> Draw an arbitrary closed cycle <span class="math inline">\(\alpha\)</span> in phase space-time. Let every point <span class="math inline">\(A \in \alpha\)</span> evolve for some time (not necessarily the same amount of time) to reach some other point <span class="math inline">\(A'\)</span>. Let <span class="math inline">\(\alpha'\)</span> be the cycle consisting of those points <span class="math inline">\(A'\)</span>. Then we have the <strong>Poincaré–Cartan integral invariant</strong></p>
<p><span class="math display">\[
\oint_\alpha \left\langle p, dq\right\rangle - Hdt = \oint_{\alpha'} \left\langle p, dq\right\rangle - Hdt
\]</span></p>
<p>As a special case, if both <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\alpha'\)</span> consists of simultaneous points, then it reduces to the <strong>Poincaré relative integral invariant</strong></p>
<p><span class="math display">\[
\oint_\alpha \left\langle p, dq\right\rangle = \oint_{\alpha'} \left\langle p, dq\right\rangle
\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Divide the tube into ribbons, like a barrel, then note that the integral around each barrel-plank is zero, as argued before. This is a case of the Stokes’ theorem.</p>
<p><img src="figure/poincare_cartan_invariant_proof_cropped.jpg" class="img-fluid"></p>
<p>In more detail, we can consider the four ends of a barrel-plank parallelogram. Label those points as <span class="math inline">\(A, B, A', B'\)</span> as shown. Though the points <span class="math inline">\(A, B, A', B'\)</span> exist in phase space-point, we can forget their momenta, thus projecting them to configuration space-time. Each phase space-time trajectory projects to a trajectory in configuration space-time, and we obtain <span class="math inline">\(S_{A \to B} = S(t_A, q_A; t_B, q_B)\)</span>, etc.</p>
<p>Now, by <a href="#eq-HJ" class="quarto-xref">Equation&nbsp;3</a>, we can shift <span class="math inline">\(S_{A \to B}\)</span> to <span class="math inline">\(S_{A \to B'}\)</span>, then to <span class="math inline">\(S_{A' \to B'}\)</span>:</p>
<p><span class="math display">\[
S_{A \to B} = S_{A \to B'}  -H_B \delta t_B + \left\langle p_B , \delta q_B\right\rangle = S_{A' \to B'} + H_A \delta t_A - \left\langle p_A , \delta q_A\right\rangle -H_B \delta t_B + \left\langle p_B , \delta q_B\right\rangle
\]</span></p>
<p>Now, if we shift around one entire cycle, we would get back the same <span class="math inline">\(S_{A \to B}\)</span>. Thus the two integrals are equal.</p>
<p>We will prove <a href="#thm-noether">Noether’s theorem</a> similarly.</p>
</div>
</div>
</div>
<div id="exr-zero-poincare-cartan" class="theorem exercise page-columns page-full">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> A one-dimensional family of trajectories in phase space sweep out a curved surface. As shown in the illustration, prove that for any cycle <span class="math inline">\(\gamma\)</span> on the curved surface, <span class="math inline">\(\oint_\gamma \left\langle p, dq\right\rangle = 0\)</span>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/zero_poincare_cartan.jpg" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="margin-caption">Illustration for <span class="math inline">\(\oint_\gamma \left\langle p, dq\right\rangle = 0\)</span>.</figcaption>
</figure>
</div>
</div>
</section>
<section id="hamilton-characteristic-function" class="level3">
<h3 class="anchored" data-anchor-id="hamilton-characteristic-function">Hamilton characteristic function</h3>
<p>In most situations, the system is time-independent. In this case we can simplify the HJE to</p>
<p><span class="math display">\[\partial_t S = -H(q, \nabla_q S)\]</span></p>
<p>Since the left side depends on <span class="math inline">\(t\)</span>, but the right side does not explicitly, we can solve this by separation of variables.</p>
<p>Suppose there exists some function <span class="math inline">\(W\)</span>, called the <strong>Hamilton characteristic function</strong>, that satisfies</p>
<p><span id="eq-THJE"><span class="math display">\[
H(q, \nabla_q W(q)) = E
\tag{4}\]</span></span></p>
<p>for some <span class="math inline">\(E\in \mathbb{R}\)</span>, then <span class="math inline">\(S(t, q) = W(q) - Et\)</span> is a solution to the HJE.</p>
<p>We might naively think, by analogy with Fourier transform, that any solution to the HJE is a linear combination, of the form <span class="math inline">\(S(t, q) = \int (W_E(q) - Et)dE\)</span>, but this is not true, since the HJE is nonlinear. Nevertheless, solutions of the form <span class="math inline">\(S(t, q) = W(q) - Et\)</span> are often sufficient for applications.</p>
</section>
<section id="two-more-proofs-of-hje" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="two-more-proofs-of-hje">Two more proofs of HJE</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Proof by positional arbitrage">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof by positional arbitrage
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>We only need to prove <span class="math inline">\(p = \nabla S\)</span>, which is sufficient to prove <a href="#eq-HJ" class="quarto-xref">Equation&nbsp;3</a>, and thus the HJE.</p>
<p>Given a starting position <span class="math inline">\((t_0, q_0)\)</span> and a reference trajectory, there exists some <span class="math inline">\(S(t, q; t_0, q_0)\)</span>, the cost function of arriving at any point in configuration space-time in a neighborhood of the reference trajectory. For each trajectory <span class="math inline">\(\gamma\)</span> in the neighborhood that arrives at <span class="math inline">\((t, q)\)</span>, there exists a final market price <span class="math inline">\(q(t)\)</span>. We need to show that <span class="math inline">\(q = \nabla S\)</span>.</p>
<p>Suppose not, then we can perform positional arbitrage. First, we arrive at <span class="math inline">\(q + \delta q\)</span> by the efficient route, then sell off some <span class="math inline">\(\delta q\)</span>. This would cost us</p>
<p><span class="math display">\[S(t, q+\delta q; t_0, q_0) - \left\langle p, \delta q\right\rangle = S(t, q; t_0, q_0) + \left\langle\nabla S - p, \delta q\right\rangle\]</span></p>
<p>If <span class="math inline">\(\nabla S \neq p\)</span>, then we can take <span class="math inline">\(\delta q = -(\nabla S - p)\epsilon\)</span>, and thus magically make the journey cost less by a first-order infinitesimal. This means the market is inefficient, a contradiction.</p>
</div>
</div>
</div>
<p>Here is a proof in the spirit of wave mechanics and dynamical programming. Though I did not study his proof,<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> I believe this is how the inventor of dynamical programming, <a href="https://en.wikipedia.org/wiki/Richard_E._Bellman">Richard Bellman</a>, proved his extension, the <a href="https://en.wikipedia.org/wiki/Hamilton%E2%80%93Jacobi%E2%80%93Bellman_equation">Hamilton–Jacobi–Bellman equation</a>. The HJBE reduces to the HJE under certain conditions – they do not talk about the same thing, because while HJ is about stationary action, HJB is about maximal action.</p>
<div class="no-row-height column-margin column-container"><div id="fn10"><p><sup>10</sup>&nbsp;In his autobiography, he said,</p>
<blockquote class="blockquote">
<p>Problems of this type had been worked on before by many mathematicians, Euler, Hamilton, and Steiner, but the systematic study of problems of this type was done at RAND starting in 1948 under the inspiration of von Neumann. <span class="citation" data-cites="bellmanEyeHurricaneRichard1984">(<a href="#ref-bellmanEyeHurricaneRichard1984" role="doc-biblioref">Bellman 1984, 208</a>)</span></p>
<p>… one can use dynamic programming for the minimum principles of mathematical physics. For example, with dynamic programming one has a very simple derivation of the eikonal equation. In addition, the Hamilton-Jacobi equation of mechanics can easily be derived. <span class="citation" data-cites="bellmanEyeHurricaneRichard1984">(<a href="#ref-bellmanEyeHurricaneRichard1984" role="doc-biblioref">Bellman 1984, 289</a>)</span></p>
</blockquote>
</div></div><p>Suppose that we have found all points at which the action is equal to <span class="math inline">\(S\)</span>. Now we would like to expand that surface a little further, to the surface of action <span class="math inline">\(S + \delta S\)</span>. We do that in the spirit of economics (of course!) and traveling.</p>
<p>Interpret the action of a path as the cost of traveling along that path. The surfaces of constant action, then, become the <a href="https://en.wikipedia.org/wiki/Isochrone_map">isochrone maps</a>. The problem we face is then a matter of travel planning: Given that we can reach up to surface <span class="math inline">\(X_S\)</span> if we are willing to pay cost <span class="math inline">\(S\)</span>, how much further can we travel if we are willing to pay an additional <span class="math inline">\(\delta S\)</span>?</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/isochrone_map_america.jpg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Isochrone maps of travel time in America, 1800 – 1930. <span class="citation" data-cites="paullinAtlasHistoricalGeography1932">(<a href="#ref-paullinAtlasHistoricalGeography1932" role="doc-biblioref">Paullin 1932</a>, plate 138, page 366)</span></figcaption>
</figure>
</div>
<p>Let us stand at a point <span class="math inline">\((t, q)\)</span> on the surface of action <span class="math inline">\(S\)</span>, and consider all the points we can reach by an additional action <span class="math inline">\(\delta S\)</span>. Suppose we go from <span class="math inline">\((t, q)\)</span> to <span class="math inline">\((t + \epsilon t, q + \epsilon q)\)</span>, then the cost of that is <span class="math inline">\(L\left(t, q, \frac{\epsilon q}{\epsilon q}\right)\epsilon t\)</span>. (We write <span class="math inline">\(\epsilon t\)</span> instead of <span class="math inline">\(\delta t\)</span>, because we have to use that symbol later.)</p>
<p>Therefore, the “wave” of action <span class="math inline">\(\delta S\)</span> coming out of the point <span class="math inline">\((t, q)\)</span> are those points <span class="math inline">\((t + \epsilon t, q + \epsilon q)\)</span> satisfying the equation</p>
<p><span class="math display">\[
L\left(t, q, \frac{\epsilon q}{\epsilon q}\right)\epsilon t = \delta S
\]</span></p>
<p>And the surface of action <span class="math inline">\(S + \delta S\)</span> is the envelope of all those little waves (“wavelets”). This is the wave perspective, but we still need to return to the particle perspective.</p>
<p>Suppose you are already at <span class="math inline">\((t, q)\)</span>, and you just want to reach the surface of <span class="math inline">\(S + \delta S\)</span>. It doesn’t matter where you end up on that surface – you just have to get to that surface <em>somewhere</em>. You also have exactly <span class="math inline">\(\delta S\)</span> to spend, so you have to plan optimally. Now, looking at that picture, you see that the only place you can possibly reach is a certain point <span class="math inline">\((t + \delta t, q + \delta q)\)</span> where the wavelet is tangent to the surface of <span class="math inline">\(S + \delta S\)</span>. At that point, the tangent surfaces of <span class="math inline">\(S\)</span> at <span class="math inline">\((t, q)\)</span> is parallel to the tangent surface of wavelet. That is,</p>
<p><span class="math display">\[
\begin{aligned}
d\left(L\left(t, q,-\frac{\epsilon q}{\epsilon t}\right) \epsilon t\right) |_{\epsilon t = \delta t, \epsilon q = \delta q} &amp;= \left\langle(\left(\nabla_q L\right) \underbrace{\delta t}_{\rightarrow 0}+\nabla_v L), d q\right\rangle +\left(L-\frac{\delta q}{\delta t} \nabla_v L\right) d t \\
&amp;\propto dS
\end{aligned}
\]</span></p>
<p>Thus, there exists some constant <span class="math inline">\(c &gt; 0\)</span> such that</p>
<p><span class="math display">\[
(\partial_t S, \nabla_q S) = c \left(\left\langle\nabla_v L, \frac{\delta q}{\delta t}\right\rangle - L , \nabla_v L\right) = (-cH, cp)
\]</span></p>
<p>Since we also have</p>
<p><span class="math display">\[
\partial_t S \delta t + \left\langle\nabla_q S, \delta q\right\rangle = \delta S = L \delta t
\]</span></p>
<p>we see <span class="math inline">\(c=1\)</span>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/hje_proof.jpg" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="margin-caption">The wavelet proof of the HJE.</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Convexity of the wavelet">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Convexity of the wavelet
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the wavelet is convex, then the tangent point is unique, and there is only one way to proceed from <span class="math inline">\((t, q)\)</span>. However, if the wavelet is not, then there could exist <em>two</em> or more particle paths shooting out from <span class="math inline">\((t, q)\)</span>. It is similar to <a href="https://en.wikipedia.org/wiki/Birefringence">birefringence</a> and conical refraction <span class="citation" data-cites="lunneyInsOutsConical2006">(<a href="#ref-lunneyInsOutsConical2006" role="doc-biblioref">Lunney and Weaire 2006</a>)</span>.</p>
</div>
</div>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3</strong></span> If you have studied, or intend to study, control theory, then prove the Hamilton–Jacobi–Bellman equation using the exact same picture. You can also prove the stochastic HJB equation in the same way, though you would need to insert the expectation <span class="math inline">\(\mathbb{E}\)</span> somewhere.</p>
</div>
</section>
<section id="bonus-noethers-theorem" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="bonus-noethers-theorem">Bonus: Noether’s theorem</h3>
<p>In Noether’s theorem, symmetries of the Lagrangian give us conserved quantities of motion.</p>
<ul>
<li><span class="math inline">\(\epsilon\)</span> is an infinitesimal number.</li>
<li>An <strong>infinitesimal transform</strong> is an infinitesimal deformation <span class="math inline">\((\delta t, \delta q)\)</span> of configuration space-time.
<ul>
<li><span class="math inline">\(\delta t = \epsilon T\)</span>, where <span class="math inline">\(T\)</span> a function of type <span class="math inline">\(\underbrace{\mathbb{R}}_{\text{time}} \times \underbrace{\mathcal C}_{\text{configuration space}} \to \mathbb{R}\)</span></li>
<li><span class="math inline">\(\delta q = \epsilon Q\)</span>, where <span class="math inline">\(Q\)</span> is a function of type <span class="math inline">\(\mathbb{R}\times \mathcal C \to \mathbb{R}^d\)</span>, where <span class="math inline">\(d\)</span> is the dimension of configuration space <span class="math inline">\(\mathcal C\)</span>.</li>
</ul></li>
<li>An infinitesimal transform is a <strong>symmetry of the Lagrangian</strong>, iff taking any path <span class="math inline">\(\gamma\)</span> (not necessarily physically real), and deforming it to <span class="math inline">\(\gamma'\)</span>, the action is conserved: <span class="math inline">\(\int_\gamma L dt = \int_{\gamma'} L dt\)</span>.</li>
<li>A <strong>conserved quantity of motion</strong> is a number depending on <span class="math inline">\(t, q, \dot q\)</span>, such that it is constant along any physically real path <span class="math inline">\(\gamma\)</span>.</li>
</ul>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4</strong></span> We defined “symmetry of the Lagrangian” by a condition on an integral: <span class="math inline">\(\int_\gamma L dt = \int_{\gamma'} L dt\)</span>. Reformulate this to a condition at a point, involving <span class="math inline">\(L, Q, T\)</span> and their derivatives.</p>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>A symmetry of the Lagrangian conserves <em>all</em> actions, even those of unphysical paths, but a conserved quantity of motion is only conserved along physical paths. We may call them “conserved quantity of <em>physical</em> motion” to emphasize the distinction.</p>
</div>
</div>
<p>Take a trajectory <span class="math inline">\(\gamma_{AA'}\)</span> from point <span class="math inline">\(A\)</span> to <span class="math inline">\(A'\)</span>. Now, shift it by <span class="math inline">\(\delta t, \delta q\)</span>, resulting in a trajectory <span class="math inline">\(\gamma_{BB'}\)</span> from point <span class="math inline">\(B\)</span> to <span class="math inline">\(B'\)</span>. Since <span class="math inline">\(L\)</span> is invariant under symmetry, any such shifting gives us <span class="math inline">\(S_{AA'} = S_{BB'}\)</span>. Now, if <span class="math inline">\(\delta S \neq 0\)</span> in a neighborhood of the given trajectory <span class="math inline">\(\gamma_{AA'}\)</span>, then we can take this variation <span class="math inline">\(\delta \gamma\)</span>, and shift it by the symmetry, showing that <span class="math inline">\(\delta S \neq 0\)</span> in a neighborhood of <span class="math inline">\(\gamma_{BB'}\)</span> too.</p>
<p>Therefore, by Hamilton’s principle, the infinitesimal transform sends any physically real trajectory into another physically real trajectory.</p>
<div id="thm-noether" class="theorem">
<p><span class="theorem-title"><strong>Theorem 9 (Noether’s theorem)</strong></span> If <span class="math inline">\((t, q) \mapsto (t + \epsilon T, q + \epsilon Q)\)</span> is an infinitesimal symmetry of the Lagrangian, then</p>
<p><span class="math display">\[
H T - \left\langle p, \delta Q\right\rangle = (\left\langle\nabla_v L, \dot q\right\rangle - L)T - \left\langle\nabla_v L, Q\right\rangle
\]</span></p>
<p>is a conserved quantity of motion.</p>
</div>
<p>Technically speaking, we should not confuse the left side and the right side of</p>
<p><span class="math display">\[
H T - \left\langle p, \delta Q\right\rangle = (\left\langle\nabla_v L, \dot q\right\rangle - L)T - \left\langle\nabla_v L, Q\right\rangle
\]</span></p>
<p>The left side is defined on the phase space-time, while the right side is defined on the configuration space-time. They are equal only because we have soldered together the phase space and the configuration space.</p>
<p>Indeed, again and again we see that Lagrangian and Hamiltonian mechanics are different worlds, with their own dreams and phantasies, but always agreeing on the same reality.</p>
<p>If this were the case, then why do we bother creating two mechanics, since there is no physical experiment to distinguish them? It is because in quantum mechanics, virtual trajectories are just as real as the “real” trajectories. A particle can just go around the earth once before it arrives at its destination, taking the long way around. In this case, what is virtually possible matters just as much as what is classically real, and if Lagrangian mechanics and Hamiltonian mechanics can entertain different kinds of dreams, we might be able to tell them apart.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/qed_2006_fig_24.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="margin-caption"><span class="math inline">\(S\)</span> is a source of photons, and <span class="math inline">\(P\)</span> is a receiver. A photon can go from <span class="math inline">\(S\)</span> to <span class="math inline">\(P\)</span> by bouncing off the mirror below, along many paths. Each path has a certain amplitude, and the sum of all their amplitudes is the total amplitude. While the amplitude is dominated by the amplitudes near the classical path <span class="math inline">\(SGP\)</span>, it is not the only path, and all paths, even the “virtual” paths like <span class="math inline">\(SAP\)</span>, contribute to what we observe. <span class="citation" data-cites="feynmanQEDStrangeTheory2006">(<a href="#ref-feynmanQEDStrangeTheory2006" role="doc-biblioref">Feynman 2006, fig. 24</a>)</span></figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Given any physically real trajectory <span class="math inline">\(\gamma_{AA'}\)</span> from point <span class="math inline">\(A\)</span> to <span class="math inline">\(A'\)</span>, the infinitesimal transform sends it to another physically real <span class="math inline">\(\gamma_{BB'}\)</span>. By symmetry, both paths have the same action. Thus, we have</p>
<p><span class="math display">\[
S(A, A') = S(B, B')
\]</span></p>
<p>Now, consider an intermediate path <span class="math inline">\(\gamma_{A, B'}\)</span>. By <a href="#eq-HJ" class="quarto-xref">Equation&nbsp;3</a>,</p>
<p><span class="math display">\[
S(A, B') = S(A, A') - H \delta t + \left\langle p, \delta q\right\rangle, \quad S(B, B') = S(A, B') + H_0 \delta t_0 - \left\langle p_0, \delta q_0\right\rangle
\]</span></p>
<p>Therefore, <span class="math inline">\(H T - \left\langle p, \delta Q\right\rangle\)</span> is a conserved quantity of motion.</p>
</div>
</div>
</div>
<p>The proof is similar to the proof of <a href="#thm-poincare-cartan" class="quarto-xref">Theorem&nbsp;8</a>, though they differ in that Noether’s theorem shows a quantity, defined at a single point, is conserved over a trajectory, while the Poincaré–Cartan invariant is not defined at a single point, but as an integral over an entire cycle.</p>
<p><img src="figure/banner/2.png" class="img-fluid"></p>
</section>
</section>
<section id="sec-geometric-optics" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-geometric-optics">Hamiltonian optics</h2>
<section id="isotropic-case" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="isotropic-case">Isotropic case</h3>
<p>We are going back to the roots, as geometric optics was what inspired Hamilton to develop his theory of Hamiltonian mechanics.</p>
<p>When Hamilton developed his Hamiltonian approach, it was to study geometric optics, which can be derived from Fermat’s principle: <em>light paths have stationary travel time</em>. In other words, the action of a path is</p>
<p><span class="math display">\[S(\text{path}) = \int_{\text{path}} dt\]</span></p>
<p>Thus, <span class="math inline">\(L = 1\)</span>...? Well, here we see the problem: in geometric optics, if you fix the starting and ending point as <span class="math inline">\((t_0, q_0), (t, q)\)</span>, then <em>any</em> path between them takes exactly <span class="math inline">\(t-t_0\)</span> time, and there is nothing to vary. Consequently, we need to remove time from consideration, so that there is something to vary.</p>
<p>Fermat’s principle, reformulated, states <em>light paths have stationary optical length</em>. Let the medium be isotropic (light speed does not depend on direction), then we have</p>
<p><span class="math display">\[S(\text{path}) = \int_{\text{path}} n(q) \|dq\|\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the refractive index, with <span class="math inline">\(L(q) = n(q)\)</span>. Here we encounter a brief difficulty: time flows in one direction only, but space flows in infinitely many possible directions!</p>
<p>The solution might seem like a joke, but it would work out well: select one direction<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>, say <span class="math inline">\(q_0\)</span>, and pretend that it is time. With this trick, all previous mathematical formalism immediately applies, and we have</p>
<div class="no-row-height column-margin column-container"><div id="fn11"><p><sup>11</sup>&nbsp;This direction is usually selected to be the direction of the <strong>principal optic axis</strong>. For example, the long-axis of a camera is a principal optic axis, and so is the barrel-axis of a telescope.</p></div></div><p><span class="math display">\[S(\text{path}) = \int_{\text{path}} n(q_0, q_1, q_2) \sqrt{1 + \left(\frac{dq_1}{dq_0}\right)^2 + \left(\frac{dq_2}{dq_0}\right)^2}dq_0\]</span></p>
<section id="derivation" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="derivation">Derivation</h4>
<p>Let’s make the notation cleaner, by rewriting <span class="math inline">\(q_0\)</span> as <span class="math inline">\(t\)</span>, <span class="math inline">\((q_1, q_2)\)</span> as <span class="math inline">\(q\)</span>, and using <span class="math inline">\(v\)</span> to mean <span class="math inline">\(\left(\frac{dq_1}{dq_0}, \frac{dq_2}{dq_0}\right)\)</span>. Then we have</p>
<p><span class="math display">\[L(t, q, v) = n(t, q) \sqrt{1 + \|v\|^2}\]</span></p>
<p>Routine calculation yields</p>
<p><span class="math display">\[\begin{cases}     
L(t, q, v) = n(t, q) \sqrt{1 + \|v\|^2}\\     
H(t, q, p) = -\sqrt{n^2 - \|p\|^2}
\end{cases} \quad
\begin{cases}     
p^\ast = \frac{nv}{\sqrt{1 + \|v\|^2}} \\     
v^\ast = \frac{p}{\sqrt{n^2 - \|p\|^2}}
\end{cases}\]</span></p>
<p>we continue with the HJE, which simplifies to:</p>
<p><span class="math display">\[(\partial_t S)^2 + \|\nabla_q S\|^2 = n^2\]</span></p>
<p>Reverting notation back to <span class="math inline">\((q_0, q_1, q_2)\)</span>, we find the <strong>eikonal equation</strong><a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>:</p>
<div class="no-row-height column-margin column-container"><div id="fn12"><p><sup>12</sup>&nbsp;From Greek εἰκών (<em>eikon</em>, “image”), from which the word “icon” derived.</p></div></div><p><span class="math display">\[\|\nabla_q S\| = n(q)\]</span></p>
<p>Why did the trick work? Well, if we look back to how we derived the Hamiltonian, we could see that what we called “time” is really just a special copy of <span class="math inline">\(\mathbb{R}\)</span>, along which we organized all other state and control variables. We don’t really need time to be anything more than the domain of functions, as in <span class="math inline">\(q_i: \mathbb{R}\to \mathbb{R}\)</span> and <span class="math inline">\(v_i : \mathbb{R}\to \mathbb{R}\)</span>. It most definitely does not need to “flow”, or flow only from the past to the future, or have any psychological significance.</p>
</section>
<section id="interpretation" class="level4">
<h4 class="anchored" data-anchor-id="interpretation">Interpretation</h4>
<p>Starting with Fermat’s principle for light rays, we ended up with the eikonal equation for light waves. In general, we find the following duality between wave-field optics and particle-path optics.</p>
<table class="caption-top table">
<caption>The particle-wave duality.</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 36%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>perspective</th>
<th>particle-path</th>
<th>wave-field</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>action <span class="math inline">\(S\)</span></td>
<td>a function of particle path</td>
<td>a field on configuration-spacetime</td>
</tr>
<tr class="even">
<td>equation</td>
<td><span class="math inline">\(\|\nabla_q S\| = n(q)\)</span></td>
<td><span class="math inline">\(\partial_t S + H(t, q, \nabla_q S) = 0\)</span></td>
</tr>
<tr class="odd">
<td>in optics</td>
<td>light rays, Fermat’s principle</td>
<td>light waves, Huygens principle</td>
</tr>
<tr class="even">
<td>in mechanics</td>
<td>point particles</td>
<td>matter waves</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="anisotropic-case" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="anisotropic-case">Anisotropic case</h3>
<p>When the travel cost of light can depend on the direction of travel, we say that the medium is anisotropic. Now, you might expect</p>
<p><span class="math display">\[
S = \int n(\hat{\delta q}) \delta q
\]</span></p>
<p>but this is incorrect, not because there is anything necessarily wrong with the formalism, but because of how <span class="math inline">\(n\)</span> is defined by convention in anisotropic material. At this point, we must study the full particle-wave duality again.</p>
<p>For a moment, let’s pretend light is really a particle, and consider how it might appear to someone who believes light is a wave. We arrange an entire plane of photons, such that the plane is perpendicular to a unit vector <span class="math inline">\(\hat k\)</span>. Now, let them move optimally for time <span class="math inline">\(\delta\)</span>. Each of them would go in the same optimal direction <span class="math inline">\(v^*(\hat k)\)</span>, to push the wavefront as far-out as possible.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/planar_group_velocity.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="margin-caption">A plane of particles marching in sync at velocity <span class="math inline">\(v\)</span>, but the collective effect is that the plane moves with group velocity <span class="math inline">\(v_g\)</span>, which is different from the individual velocity <span class="math inline">\(v\)</span>.</figcaption>
</figure>
</div>
<p>Now, the wavefront does not move in the direction <span class="math inline">\(v^*\)</span>, but in the direction <span class="math inline">\(\hat k\)</span>. Therefore, the wavefront moves at <strong>group velocity</strong> <span class="math inline">\(v_g(\hat k) = \left\langle v^*(\hat k), \hat k\right\rangle \hat k\)</span>.</p>
<p>Since the photons are trying to push as far out as possible,</p>
<p><span class="math display">\[v^*(\hat k) = \mathop{\mathrm{argmax}}_{v \in K_{particle}} \left\langle\hat k, v\right\rangle\]</span></p>
<p>where we write <span class="math inline">\(K_{particle}\)</span> as the surface of all particle velocities in all directions. It is a sphere of radius <span class="math inline">\(c\)</span> in a vacuum, but in an anisotropic medium, we allow it to be any crazy shape.</p>
<p>Instead of studying the group velocity, we actually need to use its inverse – the wavevector <span class="math inline">\(k = \frac{\hat k}{v_g}\)</span>.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> We thus have</p>
<div class="no-row-height column-margin column-container"><div id="fn13"><p><sup>13</sup>&nbsp;The typical definition is <span class="math inline">\(k_{usual} = \frac{2\pi}{\lambda}\hat k = \nabla \phi\)</span>, where <span class="math inline">\(\phi\)</span> is the phase of the light, and <span class="math inline">\(f\)</span> is its temporal frequency. Our definition, which makes it cleaner, but somewhat different from typical definition, is <span class="math inline">\(k_{ours} = \frac{\nabla \phi}{2\pi f} = \frac{\nabla \phi}{\omega}\)</span>.</p></div></div><p><span class="math display">\[k = \frac{\hat k}{\max_{v \in K_{particle} \left\langle v, \hat k\right\rangle}}\]</span></p>
<p>The reason we use this instead of the group velocity is that, a little simplification later, we have the beautifully simple relation</p>
<p><span class="math display">\[
\forall k \in K_{wave}, \quad \max_{v \in K_{particle}}\left\langle v, k\right\rangle = 1
\]</span></p>
<p>This is a suggestive symmetry, which practically demands us to write it as a duality:</p>
<p><span class="math display">\[
\begin{cases}
v^*(k) = \mathop{\mathrm{argmax}}_{v \in K_{particle}}\left\langle v, k\right\rangle \\
k^*(v) = \mathop{\mathrm{argmax}}_{k \in K_{wave}}\left\langle v, k\right\rangle
\end{cases}, \quad
\begin{cases}
\left\langle v^*(k), k\right\rangle = 1\\
\left\langle v, k^*(v)\right\rangle = 1\\
\end{cases}
\]</span></p>
<p>This is the polar dual construction, often used in convex analysis.<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a> <span class="citation" data-cites="hiriart-urrutyFundamentalsConvexAnalysis2001">(<a href="#ref-hiriart-urrutyFundamentalsConvexAnalysis2001" role="doc-biblioref">Hiriart-Urruty and Lemaréchal 2001, sec. C.3</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="fn14"><p><sup>14</sup>&nbsp;What, just because we have not mentioned Legendre transform for a few pages, you would think that we’re done with convex analysis? Too bad! If nature is the great optimizer, then convex analysis is inescapable at every turn.</p></div></div><p>The best case is if <span class="math inline">\(K_{particle}\)</span> is convex. In this case, each <span class="math inline">\(k \in K_{wave}\)</span> defines a plane perpendicular to it, at a distance <span class="math inline">\(\|k\|^{=1}\)</span> from the origin, and the plane is tangent to <span class="math inline">\(K_{particle}\)</span> at precisely <span class="math inline">\(v^*(k)\)</span>, and conversely so. In other words, <span class="math inline">\(K_{particle}\)</span> is the envelope of polar lines to points in <span class="math inline">\(K_{wave}\)</span>, and conversely so.</p>
<p>Conversely, we can pretend that light is really a wave, and consider how it might appear to someone who believes light is a particle. We would then go through the above argument, and obtain the same result.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/polar_duals_convex.jpg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">A pair of polar duals. Both surfaces are convex.</figcaption>
</figure>
</div>
<p>However, we want to deal with more general cases than this, so we need to resolve two issues.</p>
<p>First issue: <span class="math inline">\(K_{particle}\)</span> might be non-convex. Second issue: it might be double-sheeted, or even many-sheeted. For example, in crystal, light polarized in two different orientations can move at two different velocities even in the same direction. Thus, its <span class="math inline">\(K_{wave}\)</span> has two sheets, and so its polar dual, <span class="math inline">\(K_{particle}\)</span>, also has two sheets.</p>
<p>Both issues are solved by extending the definition of polar duality: replace the maximum with a stationarity. We can still construct <span class="math inline">\(K_{particle}\)</span> from <span class="math inline">\(K_{wave}\)</span> by taking a tangent plane for each <span class="math inline">\(k \in K_{wave}\)</span>, but now instead of the intersection of the half-planes, we use their envelope. A picture shows what we mean:</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/polar_duals_generic.jpg" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="margin-caption">A pair of polar duals. The surfaces are no longer convex. Notice how the double tangent on the left becomes a double crossing point on the right.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/trefoil_dual.svg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The curve on the right is a trefoil curve defined by <span class="math inline">\(z = 0.3 e^{i\phi} + e^{-2i \phi}\)</span>, shifted to make the image clearer. The curve on the left is the polar dual of the trefoil curve. It is the envelope of the polar dual lines of each point on the trefoil curve.</figcaption>
</figure>
</div>
<p>We still have a duality between points on the two surfaces, defined by stationarity, not optimality. For example, for any wavevector <span class="math inline">\(k \in K_{wave}\)</span>, its corresponding dual point <span class="math inline">\(v^*(k)\)</span> satisfies <span class="math inline">\(\left\langle v^*(k) + \delta v, k\right\rangle = 0\)</span> for any <span class="math inline">\(\delta v\)</span> in the tangent space of <span class="math inline">\(K_{particle}\)</span> at <span class="math inline">\(v^*(k)\)</span>.</p>
<p>The first application of Hamiltonian mechanics was done by Hamilton, who in 1832 predicted theoretically that if light enters a biaxial crystal in just the right way, it will not just refract in one direction, but in an entire <em>cone</em> of directions – which he termed <a href="https://en.wikipedia.org/wiki/Conical_refraction">internal conical refraction</a>. The theory of this is fascinating,<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a> however, for lack of space, we will only give the barest description.</p>
<div class="no-row-height column-margin column-container"><div id="fn15"><p><sup>15</sup>&nbsp;It was historically important as the first phenomenon predicted by mathematical reasoning before experimental observation <span class="citation" data-cites="berryChapterConicalDiffraction2007">(<a href="#ref-berryChapterConicalDiffraction2007" role="doc-biblioref">Berry and Jeffrey 2007</a>)</span>, and it was often compared to the mathematical prediction of Neptune by Le Verrier (1845) <span class="citation" data-cites="smithCambridgeNetworkAction1989">(<a href="#ref-smithCambridgeNetworkAction1989" role="doc-biblioref">Smith 1989</a>)</span>.</p></div></div><p>Simply put, it turns out that in a biaxial crystal, both <span class="math inline">\(K_{particle}\)</span> and <span class="math inline">\(K_{wave}\)</span> have the same shape of a large blob containing a smaller blob, touching each other at 4 cone-shaped points, as pictured.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/schaefer_1949_fig_128.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The shape of the <span class="math inline">\(K_{wave}\)</span> surface. The <span class="math inline">\(K_{particle}\)</span> surface is topologically the same, and can be obtained from <span class="math inline">\(K_{wave}\)</span> by squashing it <em>just right</em>. Figure from <span class="citation" data-cites="schaeferBandTeilElektrodynamik1949">(<a href="#ref-schaeferBandTeilElektrodynamik1949" role="doc-biblioref">Schaefer 1949, 485</a>, figure 128)</span></figcaption>
</figure>
</div>
<p>Now, let <span class="math inline">\(k_c \in K_{wave}\)</span> be one of the cone-shaped points, then it corresponds to a tangent plane to <span class="math inline">\(K_{particle}\)</span>. Each tangent point <span class="math inline">\(v \in K_{particle}\)</span>, conversely, corresponds to a tangent plane to <span class="math inline">\(k_c\)</span>.</p>
<p>Since <span class="math inline">\(k_c\)</span> is a conical point, however, there are a whole <em>circle</em> of tangent planes to <span class="math inline">\(K_{wave}\)</span> at <span class="math inline">\(k_c\)</span>. Consequently, the tangent plane to <span class="math inline">\(K_{particle}\)</span> is tangent to it on one entire circle. It is as if we throw a tire on the floor – it will touch the floor not just at three points, but an entire circle of points. Now, suppose that we have a planar wave moving in the direction of <span class="math inline">\(k_c\)</span> inside the crystal, then each light-particle would have to move in a direction <span class="math inline">\(\mathop{\mathrm{argmax}}_{v \in K_{particle}}\left\langle v, k_c\right\rangle\)</span>. But since there is an entire circle of such directions, we would have an entire circle of possible <span class="math inline">\(v\)</span>, and thus, we obtain a hollow cone of light.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/conical_refraction_tangent_velocity.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="margin-caption">When a planar wave travels in a crystal, such that <span class="math inline">\(K_{particle}\)</span> is tangent to the plane of the wave at an entire circle, then instead of choosing one among the entire circle of velocities, the particles simply take every single possible direction on the circle, resulting in conical refraction.</figcaption>
</figure>
</div>
</section>
</section>
<section id="the-particle-wave-duality" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-particle-wave-duality">The particle-wave duality</h2>
<section id="particle-in-free-space" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="particle-in-free-space">Particle in free space</h3>
<p>Consider a particle of mass <span class="math inline">\(m\)</span> in free space <span class="math inline">\(\mathbb{R}^n\)</span>. Its Lagrangian is <span class="math inline">\(L(t, q, v) = \frac 12 m\|v\|^2\)</span>. By convex duality, we have</p>
<p><span class="math display">\[\begin{cases} L(t, q, v) = \frac 12 m\|v\|^2\\ H(t, q, p) = \frac{\|p\|^2}{2m} \end{cases}\quad  
\begin{cases} p^\ast(t, q, v) = mv\\ v^\ast(t, q, p) = \frac{p}{m} \end{cases}\]</span></p>
<p>For any <span class="math inline">\(t_0, q_0, t, q\)</span> with <span class="math inline">\(t_0\neq t\)</span>, we can directly solve for the trajectory from <span class="math inline">\((t_0, q_0)\)</span> to <span class="math inline">\((t, q)\)</span>, then find the action:</p>
<p><span class="math display">\[S_{t_0, q_0}(t, q) = \frac 12 m \frac{\|q-q_0\|^2}{t-t_0}\]</span></p>
<p>Each <span class="math inline">\(S\)</span> defines a paraboloid wavefront in spacetime, with apex <span class="math inline">\(t_0, q_0\)</span>. The wavefront is translation-symmetric, so we set both to zero, yielding the equation of the wavefront:</p>
<p><span class="math display">\[
t = \frac{\|q\|^2}{2S/m}
\]</span></p>
<p>The wavefront of <span class="math inline">\(S = 0\)</span> is just the positive <span class="math inline">\(t\)</span>-axis, and as <span class="math inline">\(S\)</span> increases, the wavefront widens out.</p>
<p>Now, we interpret this wave from the HJE point of view. Let’s say we have the wavefront at <span class="math inline">\(S=S_0\)</span>, and we want to construct the wavefront at <span class="math inline">\(S = S_0 + \delta S\)</span>. This we perform by rippling out a little wavelet at each point <span class="math inline">\((t', q')\)</span> on the wavefront. The little wavelet has shape <span class="math inline">\((t-t') = \frac{\|q - q'\|^2}{2\delta S/m}\)</span>, and as we move <span class="math inline">\(t', q'\)</span> around the parabola of wavefront <span class="math inline">\(S = S_0\)</span>, the envelope of these wavelets is the wavefront of <span class="math inline">\(S = S_0 + \delta S\)</span>.</p>
<p>This is the wave point of view. We can switch back to the particle point of view. What is the velocity of the particle passing the point <span class="math inline">\((t', q')\)</span>? We know that it must be traveling in the optimal direction, and the optimal direction allows it to go as far as possible. Therefore, we simply draw the wavelet of <span class="math inline">\(\delta S\)</span> at <span class="math inline">\((t', q')\)</span>, then find the intersection of the wavelet with the wavefront of <span class="math inline">\(S = S_0 + \delta S\)</span>.</p>
<p>The entire procedure is pictured below.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/free_particle_point_source.svg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The two red curves are two wavefronts <span class="math inline">\(S = S_0\)</span> and <span class="math inline">\(S = S_0 + \delta S\)</span>. At select points on the first wavefront, we draw a wavelet of <span class="math inline">\(\delta S\)</span>, which is tangent to the second wavefront. The particle trajectory connects the point and the tangent point of the wavelet with the second wavefront.</figcaption>
</figure>
</div>
</section>
<section id="particle-wave-in-free-space" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="particle-wave-in-free-space">Particle-wave in free space</h3>
<p>The paraboloid-shaped solution for <span class="math inline">\(S\)</span> is interpretable in Newtonian mechanics, as the motion of a single particle moving from the origin. However, the HJE itself is merely a PDE with its own logic and meaning, and consequently, it may have different solutions that are hard to to interpret in Newtonian mechanics.</p>
<p>From our 21st-century perspective, we can say that the HJE is generally true, and Newtonian mechanics is only a special case. Some solutions to the HJE may not be interpretable in Newtonian mechanics, but they are nevertheless physically real, since Newtonian mechanics is incomplete. Given that, we simply try to solve HJE, then try to interpret it, even if not in Newtonian mechanics.</p>
<p>Because the Lagrangian is time-independent, so any <a href="#eq-THJE">time-independent solution</a>:</p>
<p><span class="math display">\[S(t, q) = W(q) - Et, \quad \| \nabla_q W \| = \sqrt{2mE}\]</span></p>
<p>for any constant <span class="math inline">\(E &gt; 0\)</span> also gives a solution to the HJE. This is just the eikonal equation for a medium of constant wave speed! More on this in <a href="#sec-geometric-optics">the section on geometric optics</a>. One can of course solve the eikonal equation by putting it into a numerical package and let it grind out the solution. However, we can interpret it by the Huygens principle.</p>
<p>Suppose you know a surface of constant <span class="math inline">\(W = W_0\)</span>, and you know that the arrows of <span class="math inline">\(\nabla_q W\)</span> point outwards, then since <span class="math inline">\(\nabla W\)</span> is perpendicular to the surface, and is of constant length <span class="math inline">\(\sqrt{2mE}\)</span>, you can step out a small distance <span class="math inline">\(ds\)</span> perpendicularly out of the whole surface <span class="math inline">\(W= W_0\)</span>, and arrive at the surface of <span class="math inline">\(W=W_0 + \sqrt{2mE} ds\)</span>. Alternatively, you can draw small spheres of radius <span class="math inline">\(ds\)</span>, and their outwards envelope is the <span class="math inline">\(W=W_0+ \sqrt{2mE} ds\)</span> surface. These procedures are equivalent, but in one, we constructed “rays” while the other we constructed “wave fronts”.</p>
<p>For the free particle, the simplest solution is the plane wave:</p>
<p><span class="math display">\[W(q) = \sqrt{2mE} \langle \hat k, q \rangle\]</span></p>
<p>where <span class="math inline">\(\hat k\)</span> is any unit-vector, interpreted as the direction of wave propagation. Plugging it back to <a href="#eq-HJ" class="quarto-xref">Equation&nbsp;3</a>, we find that the “planar wave particle” has</p>
<p><span class="math display">\[(\partial_t S, \nabla S) = (-H, p) = (-E, \sqrt{2mE}\hat k)\]</span></p>
<p>where <span class="math inline">\(\hat k\)</span> is the direction of the group velocity of the wave. The group velocity of the wave is <span class="math inline">\(\frac{\partial_t S}{\nabla S} = \frac{E}{\sqrt{2mE}}\hat k\)</span>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/free_particle_planar_wave.svg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The two red curves are two wavefronts <span class="math inline">\(S = S_0\)</span> and <span class="math inline">\(S = S_0 + \delta S\)</span>. At select points on the first wavefront, we draw a wavelet of <span class="math inline">\(\delta S\)</span>, which is tangent to the second wavefront. The particle trajectory connects the point and the tangent point of the wavelet with the second wavefront.</figcaption>
</figure>
</div>
<p>Taking the particle-wave analogy seriously, we say that:</p>
<ul>
<li>a planar wave is a particle with energy <span class="math inline">\(E\)</span> and momentum <span class="math inline">\(p \propto k \propto \sqrt{2mE} \hat k\)</span>.</li>
<li>a particle with energy <span class="math inline">\(E\)</span> and momentum <span class="math inline">\(p\)</span> is a planar wave traveling at group velocity <span class="math inline">\(E/p\)</span>.</li>
</ul>
<p>Typically, waves have a wavelength <span class="math inline">\(\lambda\)</span>, which is related to the wave vector <span class="math inline">\(k\)</span> by <span class="math inline">\(k \propto \lambda^{-1}\)</span>, we find that the particle has wavelength <span class="math inline">\(\lambda \propto \frac 1k \propto \frac 1p\)</span>. Thus, we arrived at de Broglie’s matter-wave hypothesis, which Schrödinger expanded into his equation. Both de Broglie and Schrödinger were inspired by Hamilton’s optics-mechanics analogy, so we are treading the same path as them a century ago.</p>
<p>In fact, we could start with an arbitrary wavefront in configuration-spacetime, and use Huygens’ principle to construct the wavefront in the next moment. In general, we can’t do Fourier analysis on such wavefronts – they are not decomposable into planar waves, because the HJE is a nonlinear equation. Fourier analysis only works on linear differential equations.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/free_particle_cubic_curve.svg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Given a wavefront in the shape of <span class="math inline">\(t = q^3\)</span>, we can construct the next wavefront as the envelope of the parabolic wavelets at every point on the wavefront.</figcaption>
</figure>
</div>
</section>
<section id="particle-in-a-potential-field" class="level3">
<h3 class="anchored" data-anchor-id="particle-in-a-potential-field">Particle in a potential field</h3>
<p>A particle in a time-dependent potential field <span class="math inline">\(V\)</span> has Lagrangian <span class="math inline">\(L(t, q, v) = \frac 12 m\|v\|^2 - V(t, q)\)</span>. By convex duality</p>
<p><span class="math display">\[\begin{cases}     
L(t, q, v) = \frac 12 m\|v\|^2 - V(t, q)\\     
H(t, q, p) = \frac{\|p\|^2}{2m} + V(t, q)
\end{cases} \quad
\begin{cases}     
p^\ast = mv \\     
v^\ast = \frac pm
\end{cases}\]</span></p>
<p>The HJE gives</p>
<p><span class="math display">\[\partial_t S + \frac 1{2m} \|\nabla_q S\|^2 = -V(t, q)\]</span></p>
<p>As before, if we interpret the equation as a wave equation, then the group velocity is <span class="math inline">\(\frac{\partial_t S}{\nabla S} = \frac{-E}{p} \hat k\)</span>, with magnitude <span class="math inline">\(v_g = \frac{E}{\sqrt{2m(E-V)}}\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Example: particle in free fall">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example: particle in free fall
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We consider the classical problem of a body in free fall, thrown from the origin <span class="math inline">\((t, q) = (0, 0)\)</span>. Basic physics tells us that the position and velocity of the body are given by</p>
<p><span class="math display">\[q(t) = v_0 t - \frac{1}{2}gt^2, \quad v = v_0 - gt = \frac{q}{t} - \frac{1}{2}gt\]</span></p>
<p>Plugging these expressions into the Hamilton-Jacobi equation, we obtain a system of partial differential equations for the action function <span class="math inline">\(S\)</span>:</p>
<p><span class="math display">\[
\begin{cases}
\partial_t S &amp;= -H = -\frac{1}{2}m(\frac{q}{t} - \frac{gt}{2})^2 - mgq \\
\partial_q S &amp;= m(\frac{q}{t} - gt)
\end{cases}
\]</span></p>
<p>Solving this system, we find the unique solution for the action:</p>
<p><span class="math display">\[S = \frac{x^2}{y} - xy - \frac{y^3}{12}\]</span></p>
<p>where we have introduced convenience variables <span class="math inline">\(x = gq\)</span>, <span class="math inline">\(y = gt\)</span>, and <span class="math inline">\(s = \frac{2gS}{m}\)</span>.</p>
<p>The contour lines of the action function satisfy the equation:</p>
<p><span class="math display">\[
x = \frac{1}{2}y^2 \pm \sqrt{\frac{1}{3}y^4 + sy}
\]</span></p>
<p>To analyze the wavelet associated with this system, we start by writing down the Lagrangian:</p>
<p><span class="math display">\[L = T - V = \frac{1}{2}m(\frac{\delta q}{\delta t})^2 - mgq\]</span></p>
<p>The wavelet equation is then given by:</p>
<p><span class="math display">\[\delta S = L \delta t = \left(\frac{1}{2}m(\frac{\delta q}{\delta t})^2 - mgq\right)\delta t\]</span></p>
<p>Simplifying this equation using our convenience variables, we get:</p>
<p><span class="math display">\[(\delta x)^2 = 2x(\delta y)^2 + \delta s \delta y\]</span></p>
<p>Solving for <span class="math inline">\(\delta y\)</span>, we obtain:</p>
<p><span class="math display">\[\delta y = \frac{-\delta s \pm \sqrt{(\delta s)^2 + 8x(\delta x)^2}}{4x}\]</span></p>
<p>This equation reveals the nature of the wavelet. When <span class="math inline">\(x &gt; 0\)</span>, the equation describes a hyperbola. For <span class="math inline">\(x &lt; 0\)</span>, it describes an ellipse. At the boundary <span class="math inline">\(x = 0\)</span>, the equation describes a parabola.</p>
<p><img src="figure/falling_particle_point_source.svg" class="img-fluid"></p>
<p>There is no planar wave solution, because a planar wave solution is both constant energy and unbounded, whereas if a particle can move infinitely far away, it must have infinite energy. If we attempt to force a planar wave solution, it would immediately break down:</p>
<p><img src="figure/falling_particle_planar_wave.svg" class="img-fluid"></p>
</div>
</div>
</div>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 5</strong></span> Solve the time-independent HJE for the particle in free fall. It should be <span class="math inline">\(S = W(q) - Et\)</span>, where <span class="math inline">\(E\)</span> is a constant, and <span class="math inline">\(W\)</span> is a <a href="https://en.wikipedia.org/wiki/Semicubical_parabola">semicubical parabola</a>.</p>
</div>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 6</strong></span> In the same way, analyze the simple harmonic oscillator – a particle in a potential well <span class="math inline">\(V = \frac 12 kq^2\)</span>. Similarly, it cannot have a planar wave solution. Plot the wavelets along each point on a planar wave, and see how it breaks down. Find two families of solutions: The case where we have a point source at <span class="math inline">\((0, 0)\)</span>, and the case of time-independent HJE.</p>
</div>
</section>
<section id="deriving-the-time-independent-schrödinger-equation" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="deriving-the-time-independent-schrödinger-equation">Deriving the time-independent Schrödinger equation</h3>
<p><small>This section based on <span class="citation" data-cites="masoliverClassicalQuantumMechanics2009 derbesFeynmanDerivationSchrodinger1996 hamillStudentGuideLagrangians2013">(<a href="#ref-masoliverClassicalQuantumMechanics2009" role="doc-biblioref">Masoliver and Ros 2009</a>; <a href="#ref-derbesFeynmanDerivationSchrodinger1996" role="doc-biblioref">Derbes 1996</a>; <a href="#ref-hamillStudentGuideLagrangians2013" role="doc-biblioref">Hamill 2013, sec. 6.4</a>)</span>.</small></p>
<p>Assume that the potential is time-independent: <span class="math inline">\(V(t, q) = V(q)\)</span>. Assume that the physical system can be described by a function</p>
<p><span class="math display">\[
\Psi(t, q) = \Psi_0(r) e^{iS(t, q)/\hbar}
\]</span></p>
<p>where the function <span class="math inline">\(\Psi\)</span> is typically called the “wave function”.<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a> We assume that the wave is a “standing wave”, so that all of space is oscillating in sync. Let <span class="math inline">\(S(t, q) = W(q) - Et\)</span>, so that the oscillation frequency is <span class="math inline">\(E/\hbar\)</span>.<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn16"><p><sup>16</sup>&nbsp;What is a wave function? It is just some abstract mathematical object, that somehow allows us to calculate everything we want to know about this system. We have no idea what it is, but it works. The same applies to the function <span class="math inline">\(S(t, q)\)</span>. We call it the “minimal cost” for arriving at <span class="math inline">\((t, q)\)</span>, but what really is a cost in physics? Particles do not really pay their paths with natural money. All this time, we have pretended that they pay some kind of cost and want to minimize the cost, but it is really just one big analogy. The same applies for the function <span class="math inline">\(\Psi\)</span>. We might call it a “wave function”, but it really is just one big analogy with the waves on an ocean. There is really no wave in quantum mechanics, only a function that we pretend is a wave, because it helps us calculate results that happen to be correct.</p></div><div id="fn17"><p><sup>17</sup>&nbsp;The most important experimental result from quantum mechanics is that energy levels are quantized. Now, a quantized energy level is something like <span class="math inline">\(E = h, 2h, 3h, \dots\)</span>. There is really just one kind of thing in classical mechanics that is quantized: standing waves! If you have a string, then its standing waves must have <span class="math inline">\(0, 1, 2, 3, \dots\)</span> nodes, i.e.&nbsp;quantized. Thus, it is natural to try out this “standing wave” assumption.</p></div></div><p>So, we can separate the variables to</p>
<p><span class="math display">\[
\Psi(t, q) = \underbrace{e^{-i\frac{E}{\hbar}t}}_{\text{oscillation in sync}} \underbrace{\psi(q)}_{\text{variation over space}}, \quad \psi(q) = \Psi_0(q) e^{i\frac{W(q)}{\hbar}t}
\]</span></p>
<p>Since <span class="math inline">\(\Psi\)</span> should be a wave, it has better follow the wave equations:</p>
<p><span class="math display">\[
(\partial_t^2 - v_g^2 \nabla^2)\Psi = 0
\]</span></p>
<p>where <span class="math inline">\(v_g\)</span> is the group velocity of the wave. As we saw previously, <span class="math inline">\(v_g = \frac{E}{\sqrt{2m(E-V)}}\)</span> for a particle in a potential. Then we have</p>
<p><span class="math display">\[
\begin{cases}
\Psi(t, q) &amp;= e^{-i\frac{E}{\hbar} t} \psi(q), \\
0 &amp;= (\partial_t^2 - v_g^2 \nabla^2)\Psi, \\
v_g &amp;= \frac{E}{\sqrt{2m(E-V)}},
\end{cases}\;\; \implies \frac{\hbar^2}{2 m} \nabla^2 \psi+(E-V) \psi = 0,
\]</span></p>
<p>which is the time-independent Schrödinger equation.</p>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7</strong></span> The time-dependent Schrödinger equation states that</p>
<p><span class="math display">\[
i\hbar\frac{\partial}{\partial t} \Psi(t, q) = \left [ - \frac{\hbar^2}{2m}\nabla^2 + V(t, q)\right ] \Psi(t, q).
\]</span></p>
<p>Plug <span class="math inline">\(\Psi(t, q) = \psi_0(t, q) e^{i S(t, q)/\hbar}\)</span> back to the time-dependent Schrödinger equation, and check that at the <span class="math inline">\(\hbar \to 0\)</span> limit, we recover the HJE for <span class="math inline">\(S(t, q)\)</span>. This is a simple example of the <a href="https://en.wikipedia.org/wiki/WKB_approximation">WKB approximation</a>.</p>
</div>
<p>If the above derivation looks mildly suspect, and leaves you with a feeling of seeing a magic trick, it is not an accident. The analogy between classical mechanics and quantum mechanics is not exact, so we cannot logically derive quantum mechanics from classical mechanics. The simple problem is that classical mechanics, even when formulated in the form of Hamilton–Jacobi wave equations, cannot reproduce interference or diffractions. Consider the simple case of a straight-edge diffraction. If you aim a light beam at a sharp edge, then on the other side, there would be alternating bright and dark bands fading into the shadow. However, if light is going by the shortest path, then there should be no such banding, and the brightness should just drop off to zero monotonically.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/no_classical_diffraction.jpg" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="margin-caption">In classical mechanics, the shadow of a hard edge has no diffractive stripes.</figcaption>
</figure>
</div>
<p>The solution is to admit that geometric optics is insufficient, that Huygens’ principle is insufficient, and we need a full theory of light wave in order to explain what happens on the smallest scales – a diffraction theory. Similarly, classical mechanics is insufficient, and the HJE is insufficient, and we need a full theory of matter wave in order to explain what happens in the atomic world – quantum mechanics.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/optical-mechanical_analogy.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The optical-mechanical analogy at three levels. There is a question mark, because I’m not sure if that should be quantum field theory.</figcaption>
</figure>
</div>
<p>Deriving quantum mechanics from classical mechanics is necessarily fraught with danger and luck, because in going from quantum mechanics to classical mechanics, something is irrevocably lost (and other things are irrevocably earned). It is about as difficult as going from geometric optics to wave optics. Still, several people have tried and succeeded, most famously, Schrödinger.</p>
<blockquote class="blockquote">
<p>… the conception of rays is thoroughly well defined only in pure abstract geometrical optics. It is wholly incapable of being applied to the fine structure of real optical phenomena, i.e.&nbsp;to the phenomena of diffraction. Even in extending geometrical optics somewhat by adding the notion of Huygens’ principle, one is not able to account for the most simple phenomena of diffraction without adding some further very strange rules concerning the circumstances under which Huygens’ envelope-surface is or is not physically significant. (I mean the construction of “Fresnel’s zones”.) These rules would be wholly incomprehensible to one versed in geometrical optics alone. Furthermore it may be observed that the notions which are fundamental to real physical optics, i.e.&nbsp;the wave-function itself (<span class="math inline">\(W\)</span> is merely the phase), the equation of wave-propagation, the wave length and frequency of the waves, do not enter at all into the above stated analogy.</p>
<p><span class="citation" data-cites="schrodingerUndulatoryTheoryMechanics1926">(<a href="#ref-schrodingerUndulatoryTheoryMechanics1926" role="doc-biblioref">Schrödinger 1926</a>)</span></p>
</blockquote>
<blockquote class="blockquote">
<p>… geometrical optics is only an approximation… when interference and diffraction phenomena are involved, it is quite inadequate. This prompted the thought that classical mechanics is also only an approximation relative to a vaster wave mechanics. … A new mechanics must be developed which is to classical mechanics what wave optics is to geometrical optics. This new mechanics has since been developed, thanks mainly to the fine work done by Schrödinger.</p>
<p>Louis de Broglie’s Nobel Prize Lecture <span class="citation" data-cites="debroglieWaveNatureElectron1929">(<a href="#ref-debroglieWaveNatureElectron1929" role="doc-biblioref">De Broglie 1929</a>)</span></p>
</blockquote>
</section>
<section id="relativistic-particle-in-free-space" class="level3">
<h3 class="anchored" data-anchor-id="relativistic-particle-in-free-space">Relativistic particle in free space</h3>
<p>Since the HJE is fully general for any function <span class="math inline">\(L(t, q, v)\)</span> that is smooth and strictly convex in <span class="math inline">\(v\)</span>, we can simply write down the Lagrangian for relativistic particle in a field, and it would <em>just work</em>.</p>
<p>Let’s first consider particle in free space. In relativity, the one thing that is coordinate-independent is the proper time of a trajectory, so it is reasonable to <em>guess</em> that the action is the proper time, then deduce from it the Lagrangian. This is natural if we think of <span class="math inline">\(S\)</span> as the optimal cost of traveling.</p>
<p>Let <span class="math inline">\(t_0 = 0, q_0 = 0\)</span>, then by basic relativity, the proper time for the particle to arrive at <span class="math inline">\((t, q)\)</span> is</p>
<p><span class="math display">\[S(t, q) = \frac{\|q\|}{v\gamma} = \sqrt{t^2- \frac{\|q\|^2}{c^2}}\]</span></p>
<p>where <span class="math inline">\(\gamma = \frac{1}{\sqrt{1-v^2/c^2}}\)</span> is the well-known factor used everywhere in special relativity.</p>
<p>Taking <span class="math inline">\(\nabla_q\)</span>, and simplifying, we find the relativistic momentum to be...</p>
<p><span class="math display">\[p = \nabla_q S = -\frac{\gamma v}{c^2}\]</span></p>
<p>However, we were expecting <span class="math inline">\(p \to mv\)</span> when <span class="math inline">\(v \to 0\)</span>, so we fix this issue by multiplying the action with a constant factor <span class="math inline">\(-mc^2\)</span>. Multiplying a constant factor in action has no effect on the calculus of variations, so we are free to do this. Thus we find that the action of a path is the proper time of the path multiplied by <span class="math inline">\(-mc^2\)</span>:</p>
<p><span class="math display">\[S(\text{path}) = -mc^2 \int_{\text{path}}d\tau = -mc^2 \int_{\text{path}}\frac 1\gamma dt\]</span></p>
<p>With this, we can derive the familiar equations by the HJE and convex duality:</p>
<p><span class="math display">\[\begin{cases}
L(q, v) = -\frac{mc^2}{\gamma}\\     
H(q, p) = \sqrt{(\|p\|c)^2 + (mc^2)^2}
\end{cases} \quad
\begin{cases}     
p^\ast = \gamma mv \\     
v^\ast = \frac{pc}{\sqrt{\|p\|^2 + (mc)^2}}
\end{cases}\]</span></p>
<p>In particular, at low <span class="math inline">\(v\)</span>, we have <span class="math inline">\(L \approx -mc^2 + \frac 12 m\|v\|^2\)</span>. So somehow, by combining the <em>geometry</em> of spacetime with analytical mechanics, we have discovered the <span class="math inline">\(E = mc^2\)</span> formula, even though it seems like something we couldn’t have discovered from mere geometry.</p>
<p>The HJE then becomes</p>
<p><span class="math display">\[\frac 1{c^2} \left(\partial_t S \right)^2 - \|\nabla S \|^2 = m^2 c^2\]</span></p>
<p>In particular, the time-independent solutions are of the form</p>
<p><span class="math display">\[S = W(q)-Et, \quad \| \nabla W \| = \frac 1c \sqrt{E^2 - m^2 c^4 }\]</span></p>
<p>for any <span class="math inline">\(E &gt; mc^2\)</span>. In particular, if we plug in the usual relativistic energy <span class="math inline">\(E = \gamma mc^2\)</span>, we get</p>
<p><span class="math display">\[\| \nabla W \| = \gamma mv\]</span></p>
<p>which is similar to what we obtained for the free particle in classical mechanics, with <span class="math inline">\(\|\nabla W \| = \sqrt{2mE}\)</span>, just with classical momentum upgraded to relativistic momentum.</p>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8</strong></span> Just as how the HJE of a classical particle can be derived as the <span class="math inline">\(\hbar \to 0\)</span> limit of the Schrödinger equation, one can derive the HJE of the non-quantum relativistic particle as the <span class="math inline">\(\hbar \to 0\)</span> limit of the Klein–Gordon equation. The Klein–Gordon equation is essentially the simplest possible way to combine special relativity with Schrödinger equation:</p>
<p><span class="math display">\[\left( \frac{1}{c^2} \frac{\partial^2}{\partial t^2} - \nabla^2 + \frac{m^2 c^2}{\hbar^2} \right) \psi(t, \mathbf{x}) = 0\]</span></p>
<p>Plug in <span class="math inline">\(\psi(t, q) = \psi_0(q, t) e^{i S(t, q) / \hbar}\)</span>, and check that at <span class="math inline">\(\hbar \to 0\)</span> limit, we recover the HJE.</p>
</div>
<p><img src="figure/banner/3.png" class="img-fluid"></p>
</section>
</section>
<section id="periodic-motion" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="periodic-motion">Periodic motion</h2>
<section id="oscillator-on-a-line" class="level3">
<h3 class="anchored" data-anchor-id="oscillator-on-a-line">Oscillator on a line</h3>
<p>Consider a simple harmonic oscillator (SHO), with Hamiltonian <span class="math inline">\(H\)</span> in the <span class="math inline">\((q, p)\)</span> coordinates:</p>
<p><span class="math display">\[H(t, q, p) = \frac{p^2}{2m} + \frac 12 kq^2\]</span></p>
<p>The motion of the system is simply a circular motion around <span class="math inline">\((q, p) = (0, 0)\)</span>:</p>
<p><span class="math display">\[\begin{cases}
\dot q = p/m \\
\dot p = - kq
\end{cases}\quad  
\begin{cases}
(q, p) = (q_0 \cos(\omega t), -m\omega q_0 \sin(\omega t)) \\
\omega = \sqrt{k/m}
\end{cases}\]</span></p>
<p>Now consider the action of an entire cycle:</p>
<p><span class="math display">\[S = \oint Ldt = \oint (pdq - Hdt)\]</span></p>
<p>The <span class="math inline">\(\oint pdq\)</span> term is the area enclosed by the ellipse, so it is <span class="math inline">\(\pi p_0 q_0\)</span>, and the <span class="math inline">\(\oint Hdt\)</span> term is just <span class="math inline">\(HT = \frac{2\pi}{\omega} \frac 12 kq_0^2\)</span>, since the system conserves energy. Now direct computation shows</p>
<p><span class="math display">\[\oint pdq = HT\]</span></p>
<p>In particular, since <span class="math inline">\(T\)</span> does not depend on the energy of the oscillation, we can take derivative against energy, obtaining</p>
<p><span class="math display">\[
\frac{d}{dE}\oint_{\gamma_E} pdq = T
\]</span></p>
<p>where <span class="math inline">\(\gamma_E\)</span> is the path traced out by the oscillator with energy <span class="math inline">\(E\)</span>. We show that this is generally true for 1D oscillators.</p>
<div id="thm-1d-oscillator-period" class="theorem">
<p><span class="theorem-title"><strong>Theorem 10</strong></span> Given any 1D oscillator,</p>
<p><span class="math display">\[
\frac{d}{dE}\oint_{\gamma_E} pdq = T(E)
\]</span></p>
<p>where <span class="math inline">\(\gamma_E\)</span> is the path traced out by the oscillator when it has energy <span class="math inline">\(E\)</span>, and <span class="math inline">\(T(E)\)</span> is the period.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Consider the phase space plot of a generic 1D oscillator. Every point in its phase space must go in a cycle, returning to the start again. Thus, its phase space is like an ugly onion: It is split into cycles, which are not generally circular in shape, and generally each cycle has a different cycling period.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figure/1doscillator.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>Take a particular cycle as shown, starting and ending at <span class="math inline">\(q_0 = q_1\)</span>. Now consider this variation that fixes <span class="math inline">\((t_0, q_0), (t_1, q_1)\)</span>: move from point 0 to point 1, then go around the larger cycle to point 1, then return to point 0. The action of the varied cycle consists of three parts: <span class="math inline">\(0\to 1, 1 \to 1, 1 \to 0\)</span>. By (modified) Hamilton’s principle, the variation of action is zero.</p>
<p>Now, let <span class="math inline">\(T(E) = t_1 - t_0\)</span> be the cycle period for the cycle with energy <span class="math inline">\(E\)</span>, then from our above argument, we have</p>
<p><span class="math display">\[\oint_E pdq - E T(E) = \oint_{E + \delta E} pdq - (E + \delta E) T(E) + O(\delta E^2)\]</span></p>
<p>where the <span class="math inline">\(O(\delta E^2)\)</span> term deals with the <span class="math inline">\(0\to 1, 1\to 0\)</span> parts of <span class="math inline">\(\int -Hdt\)</span>. Thus we obtain</p>
<p><span class="math display">\[\frac{d}{dE} \oint_E pdq = T(E)\]</span></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Worked example: pendulum in gravity">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worked example: pendulum in gravity
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The 1D pendulum in gravity, with length <span class="math inline">\(l\)</span> and mass <span class="math inline">\(m\)</span>, has Lagrangian <span class="math inline">\(L = \frac 12 m(l\dot q)^2 + mgl\cos q\)</span>, momentum <span class="math inline">\(p = ml^2 \dot q\)</span>, and Hamiltonian</p>
<p><span class="math display">\[H = \frac{p^2}{2ml^2} - mgl \cos(q)\]</span></p>
<p>We know that the pendulum is not a SHO. Indeed, the cycle period <span class="math inline">\(T(E)\)</span> strictly increases with energy <span class="math inline">\(E\)</span> of the cycle, and it diverges as the pendulum swing approaches the highest point: <span class="math inline">\(\lim_{E \to mgl} T(E) = +\infty\)</span>.</p>
<p>Consider the cycle with maximum swing angle <span class="math inline">\(\theta\)</span>. The cycle encloses an oval-shaped region in phase space, with equation <span class="math inline">\(p^2 = 2m^2 gl^3(\cos q - \cos\theta)\)</span>. Consequently, we have the somewhat mysterious result:</p>
<p><span class="math display">\[\int_0^{E(\theta)} T(E) dE = 4\sqrt{2m^2 gl^3} \int_0^\theta \sqrt{\cos q - \cos\theta} dq\]</span></p>
<p>where <span class="math inline">\(E(\theta) = -mgl \cos\theta\)</span> is the energy of the system when it has maximum swing angle <span class="math inline">\(\theta\)</span>.</p>
<p>When <span class="math inline">\(\theta\)</span> is small, the integral is approximately</p>
<p><span class="math display">\[\int_0^\theta \sqrt{\frac 12 (\theta^2 - q^2)}dq = \frac{\pi\theta^2}{4\sqrt 2}\]</span></p>
<p>which does correspond to <span class="math inline">\(T(E) \approx 2\pi\sqrt{\frac lg}\)</span>, and <span class="math inline">\(\delta E = mgl(1 - \cos(\theta)) \approx \frac 12 mgl \theta^2\)</span>.</p>
<p>When <span class="math inline">\(\theta = \pi\)</span>, the integral can be exactly evaluated:</p>
<p><span class="math display">\[\int_0^{mgl} T(E) dE = 16\sqrt{m^2 gl^3}\]</span></p>
<p>We are unable to interpret this strange but satisfying equality.</p>
<p>Taking <span class="math inline">\(\partial_\theta\)</span> under the integral sign, we get</p>
<p><span class="math display">\[T(E) = \sqrt{\frac{8l}g} \int_0^\theta \frac{dq}{\sqrt{\cos q - \cos \theta}}\]</span></p>
<p>which may be directly verified.</p>
</div>
</div>
</div>
</section>
<section id="action-angle-variables" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="action-angle-variables">Action-angle variables</h3>
<p>Now, it would be great if we could “unwind” the rotatory dynamics by a time-independent canonical transform to some <span class="math inline">\((Q, P)\)</span>, by where <span class="math inline">\(P\)</span> is constant along the cycles, and <span class="math inline">\(Q\)</span> is increasing. That is, we want <span class="math inline">\(P\)</span> to be the analog of “amplitude”, and <span class="math inline">\(Q\)</span> to be the analog of “phase angle”.</p>
<p>Since the transform is time-independent and canonical, the Hamiltonian <span class="math inline">\(H\)</span> is unmodified, so <span class="math inline">\(H\)</span> is a function of <span class="math inline">\(P\)</span> only, not <span class="math inline">\(Q\)</span> (since <span class="math inline">\(H\)</span> is a conserved quantity of motion). Then, since the transform is canonical, Hamilton’s equations of motion read <span class="math inline">\(\dot Q = \partial_P H(P)\)</span>. Consequently, the Hamiltonian equations of motion would become</p>
<p><span class="math display">\[\begin{cases} P(t) = P(0) \\ Q(t) = Q(0) + H'(P) t \end{cases}\]</span></p>
<p>as simple as it could be! It remains to find such a canonical transform.</p>
<p>We are already mostly there: we know that <span class="math inline">\(P\)</span> is constant along the cycles, and <span class="math inline">\(Q\)</span> increasing along the cycles. It remains to find the right scaling, so that the transform is canonical, that is, the coordinates preserve area: <span class="math inline">\(dP \wedge dQ = dp \wedge dq\)</span>.</p>
<p>Define <span class="math inline">\(P = \frac{1}{2\pi} \oint pdq\)</span>. Here the <span class="math inline">\(2\pi\)</span> factor is not essential, since we could always do a point transform, scale down <span class="math inline">\(Q\)</span> by <span class="math inline">\(2\pi\)</span>, and scale up <span class="math inline">\(P\)</span> by <span class="math inline">\(2\pi\)</span>. However, the factor will make many formulas look cleaner.</p>
<p>From the proof of <a href="#thm-1d-oscillator-period" class="quarto-xref">Theorem&nbsp;10</a>, we know that increasing the energy of the cycle by <span class="math inline">\(\delta H\)</span> would increase the cycle area by <span class="math inline">\(T(H)\delta H\)</span>, and the cycle area is <span class="math inline">\(2\pi P\)</span>, thus</p>
<p><span class="math display">\[\delta(2\pi P) = T(H) \delta H \implies \frac{2\pi}{T(H)} = H'(P)\]</span></p>
<p>so we find that the equations of motion are:</p>
<p><span class="math display">\[\begin{cases} P(t) = P(0) \\ Q(t) = Q(0) + 2\pi \frac{t}{T(H)} \end{cases}\]</span></p>
<p>This allows us to graphically construct the <span class="math inline">\((Q, P)\)</span> coordinates on phase space:</p>
<ol type="1">
<li>Draw the cycles in phase space.</li>
<li>Select a “line of longitude” arbitrarily as <span class="math inline">\(Q = 0\)</span> line.</li>
<li>Follow the trajectory of each point on the line of longitude, and mark down a new line of longitude at equal phases-angles. So for example, if you are on the cycle of energy <span class="math inline">\(E\)</span>, you would start the ride, and after <span class="math inline">\(T(E)/3\)</span> has passed, note down its phase-angle as <span class="math inline">\(2\pi/3\)</span>. The set of all such points at every cycle is the line of longitude with <span class="math inline">\(Q = 2\pi/3\)</span>.</li>
</ol>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/1doscillator-canonical.jpg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">Constructing a canonical coordinate system over the phase space of the 1D oscillator.</figcaption>
</figure>
</div>
<p>Now, we can graphically see that this construction really preserves areas:</p>
<ol type="1">
<li>Take an infinitesimal parallelogram at <span class="math inline">\((Q, P)\)</span> with sides <span class="math inline">\(\delta Q, \delta P\)</span>, such that <span class="math inline">\(\delta Q = \frac{2\pi}{N}\)</span> for some infinite integer <span class="math inline">\(N\)</span>.</li>
<li>Evolve the system in discrete steps of <span class="math inline">\(\frac{T(P)}{N}\)</span>, and follow the parallelogram along.</li>
<li>Note that the parallelogram would tile the thin ring between <span class="math inline">\(P\)</span> and <span class="math inline">\(P+ \delta P\)</span>. The thin ring has area <span class="math inline">\(\delta \oint pdq = 2\pi \delta P\)</span>, so each parallelogram has area <span class="math inline">\(2\pi \delta P/N = \delta P \delta Q\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is not as trivial as it seems. The “area” in phase space was defined by <span class="math inline">\(\oint pdq\)</span>, but we did not say that <span class="math inline">\(p, q\)</span> are perpendicular in any sense. Thus, it is not obvious that <span class="math inline">\(\delta P \delta Q\)</span> would be the area of the parallelogram. Indeed, we <em>should not</em> say that <span class="math inline">\(p, q\)</span> are perpendicular, because angles do not exist and <em>should not</em> exist in phase space.</p>
</div>
</div>
<p>The entire construction of <span class="math inline">\((Q, P)\)</span> from <span class="math inline">\((q, p)\)</span> is often done in one divinely-inspired move by a generating function.</p>
</section>
<section id="adiabaticity" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="adiabaticity">Adiabaticity</h3>
<p><small>This section based on <span class="citation" data-cites="duncanConstructingQuantumMechanics2019 deoliveiraParametricInvariance2022">(<a href="#ref-duncanConstructingQuantumMechanics2019" role="doc-biblioref">Duncan and Janssen 2019, chap. 5</a>; <a href="#ref-deoliveiraParametricInvariance2022" role="doc-biblioref">de Oliveira 2022</a>)</span>.</small></p>
<p>The Lorentz pendulum is a famous example that connects the classical and the quantum world. In the early 1900s, as physicists were trying to explain various phenomena, such as the black body radiation spectrum, the atomic spectra, and such, they came to the <strong>quantum hypothesis</strong>. Consider a classical system undergoing periodic motion – such as the electrons cycling around a proton in the hydrogen atom. Whereas classically, its <span class="math inline">\(\oint pdq\)</span> may be of any value, the quantum hypothesis states that it can only take values in</p>
<p><span class="math display">\[
\oint pdq = nh, \quad n = 1, 2, 3, \dots
\]</span></p>
<p>for a certain constant of nature <span class="math inline">\(h\)</span> – later given the name of <strong>Planck’s constant</strong>. For example, if we have a simple harmonic oscillator, then we have</p>
<p><span class="math display">\[
E\nu = n h
\]</span></p>
<p>where <span class="math inline">\(\nu = 1/T\)</span> is the frequency of the oscillator.</p>
<p>At the 1911 Solvay Conference, where the great physicists grappled with the new quantum phenomena,<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a> Einstein gave a presentation on the quantum hypothesis. At the end of the presentation, Lorentz asked a question about the pendulum. The conversation went as follows:</p>
<div class="no-row-height column-margin column-container"><div id="fn18"><p><sup>18</sup>&nbsp;The entire conference is summarized in <span class="citation" data-cites="straumannFirstSolvayCongress2011">(<a href="#ref-straumannFirstSolvayCongress2011" role="doc-biblioref">Straumann 2011</a>)</span>.</p></div></div><blockquote class="blockquote">
<p>Mr.&nbsp;Lorentz recalls a conversation he had with Mr.&nbsp;Einstein some time ago, in which they discussed a simple pendulum that could be shortened by holding the string between two fingers and sliding them downwards. Suppose that initially, the pendulum has exactly one energy element corresponding to the frequency of its oscillations. It then seems that at the end of the experiment, its energy will be less than the element corresponding to the new frequency.</p>
<p>Mr.&nbsp;Einstein – If the length of the pendulum is changed infinitely slowly, the energy of the oscillation remains equal to <span class="math inline">\(h\nu\)</span>, if it was initially equal to <span class="math inline">\(h\nu\)</span> ; it varies proportionally to the frequency. The same is true for a resistance-free oscillating electrical circuit, and also for free radiation.</p>
<p>Mr.&nbsp;Lorentz – This result is very curious and removes the difficulty. In general, the hypothesis of energy elements gives rise to interesting problems in all cases where one can change the frequency of vibrations at will.</p>
<p><span class="citation" data-cites="institutssolvayTheorieRayonnementQuanta1912">(<a href="#ref-institutssolvayTheorieRayonnementQuanta1912" role="doc-biblioref">Instituts Solvay et al. 1912, 450</a>)</span></p>
</blockquote>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/adiabatic-pendulum.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption class="margin-caption">The adiabatic pendulum of Lorentz. Figure from <span class="citation" data-cites="fowler13AdiabaticInvariants2020">(<a href="#ref-fowler13AdiabaticInvariants2020" role="doc-biblioref">Fowler 2020</a>)</span></figcaption>
</figure>
</div>
<p>Why is this interesting? The quantum hypothesis states that for quantum oscillators, <span class="math inline">\(E/\nu = nh\)</span>, where <span class="math inline">\(n\)</span> can only take values in the natural numbers. The Lorentz pendulum seems to show that the quantity <span class="math inline">\(E/\nu\)</span> can change continuously. Thus, for example, we might start at a quantized value of <span class="math inline">\(E/\nu = 100h\)</span>, and end up at <span class="math inline">\(100.5h\)</span>, invalidating the quantum hypothesis for macroscopic systems. And if macroscopic systems do not follow the quantum hypothesis, then as the macroscopic system becomes microscopic, it seems the quantum hypothesis would be invalidated as well.</p>
<p>Einstein replied that <span class="math inline">\(E/\nu\)</span> of the oscillator <em>is conserved</em> if the length of the pendulum is changed infinitely slowly. Surprising, but it saves the quantum hypothesis.</p>
<section id="the-adiabatic-theorem" class="level4">
<h4 class="anchored" data-anchor-id="the-adiabatic-theorem">The adiabatic theorem</h4>
<p>Consider a pendulum with a string length <span class="math inline">\(\lambda\)</span> that is slowly changed over time. How slow? Slow enough that the system completes many cycles before <span class="math inline">\(\lambda\)</span> makes any appreciable change. That is,</p>
<p><span class="math display">\[\dot \lambda \ll \frac{\lambda}{T(\lambda)}\]</span></p>
<div class="callout callout-style-default callout-warning callout-titled" title="Parametric resonance">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parametric resonance
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is vitally important that the pulling on the pendulum is not only slow, but also “smeared”, meaning that <span class="math inline">\(\dot\lambda\)</span> is equal over the entirety of a single oscillation. If it is not smeared, then we can break the theory. Consider for example a (spherical) child on a (frictionless) swing (in a vacuum). It is well-known that the child can, by swinging the legs in sync with the swing, get as high as possible. This is called parametric resonance.</p>
<p>Compared to adiabatic change, parametric resonance differs in that it is discriminating about the states. When you adiabatically pull on the string of a pendulum, your rate of pulling is the same over the entire cycle of a pendulum swing. When you resonantly pull on the string of a pendulum, your rate of pulling differs over the cycle of a pendulum swing. In the language of thermodynamics, adiabaticity means treating all microstates equally, without discrimination.</p>
</div>
</div>
<p>Let the angular frequency of oscillation be <span class="math inline">\(\omega = \sqrt{\frac g\lambda}\)</span>, then <span class="math inline">\(E/\omega\)</span> is constant over time.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By basic physics, the force in the string is</p>
<p><span class="math display">\[
F = mg \cos \theta + m\dot \theta^2 / \lambda \approx mg - \underbrace{\frac 12 mg \theta^2}_{\text{$V/\lambda$}} + \underbrace{m\lambda \dot\theta^2}_{\text{$2T/\lambda$}}
\]</span></p>
<p>Because the system is undergoing simple harmonic oscillation, the time-average of <span class="math inline">\(V\)</span> and <span class="math inline">\(T\)</span> are both <span class="math inline">\(\frac 12 E\)</span>, where <span class="math inline">\(E\)</span> is the oscillation energy. Therefore, the time-average force is <span class="math inline">\(\bar F = mg + \frac 12 E/\lambda\)</span>.</p>
<p>Thus, if we shorten the string by <span class="math inline">\(\delta \lambda\)</span>, we would inject an energy of <span class="math inline">\(\delta E = \bar F (-\delta\lambda) -( mg\delta\lambda)\)</span> (we subtract away the gravitational energy at the lowest point, as it is irrelevant). This gives us</p>
<p><span class="math display">\[
\delta E + E \delta\lambda / 2\lambda = 0 \implies E\lambda^{1/2} = \Const
\]</span></p>
<p>Since the angular frequency of oscillation is <span class="math inline">\(\omega = \sqrt{\frac g\lambda}\)</span>, we have the result.</p>
</div>
</div>
</div>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 9</strong></span> Perform the same analysis on a vibrating string. The string is fixed at both ends, and the length of the string is slowly changed. The string is in a standing wave pattern, and the length of the string is changed so slowly that the string completes many cycles before the length changes appreciably. What is the adiabatic invariant in this case? The answer is in <span class="citation" data-cites="rayleighXXXIVPressureVibrations1902">(<a href="#ref-rayleighXXXIVPressureVibrations1902" role="doc-biblioref">Rayleigh 1902</a>)</span>.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Adiabatic invariance to all orders">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Adiabatic invariance to all orders
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The adiabatic invariance is actually much stronger than what we have shown. It is not just that the enclosed action <span class="math inline">\(I\)</span> is conserved up to <span class="math inline">\(O(\dot\lambda)\)</span>, but that it is conserved to all orders in <span class="math inline">\(O(\dot \lambda^n)\)</span> <span class="citation" data-cites="lenardAdiabaticInvarianceAll1959">(<a href="#ref-lenardAdiabaticInvarianceAll1959" role="doc-biblioref">Lenard 1959</a>)</span>. Under stronger restrictions, it is even conserved to order <span class="math inline">\(O(e^{c/\dot \lambda})\)</span>. See <span class="citation" data-cites="henrardAdiabaticInvariantClassical1993">(<a href="#ref-henrardAdiabaticInvariantClassical1993" role="doc-biblioref">Henrard 1993, sec. 4</a>)</span> for more theorems in this style.</p>
</div>
</div>
</div>
<p>Generalizing from this experience, for an arbitrary 1D oscillator with Hamiltonian <span class="math inline">\(H(q, p; \lambda)\)</span>, the phase space trajectory is a closed wobbly cycle. As we vary <span class="math inline">\(\lambda\)</span> adiabatically by external force, the cycle changes shape, both because the system has received energy from the external force, and because the Hamiltonian of the system has changed. Nevertheless, the area enclosed within should remain constant.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In general, force is the energetic cost of changing a parameter. That is, <span class="math inline">\(F = (\partial_{\lambda} H)_{p, q}\)</span>. Here, we are using a notation commonly used in thermodynamics: for partial derivatives, we write in the subscript the variables being held constant.</p>
<p>Let us adiabatically vary <span class="math inline">\(\lambda\)</span>. After many cycles have passed, the oscillator is orbiting around the cycle defined by <span class="math inline">\(H(q, p; \lambda) = E\)</span>. After many more cycles have passed, we have varied <span class="math inline">\(\lambda\)</span> by <span class="math inline">\(\delta \lambda\)</span>, and the oscillator would be orbiting around the cycle defined by <span class="math inline">\(H(q, p; \lambda + \delta \lambda) = E + \delta E\)</span>, where <span class="math inline">\(\delta E = \bar F \delta \lambda\)</span> is the increase in oscillator energy due to the external force varying <span class="math inline">\(\lambda\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figure/adiabatic_theorem_proof.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>As pictured, for each point <span class="math inline">\((q_0, p_0)\)</span> on the first cycle, we move by <span class="math inline">\(\delta p\)</span>, to end up with point <span class="math inline">\((q_0, p_0 + \delta p)\)</span> on the second cycle. The cycle area would change by</p>
<p><span class="math display">\[\delta(\text{area}) = \oint (\delta p)dq = \int_0^T (\delta p )\dot q dt + O(\delta T \delta p)\]</span></p>
<p>where <span class="math inline">\(T\)</span> is the cycle time of the first cycle, and <span class="math inline">\(T + \delta t\)</span> is the cycle time of the second cycle.</p>
<p>Expanding and simplifying,</p>
<p><span class="math display">\[
H(q_0, p_0 + \delta p ; \lambda + \delta \lambda) = E + \underbrace{\delta E}_{\text{$= \bar F \delta \lambda$}} \implies
(\partial_p H)_{\lambda, q}\delta p = [\overline{(\partial_\lambda H)_{q, p}} - (\partial_\lambda H)_{q, p}] \delta\lambda
\]</span></p>
<p>Now, integrate over a single cycle, and using the Hamilton equation of motion <span class="math inline">\(\dot{q} = (\partial_p H)_{\lambda, q}\)</span>,</p>
<p><span class="math display">\[\delta(\text{area}) =  \delta\lambda \int_0^T [\overline{(\partial_\lambda H)_{q, p}} - (\partial_\lambda H)_{q, p}] dt + O(\delta^2)\]</span></p>
<p>By definition, <span class="math inline">\(\overline{(\partial_\lambda H)_{q, p}} = \frac 1T \int_0^T (\partial_\lambda H)_{q, p}dt\)</span>, thus we have <span class="math inline">\(\delta(\text{area}) = O(\delta^2)\)</span>. Thus, integrating over the entirety of the adiabatic process, <span class="math inline">\(\Delta(\text{area}) = O(\delta)\)</span>, which converges to zero as the adiabatic process becomes infinitely slow.</p>
</div>
</div>
</div>
<div id="multidimensional-adiabatic-theorem" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a multidimensional oscillating system, we have three possibilities.</p>
<p>If the dimensions separate, like an <span class="math inline">\(n\)</span>-dimensional oscillator <span class="math inline">\(H = \frac{p_1^2 + \dots + p_n^2}{2m} + \frac 12 k (q_1^2 + \dots + q_n^2)\)</span>. In this case, the adiabatic theorem still applies along each dimension, with one adiabatic invariant per dimension.</p>
<p>If all dimensions mix together, like a tank of hot, entangled gas. In this case, the adiabatic theorem states that if we start with the microcanonical ensemble, then the phase space volume enclosed by the surface of <span class="math inline">\(H = E\)</span> remains constant as we adiabatically vary <span class="math inline">\(\lambda\)</span>. The volume is named the Gibbs invariant. <span class="citation" data-cites="deoliveiraParametricInvariance2022">(<a href="#ref-deoliveiraParametricInvariance2022" role="doc-biblioref">de Oliveira 2022</a>)</span></p>
<p>If the dimensions neither separate nor mix together, but have some kind of complicated dynamics, then what adiabaticity means in that case is still a current area of research.</p>
</div>
</div>
</section>
<section id="connection-to-thermodynamics" class="level4">
<h4 class="anchored" data-anchor-id="connection-to-thermodynamics">Connection to thermodynamics</h4>
<p>Consider a ball in a piston, bouncing elastically off its two ends. We hold one end of the piston constant, and slowly move the other. Assume the ball only moves in the <span class="math inline">\(x\)</span>-direction for simplicity. Let the ball have speed <span class="math inline">\(v\)</span>, and the walls of the piston have separation <span class="math inline">\(L\)</span>.</p>
<p>The phase space diagram of the system is a rectangle with <span class="math inline">\(\Delta q = L, \Delta p = (mv) - (-mv) = 2mv\)</span>, enclosing an area of <span class="math inline">\(I = 2mvL\)</span>. If we slowly move the wall of the piston, then the action is conserved, giving us</p>
<p><span class="math display">\[
2mv_0 L_0 = 2mvL \implies v = \frac{L_0}{L} v_0
\]</span></p>
<p>We can formulate this into the language of thermodynamics. First, expand our system to three dimensions – from a piston to a box. Since the motion of the ball in the <span class="math inline">\(x, y, z\)</span> directions are independent, we can treat them separately. We also assume equipartition of energies, that is, the energy of the ball is equally distributed among the three dimensions, so <span class="math inline">\(v_{x, 0} = v_{y, 0} = v_{z, 0}\)</span>. The conservation of action then states that</p>
<p><span class="math display">\[
v_i = \frac{L_{i, 0}}{L_i} v_{i, 0} \quad \text{for } i = x, y, z
\]</span></p>
<p>Imagine the ball is a gas molecule, and the piston is a wall of a container. Let <span class="math inline">\(E = \sum_{i = x, y, z} \frac 12 mv_i^2\)</span> be the energy of the gas molecule, and <span class="math inline">\(V = \prod_{i = x, y, z}L_i\)</span> be the volume of the gas. We then have</p>
<p><span class="math display">\[
V = V_0 \prod_i \frac{L_i}{L_{i, 0}} \approx V_0 \left(1 + \sum_i \frac{\delta L_{i}}{L_{i, 0}}\right), \quad
\begin{aligned}
E &amp;= \frac 12 m \sum_i \left(\frac{L_{i,0}}{L_i}\right)^2 v_{i, 0}^2\\
&amp;= \frac 32 m v_0^2 \frac 13 \sum_i \left(\frac{L_{i,0}}{L_i}\right)^2 \\
&amp;\approx E_0 \left(1 - \frac 23 \sum_i \frac{\delta L_{i}}{L_{i, 0}}\right)
\end{aligned}
\]</span></p>
<p>These imply that <span class="math inline">\(E^{3/2}V \approx E_0^{3/2}V_0\)</span>. Now, this is precisely what happens if you compress an ideal gas adiabatically. This is one connection between the concept of “adiabatic” in classical mechanics and thermodynamics.</p>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 10</strong></span> Prove that <span class="math inline">\(I\)</span> is conserved: calculate the average force <span class="math inline">\(\bar F\)</span> on the piston, then calculate the work done by the piston.</p>
</div>
</section>
<section id="more-examples" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="more-examples">More examples</h4>
<p>Given a Lorentz pendulum and a schedule for varying its arm length, we can plot the angle <span class="math inline">\(x\)</span> as a function of time, and see directly that <span class="math inline">\(I = T (\frac 12 m \dot x_{max}^2)\)</span> is conserved over many swings of the pendulum.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/sanchez-soto_fig_1_annotated.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">A Lorentz pendulum with length increasing linearly with time. As its length increases, <span class="math inline">\(\dot x_{max}\)</span> decreases while <span class="math inline">\(T\)</span> increases, keeping <span class="math inline">\(I\)</span> conserved. Annotated from <span class="citation" data-cites="sanchez-sotoVariationsAdiabaticInvariance2013">(<a href="#ref-sanchez-sotoVariationsAdiabaticInvariance2013" role="doc-biblioref">Sánchez-Soto and Zoido 2013, fig. 1</a>)</span></figcaption>
</figure>
</div>
<p>For a more rigorous proof of adiabatic invariance at the level of first-year graduate student, see <span class="citation" data-cites="wellsAdiabaticInvarianceAction2007">(<a href="#ref-wellsAdiabaticInvarianceAction2007" role="doc-biblioref">Wells and Siklos 2007</a>)</span>. <span class="citation" data-cites="henrardAdiabaticInvariantClassical1993">(<a href="#ref-henrardAdiabaticInvariantClassical1993" role="doc-biblioref">Henrard 1993</a>)</span> is a good comprehensive review of adiabatic invariance in classical mechanics, and points to the literature on a lot of applications in celestial mechanics, magnetism, and the geometry of phase space plots. In textbooks on classical statistical mechanics, the adiabatic invariance theorem is used to derive many results. <span class="citation" data-cites="fernandez-pinedaAdiabaticInvariancePhase1982">(<a href="#ref-fernandez-pinedaAdiabaticInvariancePhase1982" role="doc-biblioref">Fernandez-Pineda, Diez de los Rios, and Mengual 1982</a>)</span> gives some worked-out examples, such as the ideal gas and the photon gas.</p>
</section>
</section>
</section>
<section id="old-quantum-mechanics" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="old-quantum-mechanics">Old quantum mechanics</h2>
<blockquote class="blockquote">
<p>Sommerfeld, in the new edition of his book [<em>Atomic structure and spectral lines</em>], has introduced the adiabatic hypothesis through a couple of very elegant changes and footnotes, in such a way that my participation in that can rather appear reduced to — a plagiarism. Lorentz and Einstein have founded the subject, I have given it a name and Burgers has put everything in order. I was first <strong>very, very</strong> depressed. I know that I have never discovered anything, and <strong>quite surely never will discover anything</strong>, that I can love so fervently as this line of thought which I found out with so large joy.</p>
<p>Ehrenfest’s letter to Bohr, 8 May 1922. Emphasis in original. Quoted in <span class="citation" data-cites="navarroPaulEhrenfestGenesis2006">(<a href="#ref-navarroPaulEhrenfestGenesis2006" role="doc-biblioref">Navarro and Pérez 2006</a>)</span></p>
</blockquote>
<section id="the-adiabatic-hypothesis" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-adiabatic-hypothesis">The adiabatic hypothesis</h3>
<p>There are two ways to interpret the word “adiabatic”. In thermodynamics, “adiabatic” means “no exchange of heat”. In mechanics, “adiabatic” means “gradual”.<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a> It is a winding story of how one word “adiabatic” came to mean two things that fortuitously are connected after all, the details of which are given in <span class="citation" data-cites="jammerConceptualDevelopmentQuantum1966 laidlerMeaningAdiabatic1994">(<a href="#ref-jammerConceptualDevelopmentQuantum1966" role="doc-biblioref">Jammer 1966, chap. 3</a>; <a href="#ref-laidlerMeaningAdiabatic1994" role="doc-biblioref">Laidler 1994</a>)</span>. The story is almost as interesting as that of the word “entropy”, which also has two meanings that are fortuitously connected after all.</p>
<div class="no-row-height column-margin column-container"><div id="fn19"><p><sup>19</sup>&nbsp;Because “adiabatic” has two meanings in English, in Chinese, it also has two different translations based on the two meanings. There is 绝热, which means “no exchange of heat”, and 浸渐, which means “gradually, like moisture soaking into something”.</p></div></div><p>Rankine first coined the term “adiabatic” in 1858, to denote a process in which no heat is exchanged with the surroundings. Later, Boltzmann and Clausius tried to explain the second law of thermodynamics mechanically, by using purely mechanical models of the microscopic world. In this sense, they defined an “adiabatic” mechanical process to be one where a certain variable is slowly changed (for example, if we have a box of little bouncing balls, and we slowly move its walls), because an adiabatic thermodynamic process in their view is actually an adiabatic mechanical process.</p>
<p>“Adiabatic motion” in mechanics was introduced by Helmholtz and Hertz, to denote mechanical processes where external forces act upon a system, but only on a few parameters, with no action on the underlying details. For example, think back to the case of bouncing balls in a box. The external force only moves the walls of the box <em>on average</em>, with no attempt to move the walls to manipulate the precise location of the ball. They used the thermodynamic terminology, because the work done on the system during an adiabatic motion results exclusively in changes in its energy. <span class="citation" data-cites="jammerConceptualDevelopmentQuantum1966">(<a href="#ref-jammerConceptualDevelopmentQuantum1966" role="doc-biblioref">Jammer 1966, chap. 3</a>)</span></p>
<p>In 1900, Pyotr Lebedev experimentally proved that radiation pressure exists, and follows Maxwell’s theory of electromagnetism. Inspired by this, Lord Rayleigh <span class="citation" data-cites="rayleighXXXIVPressureVibrations1902">(<a href="#ref-rayleighXXXIVPressureVibrations1902" role="doc-biblioref">Rayleigh 1902</a>)</span> generalized the concept of radiation pressure to all kinds of vibrations, starting with the humble pendulum. Since his goal was to understand what happens when you adiabatically compress a photon gas, that is, <a href="https://en.wikipedia.org/wiki/Wien's_displacement_law#Discovery">Wien’s displacement law</a>,<a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a> he studied the effect of adiabatic motion on some simple mechanical systems undergoing wave motion, such as the Lorentz pendulum, a vibrating cord, a piston of gas with a standing acoustic ave, etc.</p>
<div class="no-row-height column-margin column-container"><div id="fn20"><p><sup>20</sup>&nbsp;Since he didn’t actually know what a photon was, it might be better to say that he was studying what would happen when you compress a hot chamber of light. Though Wien’s displacement law is nowadays proved straight from quantum mechanics, back when ien discovered it in 1893, he used a thermodynamic argument using the adiabatic compression of a photon gas. For a brief presentation of how Rayleigh did it, see <span class="citation" data-cites="terhaarAdiabaticInvarianceAdiabatic1966">(<a href="#ref-terhaarAdiabaticInvarianceAdiabatic1966" role="doc-biblioref">Ter Haar 1966</a>)</span>.</p></div></div><p>Like Lord Kelvin, Paul Ehrenfest was also trying to explain Wien’s displacement law. He was puzzled by the fact that while Wien’s displacement law was derived without the quantum hypothesis, yet somehow, it remains true. Suppose we start with a box of light, then it follows a certain black body radiation, which can only be derived by the quantum hypothesis. Now suppose we adiabatically compress the box of light. Though the compression process is studied classically, without the quantum hypothesis, the final state of the light is still the black body radiation. So, it seems that if we start with a system following the quantum hypothesis, then any adiabatic <em>classical</em> process would give us a system that still follows the quantum hypothesis. This is his <strong>adiabatic hypothesis</strong>, for which he is famous.</p>
<p>During the 1910s, Ehrenfest published a series of papers to subsume the many ad-hoc quantum rules under the framework of the adiabatic hypothesis. His idea is as follows: If, in a periodic system described by classical mechanics (such as an electron orbiting a proton), a certain quantity <span class="math inline">\(I\)</span> has units of joule-second, and is conserved as it undergoes adiabatic motion, then this quantity <em>should</em> be quantized, and only this quantity <em>can</em> be quantized. Only <span class="math inline">\(I\)</span> <em>can</em> be quantized, for the reason discussed by Lorentz and Einstein at the Solvay conference.</p>
<p>Further, <span class="math inline">\(I\)</span> <em>should</em> be quantized, because otherwise, why else should <span class="math inline">\(I\)</span> be adiabatically conserved? The adiabaticity of <span class="math inline">\(I\)</span> in the classical world, on the surface, is a shadow of the discreteness of <span class="math inline">\(I\)</span> in the quantum world, deep down. Because <span class="math inline">\(I\)</span> is quantized, if we vary the system slowly enough, the system would have no reason to make a big jump from <span class="math inline">\(I = nh\)</span> to <span class="math inline">\(I = (n+1)h\)</span>. This discreteness in the quantum world traps <span class="math inline">\(I\)</span> in its starting position, and this is why <span class="math inline">\(I\)</span> appears adiabatic in the classical world.</p>
<p>Thus, quantized quantities are precisely adiabatic invariants. We can write down <span class="math inline">\(I = nh\)</span>, where <span class="math inline">\(n \in \mathbb{N}\)</span>, and proceed to calculate the properties of the system, such as its energy levels, its absorption and emission spectra, etc.</p>
<p>In short, this is Ehrenfest’s recipe for doing “old quantum mechanics”:</p>
<ul>
<li>Find a system that has a conserved quantity <span class="math inline">\(I\)</span> under adiabatic motion.
<ul>
<li>You can do this by solving the equations of motion, then integrate <span class="math inline">\(\oint pdq\)</span>.</li>
<li>Alternatively, you can start with a harmonic oscillator, and adiabatically deform the system until it becomes the system you want. Ehrenfest called such systems “adiabatically related to the harmonic oscillator” <span class="citation" data-cites="jammerConceptualDevelopmentQuantum1966">(<a href="#ref-jammerConceptualDevelopmentQuantum1966" role="doc-biblioref">Jammer 1966, 99</a>)</span>.</li>
</ul></li>
<li>Proclaim that <span class="math inline">\(I = nh\)</span> for some constant <span class="math inline">\(h\)</span>.</li>
<li>Calculate the properties of the system.</li>
</ul>
</section>
<section id="the-bohrsommerfeld-model" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-bohrsommerfeld-model">The Bohr–Sommerfeld model</h3>
<p>As an example, consider the pinnacle of old quantum theory, the <a href="https://en.wikipedia.org/wiki/Bohr%E2%80%93Sommerfeld_model">Bohr–Sommerfeld model</a> of the hydrogen atom. First, treat the hydrogen atom as if it is a relativistic solar system, with the electron as a planet, moving at relativistic speeds<a href="#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a> under the inverse-square force <span class="math inline">\(F \propto \frac{1}{r^2}\)</span>. Next, assume that the adiabatic invariant is quantized:</p>
<div class="no-row-height column-margin column-container"><div id="fn21"><p><sup>21</sup>&nbsp;Because the electron moves faster closer to the atom than further away, it has more mass close to the atom than further away. This allows the orbit to precess in a way that is not predicted by Newtonian mechanics. Generally, any perturbation of the inverse-square force will cause the orbit to precess. Even special relativity would predict some precession for the perihelion of Mercury, though it predicts a value of <span class="math inline">\(7''/\text{year}\)</span> only <span class="math inline">\(1/6\)</span> of the correct value <span class="citation" data-cites="mcdonaldSpecialRelativityPrecession2023 goldsteinClassicalMechanics2008">(<a href="#ref-mcdonaldSpecialRelativityPrecession2023" role="doc-biblioref">McDonald 2023</a>; <a href="#ref-goldsteinClassicalMechanics2008" role="doc-biblioref">Goldstein, Poole, and Safko 2008</a>, exercise 7.27, page 332)</span>. Only general relativity predicts the correct value. Assuming that only special relativity contributes, the perihelion of Mercury would take <span class="math inline">\(7.5 \times 10^7\)</span> Mercury-years to go around the sun once.</p>
<p>As the electron moves a lot faster than Mercury, it takes much shorter time, but still it takes <span class="math inline">\(4\times 10^4\)</span> electron-years to go around the nucleus once, as noted in Bohr’s Nobel lecture <span class="citation" data-cites="bohrStructureAtom1923">(<a href="#ref-bohrStructureAtom1923" role="doc-biblioref">Bohr 1923</a>)</span>.</p></div></div><p><span class="math display">\[\int_0^T p_r \,dq_r = n' h\]</span></p>
<p>where <span class="math inline">\(q_r\)</span> is the radial position of the electron, <span class="math inline">\(p_r\)</span> is the momentum conjugate to it, <span class="math inline">\(n'\)</span> is the “auxiliary quantum number”, and <span class="math inline">\(T\)</span> is the period of the electron’s orbit. This, when combined with the hypothesis of quantized angular momentum <span class="math inline">\(mvr = nh\)</span> (here, <span class="math inline">\(n\)</span> is the “principal quantum number”), would predict the emission spectrum of the hydrogen atom.<a href="#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn22"><p><sup>22</sup>&nbsp;Because the equation of motion for the electron separates into a radial component <span class="math inline">\(q_r, p_r\)</span> and an angular component <span class="math inline">\(q_\theta, p_\theta\)</span>, we can apply the <a href="#multidimensional-adiabatic-theorem">multidimensional adiabatic theorem</a> and find that both <span class="math inline">\(\int_0^T p_r \,dq_r\)</span> and <span class="math inline">\(\int_0^T p_\theta \,dq_\theta\)</span> are adiabatic invariants.</p></div></div><p>Sommerfeld went further, piling epicycles upon epicycles, to explain the fine structure of atomic spectra. All those has been swept away by the new quantum theory like how the new astronomy of Kepler swept away the epicycles of Ptolemy. But the adiabatic hypothesis remains to this day a fruitful meeting point between the classical, the quantum, and the thermodynamic world.</p>
<p>Have some cool pictures, because I like cool pictures.</p>
<div id="fig-atombau" class="quarto-layout-panel page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-atombau-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>Selections from <span class="citation" data-cites="sommerfeldAtomicStructureSpectral1923">(<a href="#ref-sommerfeldAtomicStructureSpectral1923" role="doc-biblioref">Sommerfeld 1923</a>)</span>.</p>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/atombau_en_p_197.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">Quantization of the adiabatic invariant. Page 197.</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/atombau_en_p_199.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">This looks familiar… it looks just like the phase space plot of a ball bouncing in a piston. Page 199.</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/atombau_en_p_240.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">Orbits of the hydrogen atom with the same principal quantum number <span class="math inline">\(n\)</span>, but different auxiliary quantum number <span class="math inline">\(n'\)</span>. Page 240.</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/atombau_en_p_502.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="margin-caption">5 electrons with the same principal and auxiliary quantum numbers, interacting by the pentagonal dance. Page 502.</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig quarto-uncaptioned margin-caption" id="fig-atombau-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<div id="fig-kramers" class="quarto-layout-panel page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-kramers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>Selections from <span class="citation" data-cites="kramersAtomBohrTheory1923">(<a href="#ref-kramersAtomBohrTheory1923" role="doc-biblioref">Kramers 1923</a>)</span>.</p>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/fig_27_Kramer_Holst_1923.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="margin-caption">Orbits of the Bohr–Sommerfeld model of the hydrogen atom, labelled by their principal quantum numbers and auxiliary quantum numbers. The jumps from 3<sub>1</sub>, 3<sub>2</sub>, 3<sub>3</sub> to 2<sub>2</sub> all create the Balmer spectral line H<sub>α</sub>, but they differ at the fine structure. Figure 27.</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/structure_of_the_radium_figure_Kramer_Holst_1923.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Orbits of the Bohr–Sommerfeld model of the Radium atom. First end plate. I find its fonts classy.</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/atomteori_vectorized_bohr_atoms.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">A modern redrawing. <span class="citation" data-cites="holtebekkAtomAtomteori2023">(<a href="#ref-holtebekkAtomAtomteori2023" role="doc-biblioref">Holtebekk and Linder 2023</a>)</span></figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig quarto-uncaptioned margin-caption" id="fig-kramers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>What we are nowadays hearing of the language of spectra is a true “ music of the spheres ” within the atom, chords of integral relationships, an order and harmony that becomes ever more perfect in spite of the manifold variety. The theory of spectral lines will bear the name of Bohr for all time. But yet another name will be permanently associated with it, that of Planck. All integral laws of spectral lines and of atomic theory spring originally from the quantum theory. It is the mysterious organon on which Nature plays her music of the spectra, and according to the rhythm of which she regulates the structure of the atoms and nuclei.</p>
<p>Preface to the first edition of <em>Atomic structure and spectral lines</em>, Arnold Sommerfeld, 1919. <span class="citation" data-cites="sommerfeldAtomicStructureSpectral1923">(<a href="#ref-sommerfeldAtomicStructureSpectral1923" role="doc-biblioref">Sommerfeld 1923</a>)</span></p>
</blockquote>
</section>
<section id="the-einsteinbrillouinkeller-quantization" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-einsteinbrillouinkeller-quantization">The Einstein—Brillouin–Keller quantization</h3>
<p>This topic is quite obscure and hard to find a simple reference for, yet I found it is absolutely necessary to treat this correctly, if only to soothe my mathematical conscience. I wrote it based on <span class="citation" data-cites="stoneEinsteinUnknownInsight2005 duncanConstructingQuantumMechanics2019">(<a href="#ref-stoneEinsteinUnknownInsight2005" role="doc-biblioref">Stone 2005</a>; <a href="#ref-duncanConstructingQuantumMechanics2019" role="doc-biblioref">Duncan and Janssen 2019, chap. 5</a>)</span>.</p>
<p>Let’s take a more careful look at the Bohr–Sommerfeld model of a hydrogen atom. The electron orbits a proton, and the equation of motion is spherically symmetric. Therefore, we can write it in spherical coordinates <span class="math inline">\((r, \theta, \psi)\)</span>, where <span class="math inline">\(r\)</span> is the radius, <span class="math inline">\(\theta\)</span> is the co-latitude, and <span class="math inline">\(\psi\)</span> is the longitude. The Bohr–Sommerfeld quantization then states that</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \oint p_r d r = n_r h \\
&amp; \oint p_{\theta} d \theta=n_\theta h, \\
&amp; \oint p_\psi d \psi=n_\psi h .
\end{aligned}
\]</span></p>
<p>for some positive integers <span class="math inline">\(n_r, n_\theta, n_\psi\)</span>. However, we notice something deeply unsatisfying: How does the atom “know” which way is the sphere pointing? To define the spherical coordinates, we need to define the direction of the north and south pole. The Bohr–Sommerfeld quantization condition is thus creating an artificial direction in space where none should exist. Worse, if we solve the equations, we would find that this artificial direction has physically measurable consequences.</p>
<p>Sommerfeld evaded the difficulty by arguing that as long as there is even a hair of magnetic field <span class="math inline">\(B\)</span> pointing in some direction <span class="math inline">\(\hat z\)</span>, we can pick <span class="math inline">\(\hat z\)</span> as the north pole direction, and that since the field strength is nowhere zero, the problem will never occur in practice.</p>
<p>We see the difficulty inherent in the old quantum theory. Suppose we have a hydrogen atom suspended in free space, then the tiniest change in the external magnetic field would create a large (for the atom, at least) change in its north-pole direction. The <a href="https://en.wikipedia.org/wiki/Stern%E2%80%93Gerlach_experiment">Stern–Gerlach experiment</a>, performed in 1922, experimentally showed that the external field can determine the direction of <span class="math inline">\(\hat z\)</span>, and thus the quantization of angular momentum. To see something in classical mechanics so jumpy is disconcerting, and certainly disturbed me greatly when I first understood the Stern–Gerlach experiment. In 4 years, Schrödinger would have proposed his equation, Heisenberg his matrix mechanics, and old quantum theory washed away by the new quantum mechanics.</p>
<p>Einstein, in his only paper on the old quantum mechanics,<a href="#fn23" class="footnote-ref" id="fnref23" role="doc-noteref"><sup>23</sup></a> elegantly resolved the problem by using the <a href="@thm-poincare-cartan">Poincaré–Cartan integral invariant</a> to construct quantization equations that do not depend on our arbitrary choices of coordinate systems.</p>
<div class="no-row-height column-margin column-container"><div id="fn23"><p><sup>23</sup>&nbsp;<span class="citation" data-cites="einsteinQuantensatzSommerfeldUnd1917">(<a href="#ref-einsteinQuantensatzSommerfeldUnd1917" role="doc-biblioref">Einstein 1917</a>)</span>, reprinted and translated in <span class="citation" data-cites="einsteinCollectedPapersAlbert1997">(<a href="#ref-einsteinCollectedPapersAlbert1997" role="doc-biblioref">Einstein 1997, vol. 6</a>, pages 434–444)</span>.</p></div><div id="fn24"><p><sup>24</sup>&nbsp;In the jargon of topology, this is a linear function on <span class="math inline">\(T^d\)</span>, <a href="https://en.wikipedia.org/wiki/Homology_(mathematics)">the homology group of the torus</a>. Here, <span class="math inline">\(d\)</span> is the dimension of the torus.</p></div></div><p>As we saw with <a href="#exr-zero-poincare-cartan" class="quarto-xref">Exercise&nbsp;2</a>, a contractable loop on the torus integrates to zero. Thus, we can attach and detach contractible loops at will, deform the cycle arbitrarily, and still get the same number. That is, the integral is determined by the topology of the cycle, not the exact shape of the cycle.<a href="#fn24" class="footnote-ref" id="fnref24" role="doc-noteref"><sup>24</sup></a> This gives us the Einstein quantization:</p>
<p><span class="math display">\[
\oint_{\gamma_i} \left\langle p, dq\right\rangle = n_i h
\]</span></p>
<p>where <span class="math inline">\(\gamma_1, \dots, \gamma_d\)</span> range over the <span class="math inline">\(d\)</span> topologically distinct loops around the <span class="math inline">\(n\)</span>-dimensional torus in phase space, and <span class="math inline">\(n_1, \dots, n_d\)</span> are positive integers. This was later modified by Brillouin and Keller to take account of singularities in the trajectory, such as a hard wall reflector, giving us the <a href="https://en.wikipedia.org/wiki/Einstein%E2%80%93Brillouin%E2%80%93Keller_method">EBK quantization</a>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/EBK_quantization.jpg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">A particle moving in a central potential. Its angular momentum <span class="math inline">\(p_\theta\)</span> is conserved, so we do not plot it. Plotting its other three phase-space variables <span class="math inline">\((r, \theta, p_r)\)</span>, we see that its orbit makes a spiralling and rotating pattern on a torus. There are two fundamental ways to cycle around the torus, and each has a corresponding Poincaré–Cartan integral that is independent of the precise shape of the cycle. Both integrals are quantized. This is the meaning of the EBK quantization.</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The EBK quantization resembles the Bohr–Sommerfeld quantization condition, but it is quite different. In the Bohr–Sommerfeld quantization condition, the integral <span class="math inline">\(\oint p_i dq_i\)</span> integrates over a cycle of <em>physically real</em> trajectory in phase space. In EBK quantization, the integral <span class="math inline">\(\oint_{\gamma_i} \left\langle p, dq\right\rangle\)</span> integrates over a <em>geometric</em> cycle in phase space with <em>no physical reality at all</em>.</p>
<p>Both conditions happen to be the same when we have a 1D oscillator, but that is because the only way to <em>physically</em> go around the torus is the only way to <em>geometrically</em> go around the torus. It is a misleading coincidence.</p>
<p>In general, the physically real trajectories look like a braiding on the torus, and are not even closed cycles. They definitely do <em>not</em> go around the torus exactly once in exactly one direction.</p>
</div>
</div>
<p>There is only one problem left: What happens when we don’t have a torus? It is all well and good when we can construct a torus in phase space with as many dimensions as possible. However, when we have a classically chaotic system, such as the three-body problem, we cannot have something this simple.</p>
<p>Consider the simplest case of the three-body problem: We put two suns in a circular orbit around each other, and a speck of dust orbiting them. The two suns’ orbit is perfectly predictable, so we consider only the trajectory of the dust. We also assume the dust only moves in the plane of the suns. Thus, the system has only 2 dimensions of configuration, or 4 dimensions of phase.</p>
<p>As the energy of the system is conserved, the motion of the dust is restricted to the constant energy surface <span class="math inline">\(H(q_1, q_2, p_1 p_2) = E\)</span>, which is a 3-dimensional blob within the 4-dimensional phase space. However, in general, this is all we can say about it. The motion of the dust is chaotic, and would densely crisscross over a 3-dimensional subset of the blob.</p>
<p>Without a torus in phase space, we cannot find trajectories around the torus, and so the integral <span class="math inline">\(\oint_{\gamma}\left\langle p, dq\right\rangle\)</span> is undefined. Einstein presciently pointed this out in his 1916 paper:</p>
<blockquote class="blockquote">
<p>If there exist fewer than <span class="math inline">\(d\)</span> [constants of motion], as is the case, for example, according to Poincaré in the three-body problem, then the <span class="math inline">\(p_i\)</span> are not expressible by the <span class="math inline">\(q_i\)</span> and the quantum condition of Sommerfeld-Epstein fails also in the slightly generalized form that has been given here.</p>
</blockquote>
<p>This failure of the EBK quantization on classically chaotic systems was forgotten for many years, but eventually rediscovered.<a href="#fn25" class="footnote-ref" id="fnref25" role="doc-noteref"><sup>25</sup></a> When it did, it became a seed of <a href="https://en.wikipedia.org/wiki/Quantum_chaos">quantum chaos</a>, which I hope to explain clearly some day. In the mean time, I leave you with some beautiful pictures of quantum chaos instead.</p>
<div class="no-row-height column-margin column-container"><div id="fn25"><p><sup>25</sup>&nbsp;See <span class="citation" data-cites="stoneEinsteinUnknownInsight2005">(<a href="#ref-stoneEinsteinUnknownInsight2005" role="doc-biblioref">Stone 2005</a>)</span> for a brief history and more cool pictures. It was written in 2005, the “Einstein Year”, the 100th anniversary of Einstein’s <em>annus mirabilis</em>.</p></div></div><div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/chaotic_integrable_quantum_billiard.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The nonchaotic quantum circular billiard and the chaotic quantum cardioid billiard. Figure from <span class="citation" data-cites="backerQuantumChaosBilliards2007">(<a href="#ref-backerQuantumChaosBilliards2007" role="doc-biblioref">Backer 2007</a>)</span></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/king_2009_quantum_scars.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">In a chaotic quantum “stadium” billiard, the standing wave functions look dark along certain lines. You can think of them as taking a classical billiard table, and using a knife to cut along the classical trajectories. The scars left behind are the <a href="https://en.wikipedia.org/wiki/Quantum_scar">quantum scars</a> of departed classicality. Figure from <span class="citation" data-cites="kingExploringQuantumClassical2014">(<a href="#ref-kingExploringQuantumClassical2014" role="doc-biblioref">King 2014</a>)</span></figcaption>
</figure>
</div>


<!-- -->


</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-arnoldMathematicalMethodsClassical2001" class="csl-entry" role="listitem">
Arnol’d, V. I. 2001. <em>Mathematical Methods of Classical Mechanics</em>. 2. ed., [7. korr. Nachdr.]. Graduate Texts in Mathematics 60. New York: Springer.
</div>
<div id="ref-backerQuantumChaosBilliards2007" class="csl-entry" role="listitem">
Backer, Arnd. 2007. <span>“Quantum <span>Chaos</span> in <span>Billiards</span>.”</span> <em>Computing in Science &amp; Engineering</em> 9 (3): 60–64. <a href="https://doi.org/10.1109/MCSE.2007.61">https://doi.org/10.1109/MCSE.2007.61</a>.
</div>
<div id="ref-bellmanEyeHurricaneRichard1984" class="csl-entry" role="listitem">
Bellman, Richard. 1984. <em>Eye of the Hurricane: <span>Richard Bellman</span> ; <span>An</span> Autobiography</em>. Singapore: World Scientific.
</div>
<div id="ref-berryChapterConicalDiffraction2007" class="csl-entry" role="listitem">
Berry, M. V., and M. R. Jeffrey. 2007. <span>“Chapter 2 <span>Conical</span> Diffraction: <span>Hamilton</span>’s Diabolical Point at the Heart of Crystal Optics.”</span> In <em>Progress in <span>Optics</span></em>, edited by E. Wolf, 50:13–50. Elsevier. <a href="https://doi.org/10.1016/S0079-6638(07)50002-8">https://doi.org/10.1016/S0079-6638(07)50002-8</a>.
</div>
<div id="ref-bohrStructureAtom1923" class="csl-entry" role="listitem">
Bohr, N. 1923. <span>“The <span>Structure</span> of the <span>Atom</span>.”</span> <em>Nature</em> 112 (2801): 29–44. <a href="https://doi.org/10.1038/112029a0">https://doi.org/10.1038/112029a0</a>.
</div>
<div id="ref-campanteAdvancedMacroeconomicsEasy2021" class="csl-entry" role="listitem">
Campante, Filipe, Federico Sturzenegger, and Andrés Velasco. 2021. <em>Advanced <span>Macroeconomics</span>: <span>An Easy Guide</span></em>. London: Ubiquity Press.
</div>
<div id="ref-debroglieWaveNatureElectron1929" class="csl-entry" role="listitem">
De Broglie, Louis. 1929. <span>“The Wave Nature of the Electron.”</span> <em>Nobel Lecture</em> 12: 244–56. <a href="https://www.researchgate.net/profile/David-Cole-3/project/Hilberts-Sixth-Problem-https-enwikipediaorg-wiki-Hilberts-sixth-problem/attachment/5bd37200cfe4a76455fd9955/AS:686072908505088@1540583936335/download/broglie-lecture.pdf?context=ProjectUpdatesLog">https://www.researchgate.net/profile/David-Cole-3/project/Hilberts-Sixth-Problem-https-enwikipediaorg-wiki-Hilberts-sixth-problem/attachment/5bd37200cfe4a76455fd9955/AS:686072908505088@1540583936335/download/broglie-lecture.pdf?context=ProjectUpdatesLog</a>.
</div>
<div id="ref-deoliveiraParametricInvariance2022" class="csl-entry" role="listitem">
de Oliveira, Mário J. 2022. <span>“Parametric <span>Invariance</span>.”</span> <em>Brazilian Journal of Physics</em> 52 (3): 67. <a href="https://doi.org/10.1007/s13538-022-01067-x">https://doi.org/10.1007/s13538-022-01067-x</a>.
</div>
<div id="ref-derbesFeynmanDerivationSchrodinger1996" class="csl-entry" role="listitem">
Derbes, David. 1996. <span>“Feynman’s Derivation of the <span class="nocase">Schr<span class="nocase">ö</span>dinger</span> Equation.”</span> <em>American Journal of Physics</em> 64 (7): 881–84. <a href="http://www.physics.utah.edu/~starykh/phys7640/Lectures/FeynmansDerivation.pdf">http://www.physics.utah.edu/~starykh/phys7640/Lectures/FeynmansDerivation.pdf</a>.
</div>
<div id="ref-duncanConstructingQuantumMechanics2019" class="csl-entry" role="listitem">
Duncan, Anthony, and Michel Janssen. 2019. <em>Constructing Quantum Mechanics. <span>Volume</span> 1: <span>The</span> Scaffold 1900-1923</em>. First edition. Oxford, United Kingdom ; New York, NY: Oxford University Press.
</div>
<div id="ref-einsteinQuantensatzSommerfeldUnd1917" class="csl-entry" role="listitem">
Einstein, Albert. 1917. <span>“Zum Quantensatz von <span>Sommerfeld</span> Und <span>Epstein</span>.”</span> <em>Verh. D. D. Physik. Ges</em>, 82–92. <a href="https://cir.nii.ac.jp/crid/1573668923920337408">https://cir.nii.ac.jp/crid/1573668923920337408</a>.
</div>
<div id="ref-einsteinCollectedPapersAlbert1997" class="csl-entry" role="listitem">
———. 1997. <em>The Collected Papers of <span>Albert Einstein</span>: Writings, 1914-1917</em>. Edited by Alfred Engel and Engelbert Schucking. English translation of selected texts. Princeton: Princeton university press.
</div>
<div id="ref-fernandez-pinedaAdiabaticInvariancePhase1982" class="csl-entry" role="listitem">
Fernandez-Pineda, C., A. Diez de los Rios, and J. I. Mengual. 1982. <span>“Adiabatic Invariance of Phase Volume in Some Easy Cases.”</span> <em>American Journal of Physics</em> 50 (3): 262–67. <a href="https://doi.org/10.1119/1.12863">https://doi.org/10.1119/1.12863</a>.
</div>
<div id="ref-feynmanQEDStrangeTheory2006" class="csl-entry" role="listitem">
Feynman, Richard P. 2006. <em><span>QED</span>: The Strange Theory of Light and Matter</em>. Expanded ed. Princeton Science Library. Princeton, NJ: Princeton Univ. Press.
</div>
<div id="ref-fowler13AdiabaticInvariants2020" class="csl-entry" role="listitem">
Fowler, Michael. 2020. <span>“13.1: <span>Adiabatic Invariants</span>.”</span> <em>Physics LibreTexts</em>. <a href="https://phys.libretexts.org/Bookshelves/Classical_Mechanics/Graduate_Classical_Mechanics_(Fowler)/13%3A_Adiabatic_Invariants_and_Action-Angle_Variables/13.01%3A_Adiabatic_Invariants">https://phys.libretexts.org/Bookshelves/Classical_Mechanics/Graduate_Classical_Mechanics_(Fowler)/13%3A_Adiabatic_Invariants_and_Action-Angle_Variables/13.01%3A_Adiabatic_Invariants</a>.
</div>
<div id="ref-goldsteinClassicalMechanics2008" class="csl-entry" role="listitem">
Goldstein, Herbert, Charles P. Poole, and John L. Safko. 2008. <em>Classical Mechanics</em>. 3. ed., [Nachdr.]. San Francisco Munich: Addison Wesley.
</div>
<div id="ref-hamillStudentGuideLagrangians2013" class="csl-entry" role="listitem">
Hamill, Patrick. 2013. <em>A <span>Student</span>’s <span>Guide</span> to <span>Lagrangians</span> and <span>Hamiltonians</span></em>. 1st edition. New York: Cambridge University Press.
</div>
<div id="ref-hamiltonGeneralMethodExpressing1833" class="csl-entry" role="listitem">
Hamilton, Sir William Rowan. 1833. <em>On a <span>General Method</span> of <span>Expressing</span> the <span>Paths</span> of <span>Light</span>, &amp; of the <span>Planets</span>, by the <span>Coefficients</span> of a <span>Characteristic Function</span></em>. P.D. Hardy.
</div>
<div id="ref-henrardAdiabaticInvariantClassical1993" class="csl-entry" role="listitem">
Henrard, J. 1993. <span>“The <span>Adiabatic Invariant</span> in <span>Classical Mechanics</span>.”</span> In <em>Dynamics <span>Reported</span>: <span>Expositions</span> in <span>Dynamical Systems</span></em>, edited by C. K. R. T. Jones, U. Kirchgraber, and H. O. Walther, 117–235. Berlin, Heidelberg: Springer. <a href="https://doi.org/10.1007/978-3-642-61232-9_4">https://doi.org/10.1007/978-3-642-61232-9_4</a>.
</div>
<div id="ref-hiriart-urrutyFundamentalsConvexAnalysis2001" class="csl-entry" role="listitem">
Hiriart-Urruty, Jean-Baptiste, and Claude Lemaréchal. 2001. <em>Fundamentals of Convex Analysis</em>. Grundlehren Text Editions. Berlin ; New York: Springer.
</div>
<div id="ref-holtebekkAtomAtomteori2023" class="csl-entry" role="listitem">
Holtebekk, Trygve, and Jacob Linder. 2023. <span>“<span>atom – atomteori</span>.”</span> <em>Store norske leksikon</em>, August. <a href="https://snl.no/atom_-_atomteori">https://snl.no/atom_-_atomteori</a>.
</div>
<div id="ref-institutssolvayTheorieRayonnementQuanta1912" class="csl-entry" role="listitem">
Instituts Solvay, Brussels Institut international de physique Conseil de physique, Ernest Solvay, Paul Langevin, Maurice de Broglie, and Albert Einstein. 1912. <em><span>La th<span>é</span>orie du rayonnement et les quanta</span></em>. Paris : Gauthier-Villars. <a href="http://archive.org/details/lathoriedurayo00inst">http://archive.org/details/lathoriedurayo00inst</a>.
</div>
<div id="ref-jammerConceptualDevelopmentQuantum1966" class="csl-entry" role="listitem">
Jammer, Max. 1966. <em>The <span>Conceptual Development</span> of <span>Quantum Mechanics</span></em>. First Edition. McGraw-Hill.
</div>
<div id="ref-kingExploringQuantumClassical2014" class="csl-entry" role="listitem">
King, Chris C. 2014. <span>“Exploring <span>Quantum</span>, <span>Classical</span> and <span>Semi-Classical Chaos</span> in the <span>Stadium Billiard</span>.”</span> <em>Quanta</em> 3 (1): 16. <a href="https://doi.org/10.12743/quanta.v3i1.23">https://doi.org/10.12743/quanta.v3i1.23</a>.
</div>
<div id="ref-kramersAtomBohrTheory1923" class="csl-entry" role="listitem">
Kramers, Hendrik Anthony. 1923. <em>The Atom and the <span>Bohr</span> Theory of Its Structure : An Elementary Presentation</em>. New York : A.A. Knopf. <a href="https://www.gutenberg.org/ebooks/70708">https://www.gutenberg.org/ebooks/70708</a>.
</div>
<div id="ref-laidlerMeaningAdiabatic1994" class="csl-entry" role="listitem">
Laidler, Keith J. 1994. <span>“The Meaning of "Adiabatic".”</span> <em>Canadian Journal of Chemistry</em> 72 (3): 936–38. <a href="https://doi.org/10.1139/v94-121">https://doi.org/10.1139/v94-121</a>.
</div>
<div id="ref-lenardAdiabaticInvarianceAll1959" class="csl-entry" role="listitem">
Lenard, Andrew. 1959. <span>“Adiabatic Invariance to All Orders.”</span> <em>Annals of Physics</em> 6 (3): 261–76. <a href="https://doi.org/10.1016/0003-4916(59)90082-X">https://doi.org/10.1016/0003-4916(59)90082-X</a>.
</div>
<div id="ref-lunneyInsOutsConical2006" class="csl-entry" role="listitem">
Lunney, James G., and Denis Weaire. 2006. <span>“The Ins and Outs of Conical Refraction.”</span> <em>Europhysics News</em> 37 (3): 26–29. <a href="https://www.europhysicsnews.org/articles/epn/pdf/2006/03/epn06305.pdf">https://www.europhysicsnews.org/articles/epn/pdf/2006/03/epn06305.pdf</a>.
</div>
<div id="ref-masoliverClassicalQuantumMechanics2009" class="csl-entry" role="listitem">
Masoliver, Jaume, and Ana Ros. 2009. <span>“From Classical to Quantum Mechanics Through Optics.”</span> <em>European Journal of Physics</em> 31 (1): 171. <a href="https://iopscience.iop.org/article/10.1088/0143-0807/31/1/016/meta">https://iopscience.iop.org/article/10.1088/0143-0807/31/1/016/meta</a>.
</div>
<div id="ref-mcdonaldSpecialRelativityPrecession2023" class="csl-entry" role="listitem">
McDonald, Kirk T. 2023. <span>“Special <span>Relativity</span> and the <span>Precession</span> of the <span>Perihelion</span>.”</span> <em>JH Lab., Princeton University</em>. <a href="http://kirkmcd.princeton.edu/examples/perihelion.pdf">http://kirkmcd.princeton.edu/examples/perihelion.pdf</a>.
</div>
<div id="ref-navarroPaulEhrenfestGenesis2006" class="csl-entry" role="listitem">
Navarro, Luis, and Enric Pérez. 2006. <span>“Paul <span>Ehrenfest</span>: <span>The Genesis</span> of the <span>Adiabatic Hypothesis</span>, 1911–1914.”</span> <em>Archive for History of Exact Sciences</em> 60 (2): 209–67. <a href="https://doi.org/10.1007/s00407-005-0105-1">https://doi.org/10.1007/s00407-005-0105-1</a>.
</div>
<div id="ref-nesterenkoInstabilityClassicalDynamics2007" class="csl-entry" role="listitem">
Nesterenko, V. V. 2007. <span>“Instability of Classical Dynamics in Theories with Higher Derivatives.”</span> <em>Physical Review D</em> 75 (8): 087703. <a href="https://doi.org/10.1103/PhysRevD.75.087703">https://doi.org/10.1103/PhysRevD.75.087703</a>.
</div>
<div id="ref-ostrogradskyMemoiresEquationsDifferentielles1850" class="csl-entry" role="listitem">
Ostrogradsky, M. 1850. <span>“M<span>é</span>moires Sur Les <span>É</span>quations Diff<span>é</span>rentielles, Relatives Au Probl<span>è</span>me Des Isop<span>é</span>rim<span>è</span>tres.”</span> In. <a href="https://www.semanticscholar.org/paper/M%C3%A9moires-sur-les-%C3%A9quations-diff%C3%A9rentielles%2C-au-des-Ostrogradsky/e4e666c2c9bada3ba9c95a2d7d89d09c102e8997">https://www.semanticscholar.org/paper/M%C3%A9moires-sur-les-%C3%A9quations-diff%C3%A9rentielles%2C-au-des-Ostrogradsky/e4e666c2c9bada3ba9c95a2d7d89d09c102e8997</a>.
</div>
<div id="ref-paisFieldTheoriesNonLocalized1950" class="csl-entry" role="listitem">
Pais, A., and G. E. Uhlenbeck. 1950. <span>“On <span>Field Theories</span> with <span>Non-Localized Action</span>.”</span> <em>Physical Review</em> 79 (1): 145–65. <a href="https://doi.org/10.1103/PhysRev.79.145">https://doi.org/10.1103/PhysRev.79.145</a>.
</div>
<div id="ref-paullinAtlasHistoricalGeography1932" class="csl-entry" role="listitem">
Paullin, Charles Oscar. 1932. <em>Atlas of the Historical Geography of the <span>United States</span></em>. <span>[Washington] : published jointly by Carnegie Institution of Washington and the American Geographicl Society of New York</span>. <a href="http://archive.org/details/atlasofhistorica00paul">http://archive.org/details/atlasofhistorica00paul</a>.
</div>
<div id="ref-rayleighXXXIVPressureVibrations1902" class="csl-entry" role="listitem">
Rayleigh, Lord. 1902. <span>“<span>XXXIV</span>. <span><em>On</em></span><span> <em>the Pressure of Vibrations</em></span>.”</span> <em>The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science</em> 3 (15): 338–46. <a href="https://doi.org/10.1080/14786440209462769">https://doi.org/10.1080/14786440209462769</a>.
</div>
<div id="ref-sanchez-sotoVariationsAdiabaticInvariance2013" class="csl-entry" role="listitem">
Sánchez-Soto, Luis L., and Jesús Zoido. 2013. <span>“Variations on the Adiabatic Invariance: <span>The Lorentz</span> Pendulum.”</span> <em>American Journal of Physics</em> 81 (1): 57–62. <a href="https://doi.org/10.1119/1.4763746">https://doi.org/10.1119/1.4763746</a>.
</div>
<div id="ref-schaeferBandTeilElektrodynamik1949" class="csl-entry" role="listitem">
Schaefer, Clemens. 1949. <span>“<span>Band 3, Teil 1 Elektrodynamik und Optik</span>.”</span> In <em><span>Band 3, Teil 1 Elektrodynamik und Optik</span></em>. De Gruyter. <a href="https://doi.org/10.1515/9783111421698">https://doi.org/10.1515/9783111421698</a>.
</div>
<div id="ref-schrodingerUndulatoryTheoryMechanics1926" class="csl-entry" role="listitem">
Schrödinger, E. 1926. <span>“An <span>Undulatory Theory</span> of the <span>Mechanics</span> of <span>Atoms</span> and <span>Molecules</span>.”</span> <em>Physical Review</em> 28 (6): 1049–70. <a href="https://doi.org/10.1103/PhysRev.28.1049">https://doi.org/10.1103/PhysRev.28.1049</a>.
</div>
<div id="ref-smithCambridgeNetworkAction1989" class="csl-entry" role="listitem">
Smith, Robert W. 1989. <span>“The <span>Cambridge Network</span> in <span>Action</span>: <span>The Discovery</span> of <span>Neptune</span>.”</span> <em>Isis</em> 80 (3): 395–422. <a href="https://www.jstor.org/stable/234933">https://www.jstor.org/stable/234933</a>.
</div>
<div id="ref-sommerfeldAtomicStructureSpectral1923" class="csl-entry" role="listitem">
Sommerfeld, Arnold. 1923. <em>Atomic Structure and Spectral Lines</em>. New York, Dutton. <a href="http://archive.org/details/atomicstructures0000somm">http://archive.org/details/atomicstructures0000somm</a>.
</div>
<div id="ref-stoneEinsteinUnknownInsight2005" class="csl-entry" role="listitem">
Stone, A. Douglas. 2005. <span>“Einstein’s Unknown Insight and the Problem of Quantizing Chaos.”</span> <em>Physics Today</em> 58 (8): 37. <a href="http://www.eng.yale.edu/stonegroup/publications/phys_today.pdf">http://www.eng.yale.edu/stonegroup/publications/phys_today.pdf</a>.
</div>
<div id="ref-straumannFirstSolvayCongress2011" class="csl-entry" role="listitem">
Straumann, Norbert. 2011. <span>“On the First <span>Solvay Congress</span> in 1911.”</span> <em>The European Physical Journal H</em> 36 (3): 379–99. <a href="https://doi.org/10.1140/epjh/e2011-20043-9">https://doi.org/10.1140/epjh/e2011-20043-9</a>.
</div>
<div id="ref-swansonOstrogradskiInstabilityWhy2022" class="csl-entry" role="listitem">
Swanson, Noel. 2022. <span>“On the <span>Ostrogradski Instability</span>; or, <span>Why Physics Really Uses Second Derivatives</span>.”</span> <em>The British Journal for the Philosophy of Science</em> 73 (1): 23–46. <a href="https://doi.org/10.1093/bjps/axz042">https://doi.org/10.1093/bjps/axz042</a>.
</div>
<div id="ref-tegmarkDimensionalitySpacetime1997" class="csl-entry" role="listitem">
Tegmark, Max. 1997. <span>“On the Dimensionality of Spacetime.”</span> <em>Classical and Quantum Gravity</em> 14 (4): L69. <a href="https://iopscience.iop.org/article/10.1088/0264-9381/14/4/002/meta">https://iopscience.iop.org/article/10.1088/0264-9381/14/4/002/meta</a>.
</div>
<div id="ref-terhaarAdiabaticInvarianceAdiabatic1966" class="csl-entry" role="listitem">
Ter Haar, D. 1966. <span>“Adiabatic Invariance and Adiabatic Invariants.”</span> <em>Contemporary Physics</em> 7 (6): 447–58. <a href="https://doi.org/10.1080/00107516608205487">https://doi.org/10.1080/00107516608205487</a>.
</div>
<div id="ref-wellsAdiabaticInvarianceAction2007" class="csl-entry" role="listitem">
Wells, Clive G, and Stephen T C Siklos. 2007. <span>“The Adiabatic Invariance of the Action Variable in Classical Dynamics.”</span> <em>European Journal of Physics</em> 28 (1): 105–12. <a href="https://doi.org/10.1088/0143-0807/28/1/011">https://doi.org/10.1088/0143-0807/28/1/011</a>.
</div>
</div></section></div></main> <!-- /main -->
<!-- file: html/copy‑anchors-js.html -->

<script type="module">

document.addEventListener("DOMContentLoaded", () => {

  // 1. All little ¶ icons Quarto/AnchorJS adds

  document.querySelectorAll("a.anchorjs-link").forEach(anchor => {

    anchor.addEventListener("click", async (evt) => {

      // Keep normal scroll behaviour but stop full page reload

      evt.preventDefault();



      // Build absolute URL: origin + path + #hash

      const url = `${location.origin}${location.pathname}${anchor.getAttribute("href")}`;



      // 2. Try modern Clipboard API first

      try {

        await navigator.clipboard.writeText(url);

      } catch {

        // 3. Fallback for legacy browsers

        const helper = Object.assign(document.createElement("input"), { value: url });

        document.body.appendChild(helper);

        helper.select();

        document.execCommand("copy");

        helper.remove();

      }

      // TODO: The following two doesn't work yet

      // 4. Brief visual confirmation (optional)

      anchor.dataset.tooltip = "Copied!";

      setTimeout(() => delete anchor.dataset.tooltip, 1500);



      // 5. Still jump to the heading

      history.pushState(null, "", anchor.getAttribute("href"));

    }, false);

  });

});

</script>

<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/yuxi\.ml\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Analytical Mechanics"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Yuxi Liu"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-05-04"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "2024-05-04"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [math, physics, philosophy]</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">    resources:</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">    - "figure/**"</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "What every graduate student should know about analytical mechanics, delivered with economic style and many illustrations. Particular focus on particle-wave duality and old quantum theory. Prerequisites: multivariate calculus and mathematical maturity."</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "figure/banner/banner_1.png"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="an">image-alt:</span><span class="co"> "A brutalist representation of the particle-wave duality of the Hamiltonian--Jacobi equation. The stacked platforms represent the Hamilton principal function according to the field-theoretic wave interpretation, and the steel rebars are the characteristic rays, with balls rolling along them representing the particle interpretation. Made in Ideogram V1 with the following prompt: 'A brutalist terraced mountain made of concrete and steel rebar. There are ripples parallel to the ground. The steel rebars go downhill, and many marbles are rolling down along the steel rebars. White background. High contrast, grayscale, black-and-white minimalistic, in the flat style of vector svg art, conceptual art'"</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="an">status:</span><span class="co"> "finished"</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="an">confidence:</span><span class="co"> "certain"</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="an">importance:</span><span class="co"> 4</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>{{&lt; include ../../../static/_macros.tex &gt;}}</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">small</span><span class="dt">&gt;</span>Plotting code for the essay is in a <span class="co">[</span><span class="ot">Jupyter notebook</span><span class="co">](./figure/analytical_mechanics_plotting.ipynb)</span>.<span class="dt">&lt;/</span><span class="kw">small</span><span class="dt">&gt;</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">### What this essay contains</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>This essay works through what is typically contained in a university course on analytical mechanics. The prerequisites are multivariate calculus and mathematical maturity.</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>It covers: calculus of variations, Lagrangian, Legendre transform, Hamiltonian, Hamilton's principal function, Hamilton--Jacobi equation, the particle-wave duality, Schrödinger's equation, Hamilton's geometric optics, action-angle variables, Noether's theorem, adiabaticity, old quantum theory, Bohr--Sommerfeld quantization, Einstein--Brillouin--Keller quantization.</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>It does not cover: canonical transforms, Poisson bracket, infinitesimal generator, symplectic geometry, symplectic form.</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>Philosophically, this essay has two undercurrents:</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>One, that <span class="co">[</span><span class="ot">thinking on the margins</span><span class="co">](https://en.wikipedia.org/wiki/Marginalism)</span> is vital not just in economics, but also in classical mechanics. In my other essay, <span class="co">[</span><span class="ot">*Classical thermodynamics and economics*</span><span class="co">](https://yuxi-liu-wired.github.io/essays/posts/equilibrium-thermoeconomics)</span>, I show that classical thermodynamics is also nothing more than thinking on the margins.</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>Two, classical mechanics is a leakless leaky abstraction. Though classical mechanics has many equivalent forms, the search for the most elegant form has led us to the Hamilton--Jacobi equation, and the adiabatic theorem, both of which were on the threshold of quantum mechanics. Even though classical mechanics is a self-consistent closed world (thus "leakless"), when viewed in the right light, all its lines and planes seem to angle towards a truer world (thus "leaky"), of which this world is merely a shadow (thus "abstraction").</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conventions</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>We always assume all functions are analytic (that is, they have Taylor expansions).</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>We would often say "minimize cost" or "maximize revenue" or such, but we always mean "stationarize". For example, when we say "Let's maximize $f(x)$", what we mean is "Let's solve $f'(x) = 0$". If we were to actually maximize $f(x)$, we would have to check $f''(x) &lt; 0$ as well, but we don't. This is not a problem for physics, where the principle of *stationary* action rules. However, in optimal control and economics, we should check if the solution is actually a minimum/maximum.<span class="ot">[^stationarize]</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="ot">[^stationarize]: </span>Thus, the analogy between classical mechanics and economics is not precise. However, the analogy is precise between classical thermodynamics and economics, since the entropy is actually maximized, and not merely stationarized.</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>Instead of laboriously typing $\vec q$ or $\mathbf{q}$, I just write $q = (q_1, \dots, q_n)$, unless there is a serious risk of confusion.</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Symbol <span class="pp">|</span> Mechanics      <span class="pp">|</span> Economics       <span class="pp">|</span> Control Theory <span class="pp">|</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="pp">|---|---|---|---|</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $L$                           <span class="pp">|</span> Lagrangian    <span class="pp">|</span> time-rate of cost  <span class="pp">|</span> time-rate of cost <span class="pp">|</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $t$                           <span class="pp">|</span> time          <span class="pp">|</span> time                   <span class="pp">|</span> time <span class="pp">|</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $q$                           <span class="pp">|</span> location/coordinate <span class="pp">|</span> commodity      <span class="pp">|</span> state variable <span class="pp">|</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $\dot q$                      <span class="pp">|</span> velocity      <span class="pp">|</span> production rate/consumption rate <span class="pp">|</span> control variable <span class="pp">|</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $S = \int L(t, q, \dot q)dt$  <span class="pp">|</span> action        <span class="pp">|</span> total cost <span class="pp">|</span> total cost <span class="pp">|</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $p$                           <span class="pp">|</span> momentum      <span class="pp">|</span> price        <span class="pp">|</span> co-state variable <span class="pp">|</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $H = \sum_i p_i\dot q_i - L$  <span class="pp">|</span> Hamiltonian   <span class="pp">|</span> market equivalent cash flow<span class="ot">[^cash-flow]</span> <span class="pp">|</span> Hamiltonian <span class="pp">|</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>: Reference table for the economics-mechanics analogy.</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="ot">[^cash-flow]: </span>also known as "<span class="co">[</span><span class="ot">mark to market</span><span class="co">](https://en.wikipedia.org/wiki/Mark-to-market_accounting)</span> cash flow"</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="fu">### Why I wrote this</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>I wrote this as "Analytical Mechanics done right", or "What every graduate student in physics should know about analytical mechanics, but didn't learn well, because the textbooks are filled with too many symbols and not enough pictures.", or "what I wish the textbooks to have said when I first learned the subject".</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>In my physics Olympiad years, I saw the Lagrangian a few times, but we had no use for that. During my undergraduate years, I studied analytical mechanics. The construction of the Lagrangian was reasonable enough, and I understood how the Euler--Lagrange equation was derived by $\delta \int L = 0$. However, as soon as they proceeded to the Hamiltonian, I was entirely lost.</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>What is $H(p, q) = p \dot q - L(q, \dot q)$? Why does the right side depend on $\dot q$ but not the left side? How does anyone just *make up* the Legendre transform out of thin air? It's named "Legendre transform" -- well, if it has such a fancy name, surely this has many more applications than $H = p \dot q - L$, else, why not call it "Legendre's one-time trick"? Canonical transform? Point transform? Aren't they all coordinate transforms? Poisson bracket? Infinitesimal generators? It was all a giant mess. Reading Goldstein's classic textbook only made my confusion more well-rounded.</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>Early 2023, I studied mathematical microeconomics. When I was studying <span class="co">[</span><span class="ot">Ramsey's theory of optimal saving</span><span class="co">](https://en.wikipedia.org/wiki/Ramsey%E2%80%93Cass%E2%80%93Koopmans_model)</span>, I saw, to my great surprise, something they call a "Hamiltonian" <span class="co">[</span><span class="ot">@campanteAdvancedMacroeconomicsEasy2021, chapter 3</span><span class="co">]</span>. I was shocked, but after studying it carefully, and thinking it over, I realized that it was no mistake -- the "Hamiltonian" in economics and in physics really are the same. Physics has an economic interpretation. Everything fell into place over the course of a few hours. Guided by this vision, I worked through analytical mechanics again, this time with true understanding.</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>It is my experience that everything in undergraduate physics is taught badly, except perhaps Newtonian mechanics. I have written this essay to make analytical mechanics finally make sense. It has made sense for me, and I hope it will make sense for you.</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optimization as making money</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="fu">### The shortest line problem</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>In this problem, the so-called "time" $t$ has units of length as well. So, please don't panic when we see something like $\sqrt{1 + \dot x^2}$. If it worries we, we can replace $t$ by $v\tau$, where $v$ is a constant speed of one, and $\tau$ is time.</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>Start with the easiest problem: shortest path problem. What is the shortest path from $(0, 0)$ to $(A, B)$? We parametrize the path by a function $t \mapsto (x(t), y(t))$, with $t\in <span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span>$. The problem is then</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>$$\begin{cases} \min \int_0^1 \sqrt{\dot x^2 + \dot y^2}dt <span class="sc">\\</span> \int_0^1 \dot x dt = A <span class="sc">\\</span> \int_0^1 \dot y dt = B <span class="sc">\\</span> \end{cases}$$</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="al">![What is the shortest path from $(0, 0)$ to $(A, B)$?](figure/shortest_path_problem.svg)</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>This is a standard constraint-optimization problem, and could be solved by the Lagrangian multiplier method:</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>$$\delta \left(\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt + p_x \left( A - \int_0^1 \dot x dt\right) + p_y \left( B - \int_0^1 \dot y dt\right) \right) = 0$$</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>where $p_x, p_y$ are the Lagrangian multipliers, each responsible for enforcing one constraint.</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>Varying the path functions $x, y$ gives us</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>$$\delta \int_0^1 (\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y)dt = 0$$</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>Each of $\dot x, \dot y$ could be independently perturbed with a tiny concentrated "pulse", so for the integral to be stationary, the integrand must be zero with respect to derivatives of $\dot x, \dot y$. That is, we have</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>$$\begin{cases} \partial_{\dot x}(\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y )= 0<span class="sc">\\</span> \partial_{\dot y}(\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y ) = 0 \end{cases}$$</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>and we are faced with the solution</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>$$(p_x, p_y) = \frac{1}{\sqrt{\dot x^2 + \dot y^2}}(\dot x, \dot y)$$</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>Since $p_x, p_y$ are independent of time, they are constants, and since we have from the above equation $p_x^2 + p_y^2 = 1$, we find that $p_x = \cos\theta, p_y = \sin\theta$ for some $\theta$. Thus, the curve is a straight line making an angle $\theta$ to the x-axis.</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a><span class="fu">### Economic interpretation</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>Interpret $x, y$ as two goods that we can produce (let's say, tons of steel and tons of copper).</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>We are a factory manager, and  we are given a task: produce $A$ of $x$ (tons of steel), and $B$ of $y$ (tons of copper), in $<span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span>$ (one year). If we don't do it, we will be sacked. Our problem is to accomplish the task at minimal cost.</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>$\dot x, \dot y$ are the speed at which we produce the goods, which we can freely control. In control theory, we say $x, y$ are state variables, and $\dot x, \dot y$ are control variables.</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>The cost function is $L(t, x, y, \dot x, \dot y) = \sqrt{\dot x^2 + \dot y^2}$. Its integral $S = \int_0^1 L dt$ is the total cost of production, which we must minimize.</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>We are also given a free market on which we are allowed to buy and sell the goods. If we cannot achieve the production target, we buy from the market. If we achieve more than the production target, we sell them off.</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>Then, the total cost is</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>$$\left(\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt + p_x \left( A - \int_0^1 \dot x dt\right) + p_y \left( B - \int_0^1 \dot y dt\right) \right)$$</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>where $p_x, p_y$ are the market prices which do not change with time.</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>If our production plan is optimal, then the plan must have stationary cost. That is, if we make a change in our production plan $(\dot x, \dot y)$ by $O(\delta)$, our production cost must not change by $O(\delta)$, or else we could achieve lower cost. For example, if the plan $(\dot x + \delta \dot x, \dot y + \delta \dot y)$ achieves higher cost, then $(\dot x - \delta \dot x, \dot y - \delta \dot y)$ achieves lower cost.</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>Mathematically, it means the optimal production plan must satisfy</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>$$\delta \left(\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt + p_x \left( A - \int_0^1 \dot x dt\right) + p_y \left( B - \int_0^1 \dot y dt\right) \right) = 0$$</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>Now, the great thing about the market is that it is always there and we can trade with it, So, we have completely transformed the question into a problem of profit maximization -- we'll always sell to the market, and then buy back from the market right at the end.</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>Now we can perform profit maximization moment-by-moment: raise production until marginal profit reaches cost:</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>$$\begin{cases} \partial_{\dot x}(\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y )= 0<span class="sc">\\</span> \partial_{\dot y}(\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y ) = 0 \end{cases}$$</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>which may be solved as before.</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>Now we can interpret $p_x, p_y$. What are they? Suppose we perturb $\dot x$ by $\delta \dot x$, then since the production plan is already optimal, we have</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>$$\delta \left(\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt + p_x \left( A - \int_0^1 \dot x dt\right) + p_y \left( B - \int_0^1 \dot y dt\right) \right) = 0$$</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>that is,</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>$$p_x \delta \int_0^1 \dot xd t = \delta\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt$$</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>We have our interpretation $p_x$: the marginal cost of producing one unit of $A$, That is, if we want an extra $\delta A$, we have to incur an extra cost $p_x \delta A$.</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>We actually have $p_x = \cos \theta, p_y = \sin\theta$, which means that when $x, y$ are perturbed by $\delta x, \delta y$, the shortest length between them is perturbed by</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>$$p_x \delta x + p_y \delta y = \cos\theta \delta x + \sin\theta \delta y$$</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>which is clearly true by geometry.</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="The market inside our head"}</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>We actually don't need an external market. We could have put up such a fictional market inside the factory, and simply read out its price $p_x, p_y$ without ever trading with it. Why? Because in this problem, a solution exists, and under some niceness assumptions, there exists a "fair" market price at which we are indifferent to trading with the market -- we can sell $\delta x$ and buy $\delta y$, but there is "no point to it" because it doesn't change our eventual cost. Thus, although the market exists, we never actually trade with it, so the market might as well be a card-board cutout with a number display of the latest prices. As long as we don't *actually* try to trade with it, we would be behaving exactly as if we are facing a real market with the same prices.</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>It is perhaps best to think of the markets as things inside the head, a system of mental accounting to assign the proper price of everything. If the market prices are truly efficient, then we don't need a real market to trade with.</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; When the producer is ready, the market appears.</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; When the producer is truly ready, the market disappears.</span></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lagrange's devil at Disneyland</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>This is a parable about maximizing entropy under conservation of energy.</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>You are going to an amusement park, with many amusements $i = 1, 2, \dots, n$. You have exactly 1 day to spend there, so you need to spend $p_i$ of a day on amusement $i$. Now, your total utility at the end of the day is </span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>$$S(p) := \sum_i p_i \ln \frac{1}{p_i}$$</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>a sum of logarithms, the idea being that you gain utility on any amusement at a decreasing rate: The first minute on the rollercoaster is great, but the second is less, and the third even less.</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>If that's all there is to the amusement park, then the solution is clear: you should spend an equal amount of time at each amusement. This can be proved by the Lagrange multiplier mechanically, but underneath the algorithm of the Lagrange multiplier is the idea of partial equilibrium, so it's worth spelling it out in full.</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Proof by partial equilibrium" collapse="false"}</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>Suppose your parents give you a schedule for your amusement. You look at the schedule and notice that $p_i &lt; p_j$. You can reject the plan and say, "I can always do better just by spending equal time at $i, j$, even holding the other times fixed.". That is, if we are only allowed to trade between time at $i$ and $j$ (a "partial market"), then at partial market equilibrium, the marginal utility of amusements $i, j$ must be equal.</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>The marginal utility of amusement $i$ is $\ln(1/p_i) - 1$, and the same for $j$. So, at partial equilibrium, $p_i = p_j$, and at general equilibrium, all partial markets are in partial equilibrium.</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>Unfortunately, the amusement park is actually infinite. You can take this news in two ways: optimistically "I can earn arbitrarily high utility by spending $1/N$ of a day on $N$ amusements each, and let $N$ be as large as I want!" and pessimistically "No matter how much I try, I can never achieve the perfect day.". Fortunately, the amusement park has a token system: when you enter the park, you would buy a certain number of tokens. Then you spend some tokens at the rides, proportional to the time you spend there.</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>There are some rules to the game:</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>You will be given a certain number of tokens $E$ at the start of the day.</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The prices of amusements are $0 = E_0 \leq E_1 \leq E_2 \leq \cdots$. Here $E_0$ is the "zero-point energy", or in other words, "just relax".</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>You must spend exactly all your tokens. Your parents hate wastefulness and would beat you up if you don't use all the tokens.</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Your parents are kind enough to supply you with the right number of tokens $E$, such that you can avoid getting beat up: $E_0 \leq E \leq \max_i E_i$.</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>Thus we have reduced the problem to</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>    \max S(p) <span class="sc">\\</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>    \sum_i p_i \cdot 1 = 1 <span class="sc">\\</span></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>    \sum_i p_i \cdot E_i = E</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>Under these assumptions, there exists a unique schedule that maximizes your fun, or entropy.</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>Now there is a slight difficulty with your previous approach. Doing partial equilibrium between 2 amusements is not possible now, because you have two constraints of not just time, but also tokens. Suppose you spend less time at $i$ to spend more time at $j$, this might cause you to under- or over-spend your tokens. So, to make a partial equilibrium calculation, you must use at least 3 amusements, not 2. And you are not allowed to "just relax", since relaxing is actually "the 0th amusement", and thus it also costs you tokens and time. That is, you must open partial markets with $i, j, k$ at once, and then you can run the system to partial equilibrium. This is pretty annoying. There's got to be a better way. </span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>Suddenly, in a puff of smoke, Lagrange's devil makes an appearance!</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"You can't solve the general equilibrium problem, you say? Why not try the Lagrange multipliers?"</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"Too annoying."</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"Alright, how about I make you a deal --"</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"Sorry, but I don't sell my soul."</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"Don't be stupid -- only something as stupid as God could still believe in souls these days! I am proposing that you trade happiness for time and for tokens. I will make a set price for time and another set price for tokens. Both prices are in units of your happiness. You can buy happiness with time, or time with happiness, also for tokens."</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"Uhmm..."</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"That's all that I offer. You should read up on microeconomics so you can make the right choice. See you when the day comes!" </span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>So the day comes and the devil shows up with the two prices:</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>1 unit of time = $\alpha$ unit of utility.</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>1 unit of token = $\beta$ unit of utility.</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>So you solve the following problem</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>$$\max_p \lrb{S(p) - \alpha \sum_i p_i - \beta \sum_i p_i E_i}$$</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>What a great luck that the devil is there -- it has split a giant, intercorrelated general equilibrium into so many little, uncorrelated partial equilibria:</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>$$\forall i,\quad \max_{p_i} \lrb{p_i \ln \frac{1}{p_i} - \alpha p_i - \beta p_i E_i}$$</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>with solution $p_i = e^{-1-\alpha} e^{-\beta E_i}$.</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>You are about to go to the devil, but then the devil waves at you to halt, "Don't make individual trades, but make a bulk one-time trade.". So you calculate $\sum_i p_i$ and $\sum_i p_i E_i$, and to your surprise, you find that they equal exactly $1$ and $E$. That is, you actually would spend all your time and tokens without needing to trade with the devil.</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>And so you sits there, looking at your two equations in strange amusement:</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>$$p_i = \frac{e^{-\beta E_i}}{e^{1+\alpha}}, \quad \alpha+1 = \ln\sum_i e^{-\beta E_i} , \quad E = \sum_i E_i \frac{e^{-\beta E_i}}{e^{1+\alpha}}$$</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>A physicist comes and points out that they are better known as</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>$$p_i =  \frac{e^{-\beta E_i}}{Z}, \quad Z = e^{-\beta F} = \sum_i e^{-\beta E_i}, \quad E = \sum_i p_i E_i$$</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>where $Z$ is called "partition function", $F$ "Helmholtz free energy", and $\beta$ "inverse temperature". </span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>As the devil prepares to leave, you call after it:</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"I'm grateful for all your help, but, please why did you price your wares this way?"</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"Because I don't want you to actually be happier!"</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"What do you mean?"</span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"If I were to lower the price of tokens, then what would you do? You would realize that you can profit by spending a little less time at every amusement, then sell both the time and the tokens you saved, increasing your happiness! Similarly for any other form of price change. If I priced it in any other way than the equilibrium prices, you would be able to exploit my bad pricing and arbitrage out some happiness."</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"So why did you come to visit me in the first place?"</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>"It was easy to mess with mortals back before you discovered calculus. Now all I do is help you people discover general equilibrium, because you people have no fun anymore -- every arbitrage opportunity is exploited to death. Still, I have to come, because I am the CEO of Hell, and I need to make maximally profitable deals with mortals, no matter how pointless it is."</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; When the mortal is ready to make a deal, the devil appears.</span></span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; When the mortal is truly ready to make a deal, the devil disappears.</span></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a><span class="fu">### Isoperimetric problem</span></span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>If we have a rope of length $S$, and wish to span it from $(0, 0)$ to $(T, h)$, what shape should the rope have, in order to maximize the area under the rope? In formulas, we model the rope as a differentiable function $x(t): <span class="co">[</span><span class="ot">0, T</span><span class="co">]</span> \to \mathbb R$, such that</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>$$\begin{cases} </span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>\max \int_0^T xdt<span class="sc">\\</span> </span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>\int_0^T \sqrt{1 + \dot x^2}dt = S <span class="sc">\\</span> </span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>\int_0^T \dot x dt = h </span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>\end{cases}$$</span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>Here we have two constraints, but the solution is essentially the same. First, to take care of the two constraints, we open two markets $p_h, p_S$ -- one for the price of height, and another for the price of rope. Then, solve for</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>$$\delta \int_0^T \left(x + p_h \left(\frac hT - \dot x\right) +  p_S\left(\frac ST - \sqrt{1+\dot x^2}\right)\right) dt = 0$$</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>The state variable is $x$, and the control variable is $\dot x$. Unlike the previous problem, here we need to maximize the integral of the state variable. Consequently, we consider it as a problem of "profit flows".</span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>To make things more clear, let's explicitly write $v$ as a control variable, and say that the control system satisfies:</span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>$$\begin{cases} </span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>v \text{ is a control variable}<span class="sc">\\</span> </span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>x \text{ is a state variable}<span class="sc">\\</span> </span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>\dot x = v </span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>\end{cases}$$</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>Given that, how do we control the system? Again, it comes down to putting a price on everything, and maximizing at each instant. So, let's open a market on commodity $x$, such that the "fair" price is $p(t)$ at time $t$. With that, we can write down the profit flow</span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>$$H = x + p_h \left(\frac hT - v\right) +  p_S\left(\frac ST - \sqrt{1+v^2}\right) + p v$$</span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>and maximizing profit over all time implies maximizing profit flow at every instant:</span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>$$\partial_v H= 0$$</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>This gives us one equation, but we need one more equation. Namely, we need to know how $p(t)$, the "fair" price of $x$, changes with time.</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>The fundamental problem in pricing theory is this: how do we put a price on something? The fundamental reply from pricing theory is: no-arbitrage (no free money).</span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>Here is how the no-arbitrage argument works. Suppose that we have been following our optimal production plan. Then at time $t$, we suddenly decide to buy an extra $\delta x$ from the market, save it, then sell $\delta x$ at time $t+ \delta t$.</span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>Now, since $\dot x = v$, this buying-and-selling plan does not change how much $x$ grows, so after time $\delta t$, we have $\delta x(t + \delta t) = \delta x(t)$. Thus, the no-arbitrage equation states:</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>$$p(t)\delta x(t) = p(t + \delta t)\delta x(t + \delta t)  + \delta x(t) \delta t \implies p(t+ \delta t) = p(t) - \delta t$$</span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>and consequently, $\dot p = -1$. This is the price dynamics. Intuitively, we see that the value of a standing stock of $x$ decreases as we run out of time to use it for producing.</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>To solve</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>$$\partial_v  H= 0$$</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>first expand it to</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>$$-p_h + p - p_S \frac{\dot x}{\sqrt{1 + \dot x^2}} =  0$$</span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>then take derivative with respect to $t$, to obtain</span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>$$-\frac{\ddot x}{(1+\dot x^2)^{3/2}} = \frac{1}{p_S}$$</span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>From elementary calculus, we know the item on the left is the curvature, so we find that the line $x(t)$ is a constant-curvature curve -- circular arc. The radius of the circle is the inverse of curvature, which is exactly $p_S$. Thus we find that, if we are given $\delta S$ more rope, we can encircle $R\delta S$ more area under the rope, where $R$ is the radius of curvature for the circular arc.</span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>Notice that there we are not given the sign of $p_S$. There are in general two solutions, one being a circular arc curving downwards, and the other curving upwards. If we use $p_S &lt; 0$, then we get the one curving upwards, and so we get the solution that achieves *minimal* area under the rope. If we use $p_S &gt; 0$, then we get the *maximal* solution. This is a general fact about such problems.</span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lagrangian and Hamiltonian mechanics</span></span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a>Generalizing from our experience above, we consider a generic function $L(t, q, v)$, with finitely many state variables $q_1, ..., q_N$. For each state variable $q_i$, we regard its time-derivative as a control variable $v_i$, which we are free to vary. Our goal is to design a production plan $t \mapsto v(t)$, such that</span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a>$$\delta \int L(t, q(t), v(t)) dt = 0, \quad \dot q = v$$</span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a>To comply with general sign conventions, we interpret $L$ as cost-per-time, so we *say* we want to minimize it (even though we only want to stationarize it).</span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a>We can understand $i\in<span class="sc">\{</span>1, 2,..., N<span class="sc">\}</span>$ to denote a commodity, say timber and sugar (let's say there is such a thing as "negative 1 ton timber" -- that is, we can short-sell commodities). Let $p_i$ be the market price of commodity $i$. Again, there is no need for real market to trade with if the prices are right, since at the right price (no-arbitrage price), we are indifferent between buying and selling, or producing and consuming. It is purely a "mental accounting" device.</span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>With access to a market, our profit flow is:</span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>$$H(t, q, p, v) := \ub{\sum_i p_i v_i}{revenue flow} - \ub{L(t, q, v)}{cost flow}$$</span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>In words, $H(t, q, p, v)$ is the rate of profit at time $t$ if we hold a stock of commodity $q$, is producing at rate $v$, and the market price of commodities is $p$. This is close to the Hamiltonian, but not yet. We still need to remove the dependence on $v$.</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>Moment-by-moment profit-flow maximization is myopic, and could lead us into deadends. That is, it is not a sufficient condition for global profit-maximization. However, it is a necessary condition. That is, suppose we are given a profit-maximizing trajectory, then it must maximize profit flow at every moment, since otherwise we could improve it. In formula:</span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a>$$v = \mathop{\mathrm{arg\,max}}_v \left(\sum_i p_i v_i - L(t, q, v)\right)$$</span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a>So, define the "optimal controller" as</span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a>$$v^\ast (t, q, p) = \mathop{\mathrm{arg\,max}}_v \left(\sum_i p_i v_i - L(t, q, v)\right)$$</span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a>and define $H$ as the "maximal profit flow" function:</span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a>$$H(t, q, p) = \max_{v} \left(\sum_i p_i v_i - L(t, q, v)\right) = \sum_i p_i v_i^\ast(t, q, p) - L(t, q, v^\ast(t, q, p))$$</span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a>By basic convex analysis, if $L$ is strictly convex with respect to $v$, then $v^*$ is determined uniquely by $(t, q, p)$, and furthermore, it is a continuous function of $(t, q, p)$. Consequently, "profit maximization" allows us to model the system in $(t, q, p)$ instead of $(t, q, v)$ coordinates, and the dynamics of the system is equivalently specified by either $H$ or $L$.</span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a>This is the mysterious "Legendre transform" that they whisper of. It is better called "convex dual". I also like to joke that the *real* reason that momentum is written as $p$ is because it secretly means "price"!</span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a><span class="fu">### Derivatives of $H$</span></span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a>::: {#thm-hotelling-lemma}</span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hotelling's lemma</span></span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a>$H(t, q, p)$ is differentiable with respect to $p$, and</span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a>    \partial_t H(t, q, p) &amp;= -(\partial_t L)(t, q, v^\ast(t, q, p)) <span class="sc">\\</span></span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a>    \nabla_p H(t, q, p) &amp;= v^\ast(t, q, p) <span class="sc">\\</span></span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a>    \nabla_q H(t, q, p) &amp;= -(\nabla_q L)(t, q, v^\ast(t, q, p)) <span class="sc">\\</span></span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Proof" collapse="false"}</span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a>We prove the first formula. The other two are proved in the same way.</span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a>The argument is by no-arbitrage. We can imagine what happens if we were to suffer a little price-shock $\delta p$, adjust our production plan accordingly to $v + \delta v$, then *hold* that production plan and suffer another little price-shock $-\delta p$. Since we are back to the original price $p$ again, we should have no more than the maximal profit rate. That is, we should have</span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a>$$\ub{H(t, q, p)}{maximal rate before shock} \geq \ub{H(t, q, p+\delta p)}{maximal rate after shock} + \ub{\langle -\delta p, v^\ast(t, q, p+\delta p) \rangle}{undoing the shock, holding price steady}$$</span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a>Since $\delta p$ is infinitesimal, this implies $\lra{-\delta p , \nabla_v H} \geq \lra{-\delta p , v^*(t, q, p)} + O(\delta^2)$ for all $\delta p$, implying $\nabla_v H = v^\ast(v^*(t, q, p))$.</span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Notation for $\partial_t L$"}</span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a>Here, we explicitly put a bracket around $\partial_t L$ to emphasize that</span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a>(\partial_t L)(t, q, v^\ast(t, q, p)) </span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a>&amp;= \lim_{\epsilon \to 0} \frac{L(t + \epsilon, q, v^\ast(t, q, p)) - L(t, q, v^\ast(t, q, p))}{\epsilon} <span class="sc">\\</span></span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a>&amp;\neq \lim_{\epsilon \to 0} \frac{L(t + \epsilon, q, v^\ast(t + \epsilon, q, p)) - L(t, q, v^\ast(t, q, p))}{\epsilon}</span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a>\end{aligned}$$</span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a>and similarly for $\nabla_q L$.</span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hamiltonian equations of motion</span></span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>We are given free control over $\dot q$, and we saw that the cost-minimizing trajectory must maximize the profit flow moment-by-moment. That is,</span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>$$\dot q(t) = v^\ast(t, q(t), p(t)) = (\nabla_p H)(t, q(t), p(t))$$</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a>or more succinctly (you can see why we tend to be rather sloppy with notations!)</span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a>$$\dot q \ub{=}{optimality} v^\ast \ub{=}{Hotelling's lemma} \nabla_p H$$</span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a>More evocatively speaking, we have two opposing forces of greed and no-arbitrage, clashing together to give something interesting:</span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>$$\dot q \ub{=}{we are greedy} v^\ast \ub{=}{but the market gives us no free money} \nabla_p H$$</span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>It remains to derive $\dot p$ by the no-arbitrage condition: If we shock the system with some $\delta q_i$, it does not matter if we sell it now, or carry it $\delta t$, incurring additional cost, and sell it later. That is,</span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>$$p_i(t) \delta q_i = p_i(t+\delta t) \delta q_i - \partial_{q_i} L(t, q, v) \delta q_i \delta t \implies \dot p_i = \partial_{q_i} L(t, q, v)$$</span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a>::: {#tip-higher-order-infinitesimal .callout-tip title="Higher-order infinitesimal"}</span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a>The equality should be more precisely read as "up to a higher-order infinitesimal than $\delta q_i\delta t$". That is, we should be writing:</span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a>p_i(t) \delta q_i = p_i(t+\delta t) \delta q_i - \partial_{q_i} L(t, q, v) \delta q_i \delta t  + o(\delta q_i\delta t)</span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>This detail would come up later in our proof of the <span class="co">[</span><span class="ot">Hamilton--Jacobi equation</span><span class="co">](#thm-hje)</span>.</span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a>Since we are only concerned with what happens on the optimal trajectory, we always choose $v = v^\ast$, so</span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a>$$\dot p_i = (\partial_{q_i} L)(t, q, v^\ast(t, q, p)) \ub{=}{Hotelling's lemma} -\partial_{q_i} H(t, q, p)$$</span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a>Thus, we obtain the two fundamental equations of Hamiltonian mechanics: </span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>::: {#thm-hem}</span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hamilton equations of motion</span></span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a>$$\begin{cases}  </span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a>\partial_t H &amp;= -\partial_t L <span class="sc">\\</span></span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a>\dot p = -\nabla_q H <span class="sc">\\</span>     </span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a>\dot q = \nabla_p H </span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a>\end{cases}$$</span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a><span class="fu">### Euler--Lagrange equations of motion</span></span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a>By definition,</span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a>$$H(t, q, p) =  \max_{v} \left(\sum_i p_i v_i - L(t, q, v)\right) =  \sum_i p_i v_i^\ast(t, q, p) - L(t, q, v^\ast(t, q, p))$$</span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a>and since $L$ is strictly convex in $v$, this can be inverted (this is called "**convex duality**") to give</span>
<span id="cb1-458"><a href="#cb1-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-459"><a href="#cb1-459" aria-hidden="true" tabindex="-1"></a>$$L(t, q, v) =  \max_{p} \left(\sum_i p_i v_i - H(t, q, p)\right) =  \sum_i p^\ast_i v_i - H(t, q, p^\ast(t, q, p))$$</span>
<span id="cb1-460"><a href="#cb1-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-461"><a href="#cb1-461" aria-hidden="true" tabindex="-1"></a>where $p^\ast = \mathop{\mathrm{arg\,max}}_p \sum_i p_i v_i - H(t, q, p)$. It is a basic theorem in convex geometry that, if $L$ is strictly convex in $v$, then $H$ is strictly convex in $p$, so the inversion works.</span>
<span id="cb1-462"><a href="#cb1-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-463"><a href="#cb1-463" aria-hidden="true" tabindex="-1"></a>By the same argument as in Hotelling's lemma, we have</span>
<span id="cb1-464"><a href="#cb1-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-465"><a href="#cb1-465" aria-hidden="true" tabindex="-1"></a>$$\nabla_v L(t, q, v) = p^\ast(t, q, v)$$</span>
<span id="cb1-466"><a href="#cb1-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-467"><a href="#cb1-467" aria-hidden="true" tabindex="-1"></a>By definition of the convex dual, for any $t, q, p, v$, we have</span>
<span id="cb1-468"><a href="#cb1-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-469"><a href="#cb1-469" aria-hidden="true" tabindex="-1"></a>$$H(t, q, p) + L(t, q, v) \leq \sum_i p_i v_i$$</span>
<span id="cb1-470"><a href="#cb1-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-471"><a href="#cb1-471" aria-hidden="true" tabindex="-1"></a>with equality reached iff both $p = p^\ast(t, q, v)$ and $v = v^\ast(t, q, p)$. Thus, on any optimal trajectory, since $v = v^\ast(t, q, p)$, we must also have $p = p^\ast(t, q, v)$, and consequently,</span>
<span id="cb1-472"><a href="#cb1-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-473"><a href="#cb1-473" aria-hidden="true" tabindex="-1"></a>$$\frac{d}{dt} \nabla_v L \ub{=}{Hotelling's lemma} \dot p^\ast \ub{=}{optimality} \dot p \ub{=}{no-arbitrage} \nabla_q L$$</span>
<span id="cb1-474"><a href="#cb1-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-475"><a href="#cb1-475" aria-hidden="true" tabindex="-1"></a>This is the famous</span>
<span id="cb1-476"><a href="#cb1-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-477"><a href="#cb1-477" aria-hidden="true" tabindex="-1"></a>::: {#thm-elem}</span>
<span id="cb1-478"><a href="#cb1-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-479"><a href="#cb1-479" aria-hidden="true" tabindex="-1"></a><span class="fu">## Euler--Lagrange equations of motion</span></span>
<span id="cb1-480"><a href="#cb1-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-481"><a href="#cb1-481" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-482"><a href="#cb1-482" aria-hidden="true" tabindex="-1"></a>\frac{d}{dt} (\partial_{v_i} L) = (\nabla_{q_i} L) \quad \forall i \in <span class="sc">\{</span>1, 2, \dots, N<span class="sc">\}</span></span>
<span id="cb1-483"><a href="#cb1-483" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-484"><a href="#cb1-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-485"><a href="#cb1-485" aria-hidden="true" tabindex="-1"></a>or more succinctly, </span>
<span id="cb1-486"><a href="#cb1-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-487"><a href="#cb1-487" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-488"><a href="#cb1-488" aria-hidden="true" tabindex="-1"></a>\frac{d}{dt} (\nabla_v L) = \nabla_q L</span>
<span id="cb1-489"><a href="#cb1-489" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-490"><a href="#cb1-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-491"><a href="#cb1-491" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-492"><a href="#cb1-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-493"><a href="#cb1-493" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Explaining the notation" collapse="true"}</span>
<span id="cb1-494"><a href="#cb1-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-495"><a href="#cb1-495" aria-hidden="true" tabindex="-1"></a>Physicists are often sloppy with notations, but the Euler--Lagrange equation is particularly egregious in this regard, so I will describe it carefully.<span class="ot">[^sloppy-notation]</span></span>
<span id="cb1-496"><a href="#cb1-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-497"><a href="#cb1-497" aria-hidden="true" tabindex="-1"></a><span class="ot">[^sloppy-notation]: </span>I am okay with sloppy notation sometimes, but in this case, the sloppy notation often leads to calculational mistakes and conceptual confusions, as teachers of undergrad courses can testify.</span>
<span id="cb1-498"><a href="#cb1-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-499"><a href="#cb1-499" aria-hidden="true" tabindex="-1"></a>The function $L$ is a function of type $\ub{\R}{time} \times \ub{\R^N}{state} \times \ub{\R^N}{control} \to \R$.</span>
<span id="cb1-500"><a href="#cb1-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-501"><a href="#cb1-501" aria-hidden="true" tabindex="-1"></a>The function $\partial_{v_i} L$ is also a function of type $\R \times \R^N \times \R^N \to \R$. It is obtained by taking derivative of $L$ over its $(1 + i)$-th input. Let's write that as $f_i$ to make sure we are not confused by it. It is absolutely important to be clear about this! $f_i$ is *not* a function defined only along a trajectory, but over the entire space of $\R \times \R^N \times \R^N$. We can similarly define $f_{i + N}$ to be $\partial_{q_i} L$.</span>
<span id="cb1-502"><a href="#cb1-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-503"><a href="#cb1-503" aria-hidden="true" tabindex="-1"></a>Now, suppose we are given a *purportedly optimal* trajectory $q: \R \to \R^N$, then for any coordinate $i \in <span class="sc">\{</span>1, 2, \dots, N<span class="sc">\}</span>$, we can define a function $g_i$, of type $\R \to \R$ by </span>
<span id="cb1-504"><a href="#cb1-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-505"><a href="#cb1-505" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-506"><a href="#cb1-506" aria-hidden="true" tabindex="-1"></a>g_i(t) = f_i(t, q(t), \dot q(t))</span>
<span id="cb1-507"><a href="#cb1-507" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-508"><a href="#cb1-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-509"><a href="#cb1-509" aria-hidden="true" tabindex="-1"></a>and similarly, we can define $g_{i + N} = f_{i + N}(t, q(t), \dot q(t))$.</span>
<span id="cb1-510"><a href="#cb1-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-511"><a href="#cb1-511" aria-hidden="true" tabindex="-1"></a>The Euler--Lagrange equations say that we need only check </span>
<span id="cb1-512"><a href="#cb1-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-513"><a href="#cb1-513" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-514"><a href="#cb1-514" aria-hidden="true" tabindex="-1"></a>g_i'(t) = g_{i+N}(t) \quad \forall t \in <span class="co">[</span><span class="ot">0, T</span><span class="co">]</span>, i \in 1:N</span>
<span id="cb1-515"><a href="#cb1-515" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-516"><a href="#cb1-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-517"><a href="#cb1-517" aria-hidden="true" tabindex="-1"></a>to certify that the *purportedly* stationary trajectory $q$ is truly stationary.</span>
<span id="cb1-518"><a href="#cb1-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-519"><a href="#cb1-519" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-520"><a href="#cb1-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-521"><a href="#cb1-521" aria-hidden="true" tabindex="-1"></a><span class="fu">### What does it all mean?</span></span>
<span id="cb1-522"><a href="#cb1-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-523"><a href="#cb1-523" aria-hidden="true" tabindex="-1"></a>In the Lagrangian formalism, we are given a system with $q$ coordinates, and allowed to manipulate $\dot q$ however we want, in order to minimize a "cost" function $\int_0^T L(t, q, \dot q)dt$.</span>
<span id="cb1-524"><a href="#cb1-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-525"><a href="#cb1-525" aria-hidden="true" tabindex="-1"></a>In the Hamiltonian formalism, we are also given a market to trade with. We attempt to maximize profit by varying production, buying, and selling. However, the market simultaneously adjusts its prices $p$ in just the right way so that we are always indifferent about the market (if we are ever not indifferent, the market is in serious trouble -- it doesn't actually carry any real commodity!), so we never actually make any trade. The market has been in our heads all along, but its effects are real.</span>
<span id="cb1-526"><a href="#cb1-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-527"><a href="#cb1-527" aria-hidden="true" tabindex="-1"></a>Assuming this kind of double optimization (we against the market, and the market against us), the trajectory is uniquely determined by several possible specifications. We may fix it by $(t_0, q_0, p_0)$, or by $(t_0, q_0), (t, q)$, or by $(t_0, q_0, v_0)$, or perhaps more exotic constraints that mix up $t, q, p, v$.</span>
<span id="cb1-528"><a href="#cb1-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-529"><a href="#cb1-529" aria-hidden="true" tabindex="-1"></a>Ironically, the Hamiltonian equations of motion flow out naturally in this economic interpretation, with no fuss whatsoever. The Euler--Lagrange equations are derived only as an afterthought. This is exactly backwards compared to the usual way of teaching, where the EL equations are derived first, and the Hamiltonian equations are derived by an unmotivated "Let us define $H = \sum_i p_i q_i - L$ ...", followed by some clumsy and unjustified derivations.</span>
<span id="cb1-530"><a href="#cb1-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-531"><a href="#cb1-531" aria-hidden="true" tabindex="-1"></a>In classical control theory, the price vector $p$ is called "costate" since it is multiplied with the state $q$, and $\dot p= -\nabla_q H$ is called the "costate equation". The above methods can be generalized to account for constraints, yielding Pontryagin's maximum principle, among other results.</span>
<span id="cb1-532"><a href="#cb1-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-533"><a href="#cb1-533" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cyclic coordinates</span></span>
<span id="cb1-534"><a href="#cb1-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-535"><a href="#cb1-535" aria-hidden="true" tabindex="-1"></a>Given a system defined by a Lagrangian function $L(t, q, v)$, we say that it is **cyclic** in the coordinate $q_i$ if $L$ does not depend on $q_i$. By definition of</span>
<span id="cb1-536"><a href="#cb1-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-537"><a href="#cb1-537" aria-hidden="true" tabindex="-1"></a>$$H(t, q, p) = \max_v \left(\sum_i p_i v_i - L(t, q, v)\right)</span>
<span id="cb1-538"><a href="#cb1-538" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-539"><a href="#cb1-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-540"><a href="#cb1-540" aria-hidden="true" tabindex="-1"></a>we see that if $L$ does not depend on $q_i$, then $H$ also does not depend on $q_i$. Consequently, any optimal trajectory satisfies $\dot p_i = -\partial_{q_i} H = 0$. That is, $p_i$ is conserved -- **conservation of generalized momentum**.</span>
<span id="cb1-541"><a href="#cb1-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-542"><a href="#cb1-542" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bonus: Routhian mechanics</span></span>
<span id="cb1-543"><a href="#cb1-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-544"><a href="#cb1-544" aria-hidden="true" tabindex="-1"></a>Suppose that the market does not contain all commodities, but only the last $n$ commodities. That is, let $q_{1:N} = (q_{1:s}, q_{s+1:s+n})$, and only open markets on $q_{s+1:s+n}$. The optimal cash flow equation then gives us the "Routhian":</span>
<span id="cb1-545"><a href="#cb1-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-546"><a href="#cb1-546" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-547"><a href="#cb1-547" aria-hidden="true" tabindex="-1"></a>R(t, q, v_{1:s}, p_{s+1:N}) = \max_{v_{s+1:N}} \left(\sum_{i=s+1}^n p_i v_i - L(t, q, v)\right)</span>
<span id="cb1-548"><a href="#cb1-548" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-549"><a href="#cb1-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-550"><a href="#cb1-550" aria-hidden="true" tabindex="-1"></a>As before, the optimal control variables are $v_{s+1:N}^\ast = \mathop{\mathrm{arg\,max}}_{v_{s+1:N}} \left(\sum_{i=s+1}^n p_i v_i - L(t, q, v)\right)$.</span>
<span id="cb1-551"><a href="#cb1-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-552"><a href="#cb1-552" aria-hidden="true" tabindex="-1"></a>::: {#thm-routhian}</span>
<span id="cb1-553"><a href="#cb1-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-554"><a href="#cb1-554" aria-hidden="true" tabindex="-1"></a><span class="fu">## Routhian equations of motion</span></span>
<span id="cb1-555"><a href="#cb1-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-556"><a href="#cb1-556" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-557"><a href="#cb1-557" aria-hidden="true" tabindex="-1"></a>\begin{cases} </span>
<span id="cb1-558"><a href="#cb1-558" aria-hidden="true" tabindex="-1"></a>    \partial_t R &amp;= -\partial_t L <span class="sc">\\</span></span>
<span id="cb1-559"><a href="#cb1-559" aria-hidden="true" tabindex="-1"></a>    \frac{d}{dt} \partial_{v_i} R = \partial_{q_i}R \quad &amp; i \in 1:s<span class="sc">\\</span> </span>
<span id="cb1-560"><a href="#cb1-560" aria-hidden="true" tabindex="-1"></a>    \begin{cases} </span>
<span id="cb1-561"><a href="#cb1-561" aria-hidden="true" tabindex="-1"></a>    \dot q_i = \partial_{p_i} R <span class="sc">\\</span> \dot p_i = -\partial_{q_i} R </span>
<span id="cb1-562"><a href="#cb1-562" aria-hidden="true" tabindex="-1"></a>    \end{cases}\quad &amp; i\in s+1:N </span>
<span id="cb1-563"><a href="#cb1-563" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb1-564"><a href="#cb1-564" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-565"><a href="#cb1-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-566"><a href="#cb1-566" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-567"><a href="#cb1-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-568"><a href="#cb1-568" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Proof" collapse="false"}</span>
<span id="cb1-569"><a href="#cb1-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-570"><a href="#cb1-570" aria-hidden="true" tabindex="-1"></a>By the same argument as in Hotelling's lemma, we have</span>
<span id="cb1-571"><a href="#cb1-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-572"><a href="#cb1-572" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-573"><a href="#cb1-573" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb1-574"><a href="#cb1-574" aria-hidden="true" tabindex="-1"></a>    \partial_t R = -\partial_t L <span class="sc">\\</span></span>
<span id="cb1-575"><a href="#cb1-575" aria-hidden="true" tabindex="-1"></a>    \nabla_q R = -\nabla_q L <span class="sc">\\</span></span>
<span id="cb1-576"><a href="#cb1-576" aria-hidden="true" tabindex="-1"></a>    \nabla_{v_{1:s}} R = -\nabla_{v_{1:s}} L <span class="sc">\\</span></span>
<span id="cb1-577"><a href="#cb1-577" aria-hidden="true" tabindex="-1"></a>    \nabla_{p_{s+1 : N}} R = v^*_{s+1 : N}</span>
<span id="cb1-578"><a href="#cb1-578" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb1-579"><a href="#cb1-579" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-580"><a href="#cb1-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-581"><a href="#cb1-581" aria-hidden="true" tabindex="-1"></a>Plugging the 2-th and 3-th equations into the original Euler--Lagrange equations, we obtain </span>
<span id="cb1-582"><a href="#cb1-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-583"><a href="#cb1-583" aria-hidden="true" tabindex="-1"></a>$$\frac{d}{dt} \partial_{v_i} R = \partial_{q_i}R \quad i \in 1:s$$</span>
<span id="cb1-584"><a href="#cb1-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-585"><a href="#cb1-585" aria-hidden="true" tabindex="-1"></a>The 4-th equation gives</span>
<span id="cb1-586"><a href="#cb1-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-587"><a href="#cb1-587" aria-hidden="true" tabindex="-1"></a>$$\dot q_i =v_i^\ast = \partial_{p_i} R, \quad \forall i\in s+1:N$$</span>
<span id="cb1-588"><a href="#cb1-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-589"><a href="#cb1-589" aria-hidden="true" tabindex="-1"></a>For $i\in s+1:N$, we can obtain the price dynamic of the partial market by the no-arbitrage condition, giving</span>
<span id="cb1-590"><a href="#cb1-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-591"><a href="#cb1-591" aria-hidden="true" tabindex="-1"></a>$$\dot p_i = \partial_{q_i} L = -\partial_{q_i} R$$</span>
<span id="cb1-592"><a href="#cb1-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-593"><a href="#cb1-593" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-594"><a href="#cb1-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-595"><a href="#cb1-595" aria-hidden="true" tabindex="-1"></a>We see that the first $s$ equations look just like the EL equations, but the next $2n$ equations look just like the Hamiltonian equations. The Routhian equations make an awkward hybrid.</span>
<span id="cb1-596"><a href="#cb1-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-597"><a href="#cb1-597" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ... as a fundamental entity, the Routhian is a sterile hybrid, combining some of the features of both the Lagrangian and the Hamiltonian pictures. For the development of various formalisms of classical mechanics, the complete Hamiltonian formulation is more fruitful. </span></span>
<span id="cb1-598"><a href="#cb1-598" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span></span>
<span id="cb1-599"><a href="#cb1-599" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="co">[</span><span class="ot">@goldsteinClassicalMechanics2008, section 8.3</span><span class="co">]</span></span>
<span id="cb1-600"><a href="#cb1-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-601"><a href="#cb1-601" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Application to cyclic coordinates</span></span>
<span id="cb1-602"><a href="#cb1-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-603"><a href="#cb1-603" aria-hidden="true" tabindex="-1"></a>Though the Routhian equations are theoretically useless, they are useful for solving specific problems. For some worked examples of using the Routhian, see the <span class="co">[</span><span class="ot">Wikipedia page</span><span class="co">](https://en.wikipedia.org/wiki/Routhian_mechanics#Examples)</span>.</span>
<span id="cb1-604"><a href="#cb1-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-605"><a href="#cb1-605" aria-hidden="true" tabindex="-1"></a>While the Euler--Lagrangian equations are $N$ second-degree differential equations, the Hamiltonian equations are $2N$ first-degree differential equations. We are essentially trading derivatives for equation numbers.</span>
<span id="cb1-606"><a href="#cb1-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-607"><a href="#cb1-607" aria-hidden="true" tabindex="-1"></a>Though the EL equations and the Hamiltonian equations are philosophically different, for solving particular problems, they often end up giving the same equations anyway. Specifically, if we are solving the Hamiltonian equations for a concrete example, by eliminating the variables $p$, we often end up right back to the Euler--Lagrange equations. This would be quite the detour, and if there are cyclic coordinates, the Routhian could save us some trouble.</span>
<span id="cb1-608"><a href="#cb1-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-609"><a href="#cb1-609" aria-hidden="true" tabindex="-1"></a>If we have a system that is cyclic in the last $n$ coordinates, then since $\nabla_q R = -\nabla_q L$, its Routhian satisfies $\partial_{q_i} R = 0$ for the last $n$ coordinates too. Then we find that the Routhian equations become:</span>
<span id="cb1-610"><a href="#cb1-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-611"><a href="#cb1-611" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-612"><a href="#cb1-612" aria-hidden="true" tabindex="-1"></a>\begin{cases} </span>
<span id="cb1-613"><a href="#cb1-613" aria-hidden="true" tabindex="-1"></a>\frac{d}{dt} \partial_{v_i} R = \partial_{q_i}R \quad &amp; i \in 1:s<span class="sc">\\</span> </span>
<span id="cb1-614"><a href="#cb1-614" aria-hidden="true" tabindex="-1"></a>\begin{cases} </span>
<span id="cb1-615"><a href="#cb1-615" aria-hidden="true" tabindex="-1"></a>\dot q_i = \partial_{p_i} R <span class="sc">\\</span>  p_i = p_i(0)</span>
<span id="cb1-616"><a href="#cb1-616" aria-hidden="true" tabindex="-1"></a>\end{cases}\quad &amp; i\in s+1:N </span>
<span id="cb1-617"><a href="#cb1-617" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb1-618"><a href="#cb1-618" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-619"><a href="#cb1-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-620"><a href="#cb1-620" aria-hidden="true" tabindex="-1"></a>giving us $n$ first-degree equations and $N-n$ second-degree equations. If we were to start with the Hamiltonian equations of motion, we would get</span>
<span id="cb1-621"><a href="#cb1-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-622"><a href="#cb1-622" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-623"><a href="#cb1-623" aria-hidden="true" tabindex="-1"></a>\begin{cases} </span>
<span id="cb1-624"><a href="#cb1-624" aria-hidden="true" tabindex="-1"></a>\dot q_i = \partial_{p_i} H <span class="sc">\\</span>  p_i = p_i(0)</span>
<span id="cb1-625"><a href="#cb1-625" aria-hidden="true" tabindex="-1"></a>\end{cases}\quad i\in s+1:N </span>
<span id="cb1-626"><a href="#cb1-626" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-627"><a href="#cb1-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-628"><a href="#cb1-628" aria-hidden="true" tabindex="-1"></a>by the same reasoning, and then laboriously eliminate the variables $p_i$ for $i \in 1:s$, and end up with $s$ second-degree differential equations, often exactly the same as the first $s$ Routhian equations:</span>
<span id="cb1-629"><a href="#cb1-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-630"><a href="#cb1-630" aria-hidden="true" tabindex="-1"></a>$$\frac{d}{dt} \partial_{v_i} R = \partial_{q_i}R \quad i \in 1:s$$</span>
<span id="cb1-631"><a href="#cb1-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-632"><a href="#cb1-632" aria-hidden="true" tabindex="-1"></a>This is how the Routhian saves us some effort in practical calculations. It is useful in this way, and in this way only.</span>
<span id="cb1-633"><a href="#cb1-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-634"><a href="#cb1-634" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bonus: Higher-order Lagrangians and Hamiltonians</span></span>
<span id="cb1-635"><a href="#cb1-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-636"><a href="#cb1-636" aria-hidden="true" tabindex="-1"></a>What happens if we use a Lagrangian with higher-order derivatives? It turns out that even in this case, we can still use economic reasoning to derive its Hamiltonian and Euler--Lagrangian equations</span>
<span id="cb1-637"><a href="#cb1-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-638"><a href="#cb1-638" aria-hidden="true" tabindex="-1"></a>::: {#exr-higher-order-hamiltonian}</span>
<span id="cb1-639"><a href="#cb1-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-640"><a href="#cb1-640" aria-hidden="true" tabindex="-1"></a>Read the following sections, then generalize the derivation to $n$-th-order derivatives.</span>
<span id="cb1-641"><a href="#cb1-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-642"><a href="#cb1-642" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-643"><a href="#cb1-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-644"><a href="#cb1-644" aria-hidden="true" tabindex="-1"></a>This construction of Hamiltonians from higher-order Lagrangians is often called **Ostrogradsky theorem** or **Ostrogradsky instability**, because Ostrogradsky published it in 1850 [@ostrogradskyMemoiresEquationsDifferentielles1850] after seeing Hamilton's paper of 1833 [@hamiltonGeneralMethodExpressing1833]. He did not note its implications for instability, which was first noted by Pais and Uhlenbeck in 1950 [@paisFieldTheoriesNonLocalized1950]. For this reason, it's also called the **Pais--Uhlenbeck model**.</span>
<span id="cb1-645"><a href="#cb1-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-646"><a href="#cb1-646" aria-hidden="true" tabindex="-1"></a><span class="fu">### When Lagrangian also depends on acceleration</span></span>
<span id="cb1-647"><a href="#cb1-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-648"><a href="#cb1-648" aria-hidden="true" tabindex="-1"></a>When the Lagrangian depends not just on position and velocity, but also acceleration, the total cost to be optimized is:</span>
<span id="cb1-649"><a href="#cb1-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-650"><a href="#cb1-650" aria-hidden="true" tabindex="-1"></a>$$S(q) := \int L(t, q^{(0)}, q^{(1)}, q^{(2)})dt$$</span>
<span id="cb1-651"><a href="#cb1-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-652"><a href="#cb1-652" aria-hidden="true" tabindex="-1"></a>where $q^{(n)}$ is a symbol that *suggests* itself to be the $n$-th time-derivative of the optimal trajectory $q$, although it is actually defined for any tuple of real numbers, even when we don't have $q^{(1)}(t) = \frac{d}{dt}q^{(0)}(t)$.</span>
<span id="cb1-653"><a href="#cb1-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-654"><a href="#cb1-654" aria-hidden="true" tabindex="-1"></a>Our previous method, which is to open a market on position $q$, fails for two reasons:</span>
<span id="cb1-655"><a href="#cb1-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-656"><a href="#cb1-656" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The producer cannot optimize its velocity, because now velocity is no longer a control variable. Now, both position and velocity are state variables, and only acceleration is a control variable.</span>
<span id="cb1-657"><a href="#cb1-657" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>The producer cannot buy and sell velocity, so it has no price signal to optimize its acceleration (how fast it produces velocity).</span>
<span id="cb1-658"><a href="#cb1-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-659"><a href="#cb1-659" aria-hidden="true" tabindex="-1"></a>If the market fails, make it bigger: allow the market to buy and sell not just position, but also velocity.</span>
<span id="cb1-660"><a href="#cb1-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-661"><a href="#cb1-661" aria-hidden="true" tabindex="-1"></a>We open a market of both positions and velocities. The price vector of positions is $p^{(0)}$ and the price vector of velocities is $p^{(1)}$. Then, the maximal profit flow is</span>
<span id="cb1-662"><a href="#cb1-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-663"><a href="#cb1-663" aria-hidden="true" tabindex="-1"></a>$$H(t,  q^{(0)}, q^{(1)}, p^{(0)}, p^{(1)}) = \max_{ q^{(2)}} (\langle p^{(0)} , q^{(1)}\rangle + \langle p^{(1)} , q^{(2)}\rangle - L(t, q^{(0)}, q^{(1)}, q^{(2)}))$$</span>
<span id="cb1-664"><a href="#cb1-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-665"><a href="#cb1-665" aria-hidden="true" tabindex="-1"></a>and the optimal production plan is</span>
<span id="cb1-666"><a href="#cb1-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-667"><a href="#cb1-667" aria-hidden="true" tabindex="-1"></a>$$q^{(2)\ast} = \mathop{\mathrm{arg\,max}}_{ q^{(2)}}(\langle p^{(0)} , q^{(1)}\rangle + \langle p^{(1)} , q^{(2)}\rangle - L)$$</span>
<span id="cb1-668"><a href="#cb1-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-669"><a href="#cb1-669" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ostrogradsky instability and the anthropic principle</span></span>
<span id="cb1-670"><a href="#cb1-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-671"><a href="#cb1-671" aria-hidden="true" tabindex="-1"></a>We will show that the quantity does deserve the name of "Hamiltonian":</span>
<span id="cb1-672"><a href="#cb1-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-673"><a href="#cb1-673" aria-hidden="true" tabindex="-1"></a>$$H(t,  q^{(0)}, q^{(1)}, p^{(0)}, p^{(1)}) = \langle p^{(0)} , q^{(1)}\rangle + \max_{ q^{(2)}} (\langle p^{(1)} , q^{(2)}\rangle - L(t, q^{(0)}, q^{(1)}, q^{(2)}))$$</span>
<span id="cb1-674"><a href="#cb1-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-675"><a href="#cb1-675" aria-hidden="true" tabindex="-1"></a>Assuming that, we have a serious problem. Consider an oscillator with higher-order derivatives. Since its Hamiltonian contains a term $\langle p^{(0)} , q^{(1)}\rangle$, it is linear with respect to $p^{(0)}$ and $q^{(1)}$. In other words, it can have arbitrarily *low* energy states.</span>
<span id="cb1-676"><a href="#cb1-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-677"><a href="#cb1-677" aria-hidden="true" tabindex="-1"></a>Now, this could be alright if we live in a classical world, but we live in a world described by quantum field theory. In QFT, the world is a giant network of oscillators. If a quantum oscillator has higher-order derivatives, then its energy levels can go both infinitely high and low. If there is any coupling at all between its energy levels, it would instantly evaporates into infinitely many positive and negative energy particles, in a blaze of vacuum decay.</span>
<span id="cb1-678"><a href="#cb1-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-679"><a href="#cb1-679" aria-hidden="true" tabindex="-1"></a>This is an anthropic explanation for "Why Newton's laws?" Newton's laws, because the Lagrangian depends on only up to velocity. Why? Because if it also depends on acceleration, the vacuum would decay <span class="co">[</span><span class="ot">@swansonOstrogradskiInstabilityWhy2022</span><span class="co">]</span>. We can similarly explain anthropically why space has 3 dimensions, and time has 1 dimension.</span>
<span id="cb1-680"><a href="#cb1-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-681"><a href="#cb1-681" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; With more or less than one time dimension, the partial differential equations of nature would lack the hyperbolicity property that enables observers to make predictions. In a space with more than three dimensions, there can be no traditional atoms and perhaps no stable structures. A space with less than three dimensions allows no gravitational force and may be too simple and barren to contain observers.</span></span>
<span id="cb1-682"><a href="#cb1-682" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span></span>
<span id="cb1-683"><a href="#cb1-683" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="co">[</span><span class="ot">@tegmarkDimensionalitySpacetime1997</span><span class="co">]</span><span class="at">.</span></span>
<span id="cb1-684"><a href="#cb1-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-685"><a href="#cb1-685" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hamiltonian equations</span></span>
<span id="cb1-686"><a href="#cb1-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-687"><a href="#cb1-687" aria-hidden="true" tabindex="-1"></a>We can prove the Hotelling's lemma for this Hamiltonian, using the same no-arbitrage argument as before:</span>
<span id="cb1-688"><a href="#cb1-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-689"><a href="#cb1-689" aria-hidden="true" tabindex="-1"></a>$$\begin{cases}     </span>
<span id="cb1-690"><a href="#cb1-690" aria-hidden="true" tabindex="-1"></a>    \partial_t H = -\partial_t L <span class="sc">\\</span>  </span>
<span id="cb1-691"><a href="#cb1-691" aria-hidden="true" tabindex="-1"></a>    \nabla_{q^{(0)}} H = -\nabla_{q^{(0)}} L <span class="sc">\\</span>     </span>
<span id="cb1-692"><a href="#cb1-692" aria-hidden="true" tabindex="-1"></a>    \nabla_{q^{(1)}} H = p^{(0)}-\nabla_{q^{(1)}} L <span class="sc">\\</span>     </span>
<span id="cb1-693"><a href="#cb1-693" aria-hidden="true" tabindex="-1"></a>    \nabla_{p^{(0)}} H = q^{(1)} <span class="sc">\\</span>     </span>
<span id="cb1-694"><a href="#cb1-694" aria-hidden="true" tabindex="-1"></a>    \nabla_{p^{(1)}} H = q^{(2)\ast} </span>
<span id="cb1-695"><a href="#cb1-695" aria-hidden="true" tabindex="-1"></a>\end{cases}$$</span>
<span id="cb1-696"><a href="#cb1-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-697"><a href="#cb1-697" aria-hidden="true" tabindex="-1"></a>Along an optimal trajectory, the producer always chooses $\dot q^{(1)} = q^{(2)\ast}$, and has no choice in $\dot q^{(0)} = q^{(1)}$, so we have two equations of motion:</span>
<span id="cb1-698"><a href="#cb1-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-699"><a href="#cb1-699" aria-hidden="true" tabindex="-1"></a>$$\begin{cases}     </span>
<span id="cb1-700"><a href="#cb1-700" aria-hidden="true" tabindex="-1"></a>\dot q^{(1)} = q^{(2)\ast} = \nabla_{p^{(1)}} H<span class="sc">\\</span>    </span>
<span id="cb1-701"><a href="#cb1-701" aria-hidden="true" tabindex="-1"></a>\dot q^{(0)} = q^{(1)} = \nabla_{p^{(0)}} H </span>
<span id="cb1-702"><a href="#cb1-702" aria-hidden="true" tabindex="-1"></a>\end{cases}$$</span>
<span id="cb1-703"><a href="#cb1-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-704"><a href="#cb1-704" aria-hidden="true" tabindex="-1"></a>The market must adjust its prices by the no-arbitrage condition, as before. If we inflict a position shock of $\delta q^{(0)}$, then by no-arbitrage, selling it now or later is equally (up to order $\delta^2$) profitable:</span>
<span id="cb1-705"><a href="#cb1-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-706"><a href="#cb1-706" aria-hidden="true" tabindex="-1"></a>$$\langle p^{(0)} , \delta q^{(0)}\rangle = \langle p^{(0)} + \dot p^{(0)} \delta t , \delta q^{(0)}\rangle - \langle \nabla_{q^{(0)}} L , \delta q^{(0)}\rangle \delta t$$</span>
<span id="cb1-707"><a href="#cb1-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-708"><a href="#cb1-708" aria-hidden="true" tabindex="-1"></a>yielding $\dot p^{(0)} = \nabla_{q^{(0)}} L = -\nabla_{q^{(0)}} H$.</span>
<span id="cb1-709"><a href="#cb1-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-710"><a href="#cb1-710" aria-hidden="true" tabindex="-1"></a>For the last equation of motion, inflict a velocity shock of $\delta q^{(1)}$. The effect of the shock include both its effect on $q^{(0)}$ and $L$, thus the no-arbitrage equation states:</span>
<span id="cb1-711"><a href="#cb1-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-712"><a href="#cb1-712" aria-hidden="true" tabindex="-1"></a>$$\underbrace{\langle p^{(1)} , \delta q^{(1)}\rangle}_{\text{selling now}} =  \underbrace{\langle p^{(1)} + \dot p^{(1)} \delta t , \delta q^{(1)}\rangle}_{\text{selling later}} + \underbrace{\langle p^{(0)} + \dot p^{(0)} \delta t , \delta q^{(1)}\delta t\rangle}_{\text{profit from extra }p^{(0)}} - \underbrace{\langle \nabla_{q^{(1)}} L , \delta q^{(1)}\rangle \delta t}_{\text{cost from holding extra }p^{(1)}}$$</span>
<span id="cb1-713"><a href="#cb1-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-714"><a href="#cb1-714" aria-hidden="true" tabindex="-1"></a>which yields the last equation $\dot p^{(1)} = \nabla_{q^{(1)}} L - p^{(0)} = -\nabla_{q^{(1)}} H$.</span>
<span id="cb1-715"><a href="#cb1-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-716"><a href="#cb1-716" aria-hidden="true" tabindex="-1"></a>In summary, we have </span>
<span id="cb1-717"><a href="#cb1-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-718"><a href="#cb1-718" aria-hidden="true" tabindex="-1"></a>::: {#thm-higher-hem}</span>
<span id="cb1-719"><a href="#cb1-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-720"><a href="#cb1-720" aria-hidden="true" tabindex="-1"></a><span class="fu">## higher-order Hamiltonian equations of motion:</span></span>
<span id="cb1-721"><a href="#cb1-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-722"><a href="#cb1-722" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-723"><a href="#cb1-723" aria-hidden="true" tabindex="-1"></a>\begin{cases}     </span>
<span id="cb1-724"><a href="#cb1-724" aria-hidden="true" tabindex="-1"></a>    \dot q^{(1)} = \nabla_{p^{(1)}} H<span class="sc">\\</span>     </span>
<span id="cb1-725"><a href="#cb1-725" aria-hidden="true" tabindex="-1"></a>    \dot q^{(0)} = \nabla_{p^{(0)}} H <span class="sc">\\</span>     </span>
<span id="cb1-726"><a href="#cb1-726" aria-hidden="true" tabindex="-1"></a>    \dot p^{(0)} = -\nabla_{q^{(0)}} H <span class="sc">\\</span>     </span>
<span id="cb1-727"><a href="#cb1-727" aria-hidden="true" tabindex="-1"></a>    \dot p^{(1)} = -\nabla_{q^{(1)}} H  </span>
<span id="cb1-728"><a href="#cb1-728" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb1-729"><a href="#cb1-729" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-730"><a href="#cb1-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-731"><a href="#cb1-731" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-732"><a href="#cb1-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-733"><a href="#cb1-733" aria-hidden="true" tabindex="-1"></a><span class="fu">### Euler--Lagrange equations</span></span>
<span id="cb1-734"><a href="#cb1-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-735"><a href="#cb1-735" aria-hidden="true" tabindex="-1"></a>In order to obtain the Euler--Lagrange equations of motion, we need to work backwards from the Hamiltonian equations of motion as before.</span>
<span id="cb1-736"><a href="#cb1-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-737"><a href="#cb1-737" aria-hidden="true" tabindex="-1"></a>From the Hamiltonian, we can go back to the Lagrangian by inverting the convex transform:</span>
<span id="cb1-738"><a href="#cb1-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-739"><a href="#cb1-739" aria-hidden="true" tabindex="-1"></a>$$L(t, q^{(0)}, q^{(1)}, q^{(2)})  = \max_{p^{(0)} ,p^{(1)}} (\langle p^{(0)} , q^{(1)}\rangle + \langle p^{(1)} , q^{(2)}\rangle - H(t,  q^{(0)}, q^{(1)}, p^{(0)}, p^{(1)}))$$</span>
<span id="cb1-740"><a href="#cb1-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-741"><a href="#cb1-741" aria-hidden="true" tabindex="-1"></a>Here we are given a hint of the troubles ahead. Since $H$ is linear in $p^{(1)}$:</span>
<span id="cb1-742"><a href="#cb1-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-743"><a href="#cb1-743" aria-hidden="true" tabindex="-1"></a>$$H(t,  q^{(0)}, q^{(1)}, p^{(0)}, p^{(1)}) = \langle p^{(0)} , q^{(1)}\rangle + \max_{ q^{(2)}} (\langle p^{(1)} , q^{(2)}\rangle - L(t, q^{(0)}, q^{(1)}, q^{(2)}))$$</span>
<span id="cb1-744"><a href="#cb1-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-745"><a href="#cb1-745" aria-hidden="true" tabindex="-1"></a>there is no way to fix $p^{(1)}$ in the inverse transform! In detail, we plug the equation for $H$ into the equation for $L$, to get</span>
<span id="cb1-746"><a href="#cb1-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-747"><a href="#cb1-747" aria-hidden="true" tabindex="-1"></a>$$L(t, q^{(0)}, q^{(1)}, q^{(2)}) = \max_{p^{(0)} ,p^{(1)}} (\langle p^{(1)} , q^{(2)}\rangle - \max_{ q^{(2)}} (\langle p^{(1)} , q^{(2)}\rangle - L(t, q^{(0)}, q^{(1)}, q^{(2)}))$$</span>
<span id="cb1-748"><a href="#cb1-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-749"><a href="#cb1-749" aria-hidden="true" tabindex="-1"></a>and we see that there is *no* optimality constraint on $p^{(0)}$. This is a hint of instabilities ahead.</span>
<span id="cb1-750"><a href="#cb1-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-751"><a href="#cb1-751" aria-hidden="true" tabindex="-1"></a>Differentiating $L$, we get</span>
<span id="cb1-752"><a href="#cb1-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-753"><a href="#cb1-753" aria-hidden="true" tabindex="-1"></a>$$\begin{cases} </span>
<span id="cb1-754"><a href="#cb1-754" aria-hidden="true" tabindex="-1"></a>\partial_t L = -\partial_t H<span class="sc">\\</span> </span>
<span id="cb1-755"><a href="#cb1-755" aria-hidden="true" tabindex="-1"></a>\nabla_{q^{(0)}}L = -\nabla_{q^{(0)}}H <span class="sc">\\</span> </span>
<span id="cb1-756"><a href="#cb1-756" aria-hidden="true" tabindex="-1"></a>\nabla_{q^{(1)}}L = p^{(0)} - \nabla_{q^{(1)}}H <span class="sc">\\</span> </span>
<span id="cb1-757"><a href="#cb1-757" aria-hidden="true" tabindex="-1"></a>\nabla_{q^{(2)}}L = p^{(1)\ast}  </span>
<span id="cb1-758"><a href="#cb1-758" aria-hidden="true" tabindex="-1"></a>\end{cases}$$</span>
<span id="cb1-759"><a href="#cb1-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-760"><a href="#cb1-760" aria-hidden="true" tabindex="-1"></a>Now, along the optimal trajectory, we must have $\nabla_{q^{(2)}}L = p^{(1)\ast}$, so taking its time-derivative, we get</span>
<span id="cb1-761"><a href="#cb1-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-762"><a href="#cb1-762" aria-hidden="true" tabindex="-1"></a>$$\frac{d}{dt}\nabla_{q^{(2)}}L = \dot p^{(1)} = -\nabla_{q^{(1)}}H = \nabla_{q^{(1)}}L - p^{(0)}$$</span>
<span id="cb1-763"><a href="#cb1-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-764"><a href="#cb1-764" aria-hidden="true" tabindex="-1"></a>Take another time-derivative, to obtain the Euler--Lagrange equations of motion:</span>
<span id="cb1-765"><a href="#cb1-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-766"><a href="#cb1-766" aria-hidden="true" tabindex="-1"></a>$$\sum_{i=0}^2\left(-\frac{d}{d t}\right)^i (\nabla_{q^{(i)}} L ) =0$$</span>
<span id="cb1-767"><a href="#cb1-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-768"><a href="#cb1-768" aria-hidden="true" tabindex="-1"></a>The generalization to $L(t, q^{(0)}, ..., q^{(N-1)})$ is immediate. It can be derived by a similar argument through the market economy.</span>
<span id="cb1-769"><a href="#cb1-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-770"><a href="#cb1-770" aria-hidden="true" tabindex="-1"></a><span class="fu">### An unstable higher-order oscillator</span></span>
<span id="cb1-771"><a href="#cb1-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-772"><a href="#cb1-772" aria-hidden="true" tabindex="-1"></a>It is beyond our scope to discuss Ostrogradsky instability in quantum field theory, however, we can have a taste of it here. Consider the oscillator perturbed by $\epsilon$:</span>
<span id="cb1-773"><a href="#cb1-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-774"><a href="#cb1-774" aria-hidden="true" tabindex="-1"></a>$$L = \frac 12 m\dot x^2 - \frac 12 kx^2 - \frac 12 \epsilon \ddot x^2$$</span>
<span id="cb1-775"><a href="#cb1-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-776"><a href="#cb1-776" aria-hidden="true" tabindex="-1"></a>Its EL equation is</span>
<span id="cb1-777"><a href="#cb1-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-778"><a href="#cb1-778" aria-hidden="true" tabindex="-1"></a>$$\epsilon x^{(4)} + m\ddot x + kx = 0$$</span>
<span id="cb1-779"><a href="#cb1-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-780"><a href="#cb1-780" aria-hidden="true" tabindex="-1"></a>a linear order-4 equation, so its solutions are of the form $x = \sum_{i=1}^4 a_i e^{z_i t}$, where $z_1, z_2, z_3, z_4$ are its fundamental (complex) frequencies. Plug them in the equation and solve it simply:</span>
<span id="cb1-781"><a href="#cb1-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-782"><a href="#cb1-782" aria-hidden="true" tabindex="-1"></a>$$z = \pm \sqrt{-\frac{1}{2\epsilon} (m \pm \sqrt{m^2 - 4\epsilon k})}$$</span>
<span id="cb1-783"><a href="#cb1-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-784"><a href="#cb1-784" aria-hidden="true" tabindex="-1"></a>At small $|\epsilon|$ limit, we have</span>
<span id="cb1-785"><a href="#cb1-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-786"><a href="#cb1-786" aria-hidden="true" tabindex="-1"></a>$$z \approx \pm i\sqrt{\frac km}, \pm\sqrt{-\frac m\epsilon}$$</span>
<span id="cb1-787"><a href="#cb1-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-788"><a href="#cb1-788" aria-hidden="true" tabindex="-1"></a>and so if $\epsilon &lt; 0$, one of the modes is exponentially growing at rate $\sqrt{m/|\epsilon|}$.</span>
<span id="cb1-789"><a href="#cb1-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-790"><a href="#cb1-790" aria-hidden="true" tabindex="-1"></a>If $\epsilon &gt; 0$, then the oscillator survives, with two modes of oscillation of frequency $\sqrt{\frac km}$ and $\sqrt{\frac{m}{\epsilon}}$. When there is viscous force, however, this delicate stability is destroyed. <span class="co">[</span><span class="ot">@nesterenkoInstabilityClassicalDynamics2007</span><span class="co">]</span></span>
<span id="cb1-791"><a href="#cb1-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-792"><a href="#cb1-792" aria-hidden="true" tabindex="-1"></a>The equation of motion in this case is </span>
<span id="cb1-793"><a href="#cb1-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-794"><a href="#cb1-794" aria-hidden="true" tabindex="-1"></a>$$\epsilon x^{(4)} + m\ddot x + \gamma \dot x + kx = 0$$</span>
<span id="cb1-795"><a href="#cb1-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-796"><a href="#cb1-796" aria-hidden="true" tabindex="-1"></a>The algebraic equation to solve is now $\epsilon z^4 - mz^2 + i\gamma z + k = 0$.</span>
<span id="cb1-797"><a href="#cb1-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-798"><a href="#cb1-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-799"><a href="#cb1-799" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hamilton--Jacobi equation</span></span>
<span id="cb1-800"><a href="#cb1-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-801"><a href="#cb1-801" aria-hidden="true" tabindex="-1"></a>Consider again the integral of Lagrangian: $\int L dt$. If we fix the starting point $(t_0, q_0)$ and the ending point $(t, q)$, then in general there can be a countable number of paths that connect both points. This is a serious problem, but we are saved by the fact that these paths are separated, in the sense that around each path $\gamma$, there is a small neighborhood, in which there exists no other path $\gamma$ that connects the two points $(t_0, q_0), (t, q)$.</span>
<span id="cb1-802"><a href="#cb1-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-803"><a href="#cb1-803" aria-hidden="true" tabindex="-1"></a>As a prototype, consider a billiard ball in a circular table. </span>
<span id="cb1-804"><a href="#cb1-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-805"><a href="#cb1-805" aria-hidden="true" tabindex="-1"></a><span class="fu">### Billiards in a circular board</span></span>
<span id="cb1-806"><a href="#cb1-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-807"><a href="#cb1-807" aria-hidden="true" tabindex="-1"></a>When both $q_0, q$ are the center of the billiard table, then there are $S^1 \times \N$ ways to go from $q_0$ to $q$ over the interval $<span class="co">[</span><span class="ot">t_0,t</span><span class="co">]</span>$. Here, $S^1$ denotes the circle of possible directions, and $\N$ denotes the discrete number of starting speeds: $\frac{2R}{t-t_0}, \frac{4R}{t-t_0}, \dots$.</span>
<span id="cb1-808"><a href="#cb1-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-809"><a href="#cb1-809" aria-hidden="true" tabindex="-1"></a>When not both of them are in the center, then there are only in general $\N$ ways to go from $q_0$ to $q$ over the interval $<span class="co">[</span><span class="ot">t_0,t</span><span class="co">]</span>$.</span>
<span id="cb1-810"><a href="#cb1-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-811"><a href="#cb1-811" aria-hidden="true" tabindex="-1"></a>Consider a billiard ball in a circular (not elliptical) table. Let $q, q_0$ be any two points inside the table, not both on the center, and $t_0 &lt; t$ be two moments in time, then there are a countable infinity of possible trajectories that reach $(t, q)$ from $(t_0, q_0)$.</span>
<span id="cb1-812"><a href="#cb1-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-813"><a href="#cb1-813" aria-hidden="true" tabindex="-1"></a>There are two ways to see this visually, a particle way and a wave way.</span>
<span id="cb1-814"><a href="#cb1-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-815"><a href="#cb1-815" aria-hidden="true" tabindex="-1"></a>For the particle way, define:</span>
<span id="cb1-816"><a href="#cb1-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-817"><a href="#cb1-817" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>the billiard's starting angle is $\theta$, with $\theta$ chosen such that when $\theta = 0$, the billiard would move on a diameter of the table.</span>
<span id="cb1-818"><a href="#cb1-818" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$l(\theta, n)$ is the oriented line segment that starts at the point where the billiard's hits the table for the $n$-th time, and ends at the point where it hits for the $(n+1)$-th time.</span>
<span id="cb1-819"><a href="#cb1-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-820"><a href="#cb1-820" aria-hidden="true" tabindex="-1"></a>For any $n = 1, 2, ...$, as $\theta$ moves from $\theta = 0$ to $\theta = \pi$, the line $l(\theta, n)$ smoothly varies from the diameter in one direction to the diameter in the opposite direction. Now, if you take a diameter in the circle, and smoothly turn it around by $180^\circ$, then no matter how much you shift the line around in the mean time, you are forced to sweep it over every point at least once.<span class="ot">[^billiard-intuition-nail]</span> Consequently, every point can be reached after $n$ reflections, for any positive integer $n$</span>
<span id="cb1-821"><a href="#cb1-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-822"><a href="#cb1-822" aria-hidden="true" tabindex="-1"></a><span class="ot">[^billiard-intuition-nail]: </span>If you want a hands-on approach, imagine hammering in a nail at some point $q$ in the circle, and putting a long stick on the diameter. Now grab the stick and start turning it around. There is no way for you to turn it by $180^\circ$ without hitting the nail at some time.</span>
<span id="cb1-823"><a href="#cb1-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-824"><a href="#cb1-824" aria-hidden="true" tabindex="-1"></a>For the wave way, imagine simultaneously shooting out a billiard in every direction with constant speed, and watch the "wavefront" of billiards evolve. The wavefront is reflected by the table edges and assumes increasingly complicated shapes, but it remains a closed curve (with possible self-intersections). As the closed curve reverberates across the table again and again, it sweeps across every point in the table again and again at discrete intervals.</span>
<span id="cb1-825"><a href="#cb1-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-826"><a href="#cb1-826" aria-hidden="true" tabindex="-1"></a>However, there is no way to smoothly reach one trajectory from any other -- you either have to make a discrete jump in how hard you strike the billiard ball, or in which direction you strike. This contrasts with the case with both $q, q_0$ at the center, where you can smoothly vary your striking angle while keeping the same striking force.</span>
<span id="cb1-827"><a href="#cb1-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-828"><a href="#cb1-828" aria-hidden="true" tabindex="-1"></a>Similarly, for a table with smooth boundary, for almost all point-pairs in the table, there are also a countable infinity of trajectories between them. We must say "almost all" to exclude singular cases such as the two focal points of an ellipse, where there is a whole continuum of trajectories between them.<span class="ot">[^dynamical-billiards]</span></span>
<span id="cb1-829"><a href="#cb1-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-830"><a href="#cb1-830" aria-hidden="true" tabindex="-1"></a><span class="ot">[^dynamical-billiards]: </span>Exactly counting the singular cases, and studying polygonal, or even non-convex tables, is an ongoing research program, with the name of "dynamical billiard flow".</span>
<span id="cb1-831"><a href="#cb1-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-832"><a href="#cb1-832" aria-hidden="true" tabindex="-1"></a>What is the general lesson for defining $S$? In general, we also need to fix a particular optimal path $\tilde\gamma$, and only consider optimal paths that are in a small neighborhood of $\tilde \gamma$. This is the same idea as selecting a branch cut when dealing with multi-valued functions like the complex logarithm.</span>
<span id="cb1-833"><a href="#cb1-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-834"><a href="#cb1-834" aria-hidden="true" tabindex="-1"></a>Why are we so concerned with reflections? Read on!</span>
<span id="cb1-835"><a href="#cb1-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-836"><a href="#cb1-836" aria-hidden="true" tabindex="-1"></a><span class="al">![The two ways to find trajectories from $q_0$ to $q$. The particle way involves sending out rays from $q_0$, reflecting off the walls of the table, until a ray hits $q$. The wave way involves sending out an expanding wavefront from $q_0$, rippling through the table, passing over $q$ again and again. The rays are perpendicular to the wavefront in this case.](figure/waves_rays_circle_table.jpg)</span>{width=50% fig-align="center"}</span>
<span id="cb1-837"><a href="#cb1-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-838"><a href="#cb1-838" aria-hidden="true" tabindex="-1"></a><span class="al">![Similarly, in a rectangular billiard table, there are infinitely many possible ways to go from one point to another, but one cannot go from one way to another continuously.](figure/square_billiard.jpg)</span>{width=80% fig-align="center"}</span>
<span id="cb1-839"><a href="#cb1-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-840"><a href="#cb1-840" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hamilton's principal function</span></span>
<span id="cb1-841"><a href="#cb1-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-842"><a href="#cb1-842" aria-hidden="true" tabindex="-1"></a>Consider a problem in traveling: Given a starting spacetime $(t_0, q_0)$ and an ending spacetime $(t, q)$, what is the lowest cost of traveling between them? We want to define it as:</span>
<span id="cb1-843"><a href="#cb1-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-844"><a href="#cb1-844" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-845"><a href="#cb1-845" aria-hidden="true" tabindex="-1"></a>S(t, q; t_0, q_0) = \int_{t_0}^t L(\tau, \gamma(\tau), \dot\gamma(\tau))d\tau</span>
<span id="cb1-846"><a href="#cb1-846" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb1-847"><a href="#cb1-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-848"><a href="#cb1-848" aria-hidden="true" tabindex="-1"></a>where $\gamma(\tau)$ is the *unique* path from $(t_0, q_0)$ to $(t, q)$. However, as we saw in the case of circular billiards, we don't have a unique path in general. Therefore, we should be a bit more careful.</span>
<span id="cb1-849"><a href="#cb1-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-850"><a href="#cb1-850" aria-hidden="true" tabindex="-1"></a>First, we select a prototypical path $\gamma_{prototype}$. Next, we smoothly vary $\gamma_{prototype}$ until it becomes some path $\gamma$ that goes from $(t_0, q_0)$ to $(t, q)$. Finally, define the Hamilton's principal function using this particular $\gamma$. The construction is a bit awkward, but it would allow us to avoid the non-uniqueness problem.</span>
<span id="cb1-851"><a href="#cb1-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-852"><a href="#cb1-852" aria-hidden="true" tabindex="-1"></a>Thus, we define the **Hamilton's principal function**:</span>
<span id="cb1-853"><a href="#cb1-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-854"><a href="#cb1-854" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-855"><a href="#cb1-855" aria-hidden="true" tabindex="-1"></a>S(t, q; t_0, q_0) = \int_{t_0}^t L(\tau, \gamma(\tau), \dot\gamma(\tau))d\tau</span>
<span id="cb1-856"><a href="#cb1-856" aria-hidden="true" tabindex="-1"></a>$$ {#eq-hpf}</span>
<span id="cb1-857"><a href="#cb1-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-858"><a href="#cb1-858" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hamilton--Jacobi equation</span></span>
<span id="cb1-859"><a href="#cb1-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-860"><a href="#cb1-860" aria-hidden="true" tabindex="-1"></a>For all nice enough Lagrangian $L$, Hamilton's principal function $S$ is differentiable with respect to $(t, q)$, so we will study its differential equation.</span>
<span id="cb1-861"><a href="#cb1-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-862"><a href="#cb1-862" aria-hidden="true" tabindex="-1"></a>Let's first consider the easy case: we simply let the trajectory "run a little longer". That is, we let the trajectory run from $(t_0, q_0)$ to $(t, q)$, then let it keep running for $\delta t$, reaching $(t+\delta t, q + \delta q)$. It's clear that we have $\delta q = \dot q(t) \delta t$, and</span>
<span id="cb1-863"><a href="#cb1-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-864"><a href="#cb1-864" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-865"><a href="#cb1-865" aria-hidden="true" tabindex="-1"></a>S(t+\delta t, q + \delta q; t_0, q_0) - S(t, q; t_0, q_0) = \left(\sum_i p_i \dot q_i - H\right)\delta t</span>
<span id="cb1-866"><a href="#cb1-866" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-867"><a href="#cb1-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-868"><a href="#cb1-868" aria-hidden="true" tabindex="-1"></a>so we have:</span>
<span id="cb1-869"><a href="#cb1-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-870"><a href="#cb1-870" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-871"><a href="#cb1-871" aria-hidden="true" tabindex="-1"></a>\partial_t S + \sum_i \partial_{q_i}S \dot q_i = - H + \sum_i p_i \dot q_i</span>
<span id="cb1-872"><a href="#cb1-872" aria-hidden="true" tabindex="-1"></a>$$ {#eq-HJ0}</span>
<span id="cb1-873"><a href="#cb1-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-874"><a href="#cb1-874" aria-hidden="true" tabindex="-1"></a>which strongly suggests </span>
<span id="cb1-875"><a href="#cb1-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-876"><a href="#cb1-876" aria-hidden="true" tabindex="-1"></a>::: {#thm-hj}</span>
<span id="cb1-877"><a href="#cb1-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-878"><a href="#cb1-878" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-879"><a href="#cb1-879" aria-hidden="true" tabindex="-1"></a>(-\partial_t, \nabla_q)S(t, q; t_0, q_0) = (H, p), \quad (-\partial_{t_0}, \nabla_{q_0})S(t, q; t_0, q_0) = (H_0, p_0)</span>
<span id="cb1-880"><a href="#cb1-880" aria-hidden="true" tabindex="-1"></a>$$ {#eq-HJ}</span>
<span id="cb1-881"><a href="#cb1-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-882"><a href="#cb1-882" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-883"><a href="#cb1-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-884"><a href="#cb1-884" aria-hidden="true" tabindex="-1"></a>If @eq-HJ is indeed true, then we have</span>
<span id="cb1-885"><a href="#cb1-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-886"><a href="#cb1-886" aria-hidden="true" tabindex="-1"></a>::: {#thm-hje}</span>
<span id="cb1-887"><a href="#cb1-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-888"><a href="#cb1-888" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hamilton--Jacobi equation</span></span>
<span id="cb1-889"><a href="#cb1-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-890"><a href="#cb1-890" aria-hidden="true" tabindex="-1"></a>$$\partial_t S + H(t, q, \nabla_q S) = 0$$</span>
<span id="cb1-891"><a href="#cb1-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-892"><a href="#cb1-892" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-893"><a href="#cb1-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-894"><a href="#cb1-894" aria-hidden="true" tabindex="-1"></a>It suffices to prove $\nabla_q S = p$, since then $\partial_t S = -H$ follows from @eq-HJ0.</span>
<span id="cb1-895"><a href="#cb1-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-896"><a href="#cb1-896" aria-hidden="true" tabindex="-1"></a>It suffices to prove $(-\partial_t, \nabla_q)S(t, q; t_0, q_0) = (H, p)$, since the other one is proved by the same argument, time-reversed.</span>
<span id="cb1-897"><a href="#cb1-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-898"><a href="#cb1-898" aria-hidden="true" tabindex="-1"></a>Recall the economic construction of $p$. It is a price vector designed specifically to destroy all arbitrage opportunities. Consequently, we can consider an entire family of paths shown in Figure (a, b).</span>
<span id="cb1-899"><a href="#cb1-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-900"><a href="#cb1-900" aria-hidden="true" tabindex="-1"></a><span class="al">![Derivation of the Hamilton--Jacobi equation.](figure/HJ0-derivation.jpg)</span></span>
<span id="cb1-901"><a href="#cb1-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-902"><a href="#cb1-902" aria-hidden="true" tabindex="-1"></a>Here, $\gamma$ is the path from $(t_0, q_0)$ to $(t, q)$, and $\gamma + \delta \gamma$ is the path to $(t, q+\delta q)$. We interpolate between them by a family of paths $<span class="sc">\{</span>\gamma_\tau<span class="sc">\}</span>_{\tau}$, where $\gamma_\tau$ is the path obtained by first moving on $\gamma$ for time $t\in <span class="co">[</span><span class="ot">t_0, \tau</span><span class="co">]</span>$, then making a "jump" by "purchasing from the market"<span class="ot">[^purchasing-from-the-market]</span> an infinitesimal bundle of commodities so that we fall onto the $\gamma + \delta \gamma$ path, then continue along that path.</span>
<span id="cb1-903"><a href="#cb1-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-904"><a href="#cb1-904" aria-hidden="true" tabindex="-1"></a><span class="ot">[^purchasing-from-the-market]: </span>We are using the market *for real* now, so the marketeer had better had stocked up on those commodities!</span>
<span id="cb1-905"><a href="#cb1-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-906"><a href="#cb1-906" aria-hidden="true" tabindex="-1"></a>Now consider two such jumped-paths, $\gamma_{\tau}$ and $\gamma_{\tau + \delta \tau}$, where $\delta \tau$ is an infinitesimal, shown in Figure (c). The cost difference between them is that between two sides of the parallelogram. By the no-arbitrage construction, the difference is zero.<span class="ot">[^higher-order-infinitesimal]</span></span>
<span id="cb1-907"><a href="#cb1-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-908"><a href="#cb1-908" aria-hidden="true" tabindex="-1"></a>Thus, we can smoothly "glide"<span class="ot">[^path-homotopy]</span> the path $\gamma$ to $\gamma + \delta\gamma$ by the family of jumped-paths $\gamma_\tau$, with $\tau$ going from $t$ to $t_0$, with no change in cost.<span class="ot">[^higher-order-infinitesimal-cost]</span> Thus, the only cost difference between $\gamma$ and $\gamma + \delta$ is the cost it takes to buy the bundle of commodities $\delta q$ at the very last instance:</span>
<span id="cb1-909"><a href="#cb1-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-910"><a href="#cb1-910" aria-hidden="true" tabindex="-1"></a>$$S(t, q+\delta q; t_0, q_0) - S(t, q; t_0, q_0) = \sum_i p_i \delta q_i$$</span>
<span id="cb1-911"><a href="#cb1-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-912"><a href="#cb1-912" aria-hidden="true" tabindex="-1"></a>finishing the proof.</span>
<span id="cb1-913"><a href="#cb1-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-914"><a href="#cb1-914" aria-hidden="true" tabindex="-1"></a><span class="ot">[^path-homotopy]: </span>In the jargon of topology, this is a homotopy of paths.</span>
<span id="cb1-915"><a href="#cb1-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-916"><a href="#cb1-916" aria-hidden="true" tabindex="-1"></a><span class="ot">[^higher-order-infinitesimal]: </span>More precisely, a higher-order infinitesimal than the area of the parallelogram. See @tip-higher-order-infinitesimal.</span>
<span id="cb1-917"><a href="#cb1-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-918"><a href="#cb1-918" aria-hidden="true" tabindex="-1"></a><span class="ot">[^higher-order-infinitesimal-cost]: </span>More precisely, their difference in cost is a higher-order infinitesimal than the area of the curvy triangle between them. Since the curvy triangle is an infinitesimal of order $\delta q$, the difference in cost is a higher-order infinitesimal than $\delta q$.</span>
<span id="cb1-919"><a href="#cb1-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-920"><a href="#cb1-920" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="The usual proof" collapse="true"}</span>
<span id="cb1-921"><a href="#cb1-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-922"><a href="#cb1-922" aria-hidden="true" tabindex="-1"></a>The HJE has a standard proof, such as the one appearing in <span class="co">[</span><span class="ot">@goldsteinClassicalMechanics2008, Chapter 8</span><span class="co">]</span>. It does not require reasoning with different orders of infinitesimals, but it is less geometrical.</span>
<span id="cb1-923"><a href="#cb1-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-924"><a href="#cb1-924" aria-hidden="true" tabindex="-1"></a>Sketch of the proof:</span>
<span id="cb1-925"><a href="#cb1-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-926"><a href="#cb1-926" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Start with the original system with configuration space $(t, q_{1:N}, \dot q_{1:N})$.</span>
<span id="cb1-927"><a href="#cb1-927" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Move to the Hamiltonian equations on phase space $(t, q_{1:N}, p_{1:N})$.</span>
<span id="cb1-928"><a href="#cb1-928" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Regard *that* as part of a larger system with configuration space $(t, q_{1:N}, p_{1:N}, \dot q_{1:N}, \dot q_{1:N}))$</span>
<span id="cb1-929"><a href="#cb1-929" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Write down the Euler--Lagrange equations for that larger system.</span>
<span id="cb1-930"><a href="#cb1-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-931"><a href="#cb1-931" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-932"><a href="#cb1-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-933"><a href="#cb1-933" aria-hidden="true" tabindex="-1"></a>::: {#thm-poincare-cartan}</span>
<span id="cb1-934"><a href="#cb1-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-935"><a href="#cb1-935" aria-hidden="true" tabindex="-1"></a><span class="fu">## Poincaré--Cartan integral invariant [@arnoldMathematicalMethodsClassical2001, pages 237--238]</span></span>
<span id="cb1-936"><a href="#cb1-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-937"><a href="#cb1-937" aria-hidden="true" tabindex="-1"></a>Draw an arbitrary closed cycle $\alpha$ in phase space-time. Let every point $A \in \alpha$ evolve for some time (not necessarily the same amount of time) to reach some other point $A'$. Let $\alpha'$ be the cycle consisting of those points $A'$. Then we have the **Poincaré--Cartan integral invariant**</span>
<span id="cb1-938"><a href="#cb1-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-939"><a href="#cb1-939" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-940"><a href="#cb1-940" aria-hidden="true" tabindex="-1"></a>\oint_\alpha \lra{p, dq} - Hdt = \oint_{\alpha'} \lra{p, dq} - Hdt</span>
<span id="cb1-941"><a href="#cb1-941" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-942"><a href="#cb1-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-943"><a href="#cb1-943" aria-hidden="true" tabindex="-1"></a>As a special case, if both $\alpha$ and $\alpha'$ consists of simultaneous points, then it reduces to the **Poincaré relative integral invariant**</span>
<span id="cb1-944"><a href="#cb1-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-945"><a href="#cb1-945" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-946"><a href="#cb1-946" aria-hidden="true" tabindex="-1"></a>\oint_\alpha \lra{p, dq} = \oint_{\alpha'} \lra{p, dq}</span>
<span id="cb1-947"><a href="#cb1-947" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-948"><a href="#cb1-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-949"><a href="#cb1-949" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-950"><a href="#cb1-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-951"><a href="#cb1-951" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Proof" collapse="true"}</span>
<span id="cb1-952"><a href="#cb1-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-953"><a href="#cb1-953" aria-hidden="true" tabindex="-1"></a>Divide the tube into ribbons, like a barrel, then note that the integral around each barrel-plank is zero, as argued before. This is a case of the Stokes' theorem.</span>
<span id="cb1-954"><a href="#cb1-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-955"><a href="#cb1-955" aria-hidden="true" tabindex="-1"></a><span class="al">![](figure/poincare_cartan_invariant_proof_cropped.jpg)</span></span>
<span id="cb1-956"><a href="#cb1-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-957"><a href="#cb1-957" aria-hidden="true" tabindex="-1"></a>In more detail, we can consider the four ends of a barrel-plank parallelogram. Label those points as $A, B, A', B'$ as shown. Though the points $A, B, A', B'$ exist in phase space-point, we can forget their momenta, thus projecting them to configuration space-time. Each phase space-time trajectory projects to a trajectory in configuration space-time, and we obtain $S_{A \to B} = S(t_A, q_A; t_B, q_B)$, etc.</span>
<span id="cb1-958"><a href="#cb1-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-959"><a href="#cb1-959" aria-hidden="true" tabindex="-1"></a>Now, by @eq-HJ, we can shift $S_{A \to B}$ to $S_{A \to B'}$, then to $S_{A' \to B'}$:</span>
<span id="cb1-960"><a href="#cb1-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-961"><a href="#cb1-961" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-962"><a href="#cb1-962" aria-hidden="true" tabindex="-1"></a>S_{A \to B} = S_{A \to B'}  -H_B \delta t_B + \lra{p_B , \delta q_B} = S_{A' \to B'} + H_A \delta t_A - \lra{p_A , \delta q_A} -H_B \delta t_B + \lra{p_B , \delta q_B}</span>
<span id="cb1-963"><a href="#cb1-963" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-964"><a href="#cb1-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-965"><a href="#cb1-965" aria-hidden="true" tabindex="-1"></a>Now, if we shift around one entire cycle, we would get back the same $S_{A \to B}$. Thus the two integrals are equal.</span>
<span id="cb1-966"><a href="#cb1-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-967"><a href="#cb1-967" aria-hidden="true" tabindex="-1"></a>We will prove <span class="co">[</span><span class="ot">Noether's theorem</span><span class="co">](#thm-noether)</span> similarly.</span>
<span id="cb1-968"><a href="#cb1-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-969"><a href="#cb1-969" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-970"><a href="#cb1-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-971"><a href="#cb1-971" aria-hidden="true" tabindex="-1"></a>::: {#exr-zero-poincare-cartan}</span>
<span id="cb1-972"><a href="#cb1-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-973"><a href="#cb1-973" aria-hidden="true" tabindex="-1"></a>A one-dimensional family of trajectories in phase space sweep out a curved surface. As shown in the illustration, prove that for any cycle $\gamma$ on the curved surface, $\oint_\gamma \lra{p, dq} = 0$.</span>
<span id="cb1-974"><a href="#cb1-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-975"><a href="#cb1-975" aria-hidden="true" tabindex="-1"></a><span class="al">![Illustration for $\oint_\gamma \lra{p, dq} = 0$.](figure/zero_poincare_cartan.jpg)</span>{width=60% fig-align="center"}</span>
<span id="cb1-976"><a href="#cb1-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-977"><a href="#cb1-977" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-978"><a href="#cb1-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-979"><a href="#cb1-979" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hamilton characteristic function</span></span>
<span id="cb1-980"><a href="#cb1-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-981"><a href="#cb1-981" aria-hidden="true" tabindex="-1"></a>In most situations, the system is time-independent. In this case we can simplify the HJE to</span>
<span id="cb1-982"><a href="#cb1-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-983"><a href="#cb1-983" aria-hidden="true" tabindex="-1"></a>$$\partial_t S = -H(q, \nabla_q S)$$</span>
<span id="cb1-984"><a href="#cb1-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-985"><a href="#cb1-985" aria-hidden="true" tabindex="-1"></a>Since the left side depends on $t$, but the right side does not explicitly, we can solve this by separation of variables.</span>
<span id="cb1-986"><a href="#cb1-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-987"><a href="#cb1-987" aria-hidden="true" tabindex="-1"></a>Suppose there exists some function $W$, called the **Hamilton characteristic function**, that satisfies</span>
<span id="cb1-988"><a href="#cb1-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-989"><a href="#cb1-989" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-990"><a href="#cb1-990" aria-hidden="true" tabindex="-1"></a>H(q, \nabla_q W(q)) = E</span>
<span id="cb1-991"><a href="#cb1-991" aria-hidden="true" tabindex="-1"></a>$$ {#eq-THJE}</span>
<span id="cb1-992"><a href="#cb1-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-993"><a href="#cb1-993" aria-hidden="true" tabindex="-1"></a>for some $E\in \R$, then $S(t, q) = W(q) - Et$ is a solution to the HJE. </span>
<span id="cb1-994"><a href="#cb1-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-995"><a href="#cb1-995" aria-hidden="true" tabindex="-1"></a>We might naively think, by analogy with Fourier transform, that any solution to the HJE is a linear combination, of the form $S(t, q) = \int (W_E(q) - Et)dE$, but this is not true, since the HJE is nonlinear. Nevertheless, solutions of the form $S(t, q) = W(q) - Et$ are often sufficient for applications.</span>
<span id="cb1-996"><a href="#cb1-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-997"><a href="#cb1-997" aria-hidden="true" tabindex="-1"></a><span class="fu">### Two more proofs of HJE</span></span>
<span id="cb1-998"><a href="#cb1-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-999"><a href="#cb1-999" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Proof by positional arbitrage" collapse="false"}</span>
<span id="cb1-1000"><a href="#cb1-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1001"><a href="#cb1-1001" aria-hidden="true" tabindex="-1"></a>We only need to prove $p = \nabla S$, which is sufficient to prove @eq-HJ, and thus the HJE.</span>
<span id="cb1-1002"><a href="#cb1-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1003"><a href="#cb1-1003" aria-hidden="true" tabindex="-1"></a>Given a starting position $(t_0, q_0)$ and a reference trajectory, there exists some $S(t, q; t_0, q_0)$, the cost function of arriving at any point in configuration space-time in a neighborhood of the reference trajectory. For each trajectory $\gamma$ in the neighborhood that arrives at $(t, q)$, there exists a final market price $q(t)$. We need to show that $q = \nabla S$.</span>
<span id="cb1-1004"><a href="#cb1-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1005"><a href="#cb1-1005" aria-hidden="true" tabindex="-1"></a>Suppose not, then we can perform positional arbitrage. First, we arrive at $q + \delta q$ by the efficient route, then sell off some $\delta q$. This would cost us </span>
<span id="cb1-1006"><a href="#cb1-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1007"><a href="#cb1-1007" aria-hidden="true" tabindex="-1"></a>$$S(t, q+\delta q; t_0, q_0) - \lra{p, \delta q} = S(t, q; t_0, q_0) + \lra{\nabla S - p, \delta q}$$</span>
<span id="cb1-1008"><a href="#cb1-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1009"><a href="#cb1-1009" aria-hidden="true" tabindex="-1"></a>If $\nabla S \neq p$, then we can take $\delta q = -(\nabla S - p)\epsilon$, and thus magically make the journey cost less by a first-order infinitesimal. This means the market is inefficient, a contradiction.</span>
<span id="cb1-1010"><a href="#cb1-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1011"><a href="#cb1-1011" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1012"><a href="#cb1-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1013"><a href="#cb1-1013" aria-hidden="true" tabindex="-1"></a>Here is a proof in the spirit of wave mechanics and dynamical programming. Though I did not study his proof,<span class="ot">[^bellman-proof]</span> I believe this is how the inventor of dynamical programming, <span class="co">[</span><span class="ot">Richard Bellman</span><span class="co">](https://en.wikipedia.org/wiki/Richard_E._Bellman)</span>, proved his extension, the <span class="co">[</span><span class="ot">Hamilton--Jacobi--Bellman equation</span><span class="co">](https://en.wikipedia.org/wiki/Hamilton%E2%80%93Jacobi%E2%80%93Bellman_equation)</span>. The HJBE reduces to the HJE under certain conditions -- they do not talk about the same thing, because while HJ is about stationary action, HJB is about maximal action.</span>
<span id="cb1-1014"><a href="#cb1-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1015"><a href="#cb1-1015" aria-hidden="true" tabindex="-1"></a><span class="ot">[^bellman-proof]</span>:</span>
<span id="cb1-1016"><a href="#cb1-1016" aria-hidden="true" tabindex="-1"></a>    In his autobiography, he said, </span>
<span id="cb1-1017"><a href="#cb1-1017" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-1018"><a href="#cb1-1018" aria-hidden="true" tabindex="-1"></a><span class="in">    &gt; Problems of this type had been worked on before by many mathematicians, Euler, Hamilton, and Steiner, but the systematic study of problems of this type was done at RAND starting in 1948 under the inspiration of von Neumann. [@bellmanEyeHurricaneRichard1984, page 208]</span></span>
<span id="cb1-1019"><a href="#cb1-1019" aria-hidden="true" tabindex="-1"></a><span class="in">    &gt; </span></span>
<span id="cb1-1020"><a href="#cb1-1020" aria-hidden="true" tabindex="-1"></a><span class="in">    &gt; ... one can use dynamic programming for the minimum principles of mathematical physics. For example, with dynamic programming one has a very simple derivation of the eikonal equation. In addition, the Hamilton-Jacobi equation of mechanics can easily be derived. [@bellmanEyeHurricaneRichard1984, page 289]</span></span>
<span id="cb1-1021"><a href="#cb1-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1022"><a href="#cb1-1022" aria-hidden="true" tabindex="-1"></a>Suppose that we have found all points at which the action is equal to $S$. Now we would like to expand that surface a little further, to the surface of action $S + \delta S$. We do that in the spirit of economics (of course!) and traveling.</span>
<span id="cb1-1023"><a href="#cb1-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1024"><a href="#cb1-1024" aria-hidden="true" tabindex="-1"></a>Interpret the action of a path as the cost of traveling along that path. The surfaces of constant action, then, become the <span class="co">[</span><span class="ot">isochrone maps</span><span class="co">](https://en.wikipedia.org/wiki/Isochrone_map)</span>. The problem we face is then a matter of travel planning: Given that we can reach up to surface $X_S$ if we are willing to pay cost $S$, how much further can we travel if we are willing to pay an additional $\delta S$?</span>
<span id="cb1-1025"><a href="#cb1-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1026"><a href="#cb1-1026" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">Isochrone maps of travel time in America, 1800 -- 1930. [@paullinAtlasHistoricalGeography1932, plate 138, page 366]</span><span class="co">](figure/isochrone_map_america.jpg)</span></span>
<span id="cb1-1027"><a href="#cb1-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1028"><a href="#cb1-1028" aria-hidden="true" tabindex="-1"></a>Let us stand at a point $(t, q)$ on the surface of action $S$, and consider all the points we can reach by an additional action $\delta S$. Suppose we go from $(t, q)$ to $(t + \epsilon t, q + \epsilon q)$, then the cost of that is $L\lrb{t, q, \frac{\epsilon q}{\epsilon q}}\epsilon t$. (We write $\epsilon t$ instead of $\delta t$, because we have to use that symbol later.)</span>
<span id="cb1-1029"><a href="#cb1-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1030"><a href="#cb1-1030" aria-hidden="true" tabindex="-1"></a>Therefore, the "wave" of action $\delta S$ coming out of the point $(t, q)$ are those points $(t + \epsilon t, q + \epsilon q)$ satisfying the equation</span>
<span id="cb1-1031"><a href="#cb1-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1032"><a href="#cb1-1032" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1033"><a href="#cb1-1033" aria-hidden="true" tabindex="-1"></a>L\lrb{t, q, \frac{\epsilon q}{\epsilon q}}\epsilon t = \delta S</span>
<span id="cb1-1034"><a href="#cb1-1034" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1035"><a href="#cb1-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1036"><a href="#cb1-1036" aria-hidden="true" tabindex="-1"></a>And the surface of action $S + \delta S$ is the envelope of all those little waves ("wavelets"). This is the wave perspective, but we still need to return to the particle perspective.</span>
<span id="cb1-1037"><a href="#cb1-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1038"><a href="#cb1-1038" aria-hidden="true" tabindex="-1"></a>Suppose you are already at $(t, q)$, and you just want to reach the surface of $S + \delta S$. It doesn't matter where you end up on that surface -- you just have to get to that surface *somewhere*. You also have exactly $\delta S$ to spend, so you have to plan optimally. Now, looking at that picture, you see that the only place you can possibly reach is a certain point $(t + \delta t, q + \delta q)$ where the wavelet is tangent to the surface of $S + \delta S$. At that point, the tangent surfaces of $S$ at $(t, q)$ is parallel to the tangent surface of wavelet. That is,</span>
<span id="cb1-1039"><a href="#cb1-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1040"><a href="#cb1-1040" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1041"><a href="#cb1-1041" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb1-1042"><a href="#cb1-1042" aria-hidden="true" tabindex="-1"></a>d\left(L\left(t, q,-\frac{\epsilon q}{\epsilon t}\right) \epsilon t\right) |_{\epsilon t = \delta t, \epsilon q = \delta q} &amp;= \lra{(\left(\nabla_q L\right) \underbrace{\delta t}_{\rightarrow 0}+\nabla_v L), d q} +\left(L-\frac{\delta q}{\delta t} \nabla_v L\right) d t <span class="sc">\\</span></span>
<span id="cb1-1043"><a href="#cb1-1043" aria-hidden="true" tabindex="-1"></a>&amp;\propto dS</span>
<span id="cb1-1044"><a href="#cb1-1044" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb1-1045"><a href="#cb1-1045" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1046"><a href="#cb1-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1047"><a href="#cb1-1047" aria-hidden="true" tabindex="-1"></a>Thus, there exists some constant $c &gt; 0$ such that</span>
<span id="cb1-1048"><a href="#cb1-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1049"><a href="#cb1-1049" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1050"><a href="#cb1-1050" aria-hidden="true" tabindex="-1"></a>(\partial_t S, \nabla_q S) = c \lrb{\lra{\nabla_v L, \frac{\delta q}{\delta t}} - L , \nabla_v L} = (-cH, cp)</span>
<span id="cb1-1051"><a href="#cb1-1051" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1052"><a href="#cb1-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1053"><a href="#cb1-1053" aria-hidden="true" tabindex="-1"></a>Since we also have</span>
<span id="cb1-1054"><a href="#cb1-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1055"><a href="#cb1-1055" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1056"><a href="#cb1-1056" aria-hidden="true" tabindex="-1"></a>\partial_t S \delta t + \lra{\nabla_q S, \delta q} = \delta S = L \delta t</span>
<span id="cb1-1057"><a href="#cb1-1057" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1058"><a href="#cb1-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1059"><a href="#cb1-1059" aria-hidden="true" tabindex="-1"></a>we see $c=1$.</span>
<span id="cb1-1060"><a href="#cb1-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1061"><a href="#cb1-1061" aria-hidden="true" tabindex="-1"></a><span class="al">![The wavelet proof of the HJE.](figure/hje_proof.jpg)</span>{width=70% fig-align="center"}</span>
<span id="cb1-1062"><a href="#cb1-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1063"><a href="#cb1-1063" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Convexity of the wavelet"}</span>
<span id="cb1-1064"><a href="#cb1-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1065"><a href="#cb1-1065" aria-hidden="true" tabindex="-1"></a>If the wavelet is convex, then the tangent point is unique, and there is only one way to proceed from $(t, q)$. However, if the wavelet is not, then there could exist *two* or more particle paths shooting out from $(t, q)$. It is similar to <span class="co">[</span><span class="ot">birefringence</span><span class="co">](https://en.wikipedia.org/wiki/Birefringence)</span> and conical refraction <span class="co">[</span><span class="ot">@lunneyInsOutsConical2006</span><span class="co">]</span>.</span>
<span id="cb1-1066"><a href="#cb1-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1067"><a href="#cb1-1067" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1068"><a href="#cb1-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1069"><a href="#cb1-1069" aria-hidden="true" tabindex="-1"></a>::: {#exr-0}</span>
<span id="cb1-1070"><a href="#cb1-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1071"><a href="#cb1-1071" aria-hidden="true" tabindex="-1"></a>If you have studied, or intend to study, control theory, then prove the Hamilton--Jacobi--Bellman equation using the exact same picture. You can also prove the stochastic HJB equation in the same way, though you would need to insert the expectation $\E$ somewhere.</span>
<span id="cb1-1072"><a href="#cb1-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1073"><a href="#cb1-1073" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1074"><a href="#cb1-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1075"><a href="#cb1-1075" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bonus: Noether's theorem</span></span>
<span id="cb1-1076"><a href="#cb1-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1077"><a href="#cb1-1077" aria-hidden="true" tabindex="-1"></a>In Noether's theorem, symmetries of the Lagrangian give us conserved quantities of motion.</span>
<span id="cb1-1078"><a href="#cb1-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1079"><a href="#cb1-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\epsilon$ is an infinitesimal number.</span>
<span id="cb1-1080"><a href="#cb1-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>An **infinitesimal transform** is an infinitesimal deformation $(\delta t, \delta q)$ of configuration space-time. </span>
<span id="cb1-1081"><a href="#cb1-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>$\delta t = \epsilon T$, where $T$ a function of type $\ub{\R}{time} \times \ub{\mathcal C}{configuration space} \to \R$</span>
<span id="cb1-1082"><a href="#cb1-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>$\delta q = \epsilon Q$, where $Q$ is a function of type $\R \times \mathcal C \to \R^d$, where $d$ is the dimension of configuration space $\mathcal C$.</span>
<span id="cb1-1083"><a href="#cb1-1083" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>An infinitesimal transform is a **symmetry of the Lagrangian**, iff taking any path $\gamma$ (not necessarily physically real), and deforming it to $\gamma'$, the action is conserved: $\int_\gamma L dt = \int_{\gamma'} L dt$.</span>
<span id="cb1-1084"><a href="#cb1-1084" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A **conserved quantity of motion** is a number depending on $t, q, \dot q$, such that it is constant along any physically real path $\gamma$.</span>
<span id="cb1-1085"><a href="#cb1-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1086"><a href="#cb1-1086" aria-hidden="true" tabindex="-1"></a>::: {#exr-0}</span>
<span id="cb1-1087"><a href="#cb1-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1088"><a href="#cb1-1088" aria-hidden="true" tabindex="-1"></a>We defined "symmetry of the Lagrangian" by a condition on an integral: $\int_\gamma L dt = \int_{\gamma'} L dt$. Reformulate this to a condition at a point, involving $L, Q, T$ and their derivatives.</span>
<span id="cb1-1089"><a href="#cb1-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1090"><a href="#cb1-1090" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1091"><a href="#cb1-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1092"><a href="#cb1-1092" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb1-1093"><a href="#cb1-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1094"><a href="#cb1-1094" aria-hidden="true" tabindex="-1"></a>A symmetry of the Lagrangian conserves *all* actions, even those of unphysical paths, but a conserved quantity of motion is only conserved along physical paths. We may call them "conserved quantity of *physical* motion" to emphasize the distinction.</span>
<span id="cb1-1095"><a href="#cb1-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1096"><a href="#cb1-1096" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1097"><a href="#cb1-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1098"><a href="#cb1-1098" aria-hidden="true" tabindex="-1"></a>Take a trajectory $\gamma_{AA'}$ from point $A$ to $A'$. Now, shift it by $\delta t, \delta q$, resulting in a trajectory $\gamma_{BB'}$ from point $B$ to $B'$. Since $L$ is invariant under symmetry, any such shifting gives us $S_{AA'} = S_{BB'}$. Now, if $\delta S \neq 0$ in a neighborhood of the given trajectory $\gamma_{AA'}$, then we can take this variation $\delta \gamma$, and shift it by the symmetry, showing that $\delta S \neq 0$ in a neighborhood of $\gamma_{BB'}$ too.</span>
<span id="cb1-1099"><a href="#cb1-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1100"><a href="#cb1-1100" aria-hidden="true" tabindex="-1"></a>Therefore, by Hamilton's principle, the infinitesimal transform sends any physically real trajectory into another physically real trajectory.</span>
<span id="cb1-1101"><a href="#cb1-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1102"><a href="#cb1-1102" aria-hidden="true" tabindex="-1"></a>::: {#thm-noether}</span>
<span id="cb1-1103"><a href="#cb1-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1104"><a href="#cb1-1104" aria-hidden="true" tabindex="-1"></a><span class="fu">## Noether's theorem</span></span>
<span id="cb1-1105"><a href="#cb1-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1106"><a href="#cb1-1106" aria-hidden="true" tabindex="-1"></a>If $(t, q) \mapsto (t + \epsilon T, q + \epsilon Q)$ is an infinitesimal symmetry of the Lagrangian, then </span>
<span id="cb1-1107"><a href="#cb1-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1108"><a href="#cb1-1108" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1109"><a href="#cb1-1109" aria-hidden="true" tabindex="-1"></a>H T - \lra{p, \delta Q} = (\lra{\nabla_v L, \dot q} - L)T - \lra{\nabla_v L, Q}</span>
<span id="cb1-1110"><a href="#cb1-1110" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1111"><a href="#cb1-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1112"><a href="#cb1-1112" aria-hidden="true" tabindex="-1"></a>is a conserved quantity of motion.</span>
<span id="cb1-1113"><a href="#cb1-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1114"><a href="#cb1-1114" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1115"><a href="#cb1-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1116"><a href="#cb1-1116" aria-hidden="true" tabindex="-1"></a>Technically speaking, we should not confuse the left side and the right side of </span>
<span id="cb1-1117"><a href="#cb1-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1118"><a href="#cb1-1118" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1119"><a href="#cb1-1119" aria-hidden="true" tabindex="-1"></a>H T - \lra{p, \delta Q} = (\lra{\nabla_v L, \dot q} - L)T - \lra{\nabla_v L, Q}</span>
<span id="cb1-1120"><a href="#cb1-1120" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1121"><a href="#cb1-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1122"><a href="#cb1-1122" aria-hidden="true" tabindex="-1"></a>The left side is defined on the phase space-time, while the right side is defined on the configuration space-time. They are equal only because we have soldered together the phase space and the configuration space.</span>
<span id="cb1-1123"><a href="#cb1-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1124"><a href="#cb1-1124" aria-hidden="true" tabindex="-1"></a>Indeed, again and again we see that Lagrangian and Hamiltonian mechanics are different worlds, with their own dreams and phantasies, but always agreeing on the same reality.</span>
<span id="cb1-1125"><a href="#cb1-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1126"><a href="#cb1-1126" aria-hidden="true" tabindex="-1"></a>If this were the case, then why do we bother creating two mechanics, since there is no physical experiment to distinguish them? It is because in quantum mechanics, virtual trajectories are just as real as the "real" trajectories. A particle can just go around the earth once before it arrives at its destination, taking the long way around. In this case, what is virtually possible matters just as much as what is classically real, and if Lagrangian mechanics and Hamiltonian mechanics can entertain different kinds of dreams, we might be able to tell them apart.</span>
<span id="cb1-1127"><a href="#cb1-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1128"><a href="#cb1-1128" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">$S$ is a source of photons, and $P$ is a receiver. A photon can go from $S$ to $P$ by bouncing off the mirror below, along many paths. Each path has a certain amplitude, and the sum of all their amplitudes is the total amplitude. While the amplitude is dominated by the amplitudes near the classical path $SGP$, it is not the only path, and all paths, even the "virtual" paths like $SAP$, contribute to what we observe. [@feynmanQEDStrangeTheory2006, figure 24]</span><span class="co">](figure/qed_2006_fig_24.png)</span>{width=60% fig-align="center"}</span>
<span id="cb1-1129"><a href="#cb1-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1130"><a href="#cb1-1130" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Proof" collapse="false"}</span>
<span id="cb1-1131"><a href="#cb1-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1132"><a href="#cb1-1132" aria-hidden="true" tabindex="-1"></a>Given any physically real trajectory $\gamma_{AA'}$ from point $A$ to $A'$, the infinitesimal transform sends it to another physically real $\gamma_{BB'}$. By symmetry, both paths have the same action. Thus, we have</span>
<span id="cb1-1133"><a href="#cb1-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1134"><a href="#cb1-1134" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1135"><a href="#cb1-1135" aria-hidden="true" tabindex="-1"></a>S(A, A') = S(B, B')</span>
<span id="cb1-1136"><a href="#cb1-1136" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1137"><a href="#cb1-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1138"><a href="#cb1-1138" aria-hidden="true" tabindex="-1"></a>Now, consider an intermediate path $\gamma_{A, B'}$. By @eq-HJ,</span>
<span id="cb1-1139"><a href="#cb1-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1140"><a href="#cb1-1140" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1141"><a href="#cb1-1141" aria-hidden="true" tabindex="-1"></a>S(A, B') = S(A, A') - H \delta t + \lra{p, \delta q}, \quad S(B, B') = S(A, B') + H_0 \delta t_0 - \lra{p_0, \delta q_0}</span>
<span id="cb1-1142"><a href="#cb1-1142" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1143"><a href="#cb1-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1144"><a href="#cb1-1144" aria-hidden="true" tabindex="-1"></a>Therefore, $H T - \lra{p, \delta Q}$ is a conserved quantity of motion.</span>
<span id="cb1-1145"><a href="#cb1-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1146"><a href="#cb1-1146" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1147"><a href="#cb1-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1148"><a href="#cb1-1148" aria-hidden="true" tabindex="-1"></a>The proof is similar to the proof of @thm-poincare-cartan, though they differ in that Noether's theorem shows a quantity, defined at a single point, is conserved over a trajectory, while the Poincaré--Cartan invariant is not defined at a single point, but as an integral over an entire cycle.</span>
<span id="cb1-1149"><a href="#cb1-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1150"><a href="#cb1-1150" aria-hidden="true" tabindex="-1"></a><span class="al">![](figure/banner/2.png)</span></span>
<span id="cb1-1151"><a href="#cb1-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1152"><a href="#cb1-1152" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hamiltonian optics {#sec-geometric-optics}</span></span>
<span id="cb1-1153"><a href="#cb1-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1154"><a href="#cb1-1154" aria-hidden="true" tabindex="-1"></a><span class="fu">### Isotropic case</span></span>
<span id="cb1-1155"><a href="#cb1-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1156"><a href="#cb1-1156" aria-hidden="true" tabindex="-1"></a>We are going back to the roots, as geometric optics was what inspired Hamilton to develop his theory of Hamiltonian mechanics.</span>
<span id="cb1-1157"><a href="#cb1-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1158"><a href="#cb1-1158" aria-hidden="true" tabindex="-1"></a>When Hamilton developed his Hamiltonian approach, it was to study geometric optics, which can be derived from Fermat's principle: *light paths have stationary travel time*. In other words, the action of a path is</span>
<span id="cb1-1159"><a href="#cb1-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1160"><a href="#cb1-1160" aria-hidden="true" tabindex="-1"></a>$$S(\text{path}) = \int_{\text{path}} dt$$</span>
<span id="cb1-1161"><a href="#cb1-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1162"><a href="#cb1-1162" aria-hidden="true" tabindex="-1"></a>Thus, $L = 1$<span class="sc">\.</span>..? Well, here we see the problem: in geometric optics, if you fix the starting and ending point as $(t_0, q_0), (t, q)$, then *any* path between them takes exactly $t-t_0$ time, and there is nothing to vary. Consequently, we need to remove time from consideration, so that there is something to vary.</span>
<span id="cb1-1163"><a href="#cb1-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1164"><a href="#cb1-1164" aria-hidden="true" tabindex="-1"></a>Fermat's principle, reformulated, states *light paths have stationary optical length*. Let the medium be isotropic (light speed does not depend on direction), then we have</span>
<span id="cb1-1165"><a href="#cb1-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1166"><a href="#cb1-1166" aria-hidden="true" tabindex="-1"></a>$$S(\text{path}) = \int_{\text{path}} n(q) <span class="sc">\|</span>dq<span class="sc">\|</span>$$</span>
<span id="cb1-1167"><a href="#cb1-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1168"><a href="#cb1-1168" aria-hidden="true" tabindex="-1"></a>where $n$ is the refractive index, with $L(q) = n(q)$. Here we encounter a brief difficulty: time flows in one direction only, but space flows in infinitely many possible directions!</span>
<span id="cb1-1169"><a href="#cb1-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1170"><a href="#cb1-1170" aria-hidden="true" tabindex="-1"></a>The solution might seem like a joke, but it would work out well: select one direction<span class="ot">[^principal-optical-axis]</span>, say $q_0$, and pretend that it is time. With this trick, all previous mathematical formalism immediately applies, and we have</span>
<span id="cb1-1171"><a href="#cb1-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1172"><a href="#cb1-1172" aria-hidden="true" tabindex="-1"></a><span class="ot">[^principal-optical-axis]: </span>This direction is usually selected to be the direction of the **principal optic axis**. For example, the long-axis of a camera is a principal optic axis, and so is the barrel-axis of a telescope.</span>
<span id="cb1-1173"><a href="#cb1-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1174"><a href="#cb1-1174" aria-hidden="true" tabindex="-1"></a>$$S(\text{path}) = \int_{\text{path}} n(q_0, q_1, q_2) \sqrt{1 + \left(\frac{dq_1}{dq_0}\right)^2 + \left(\frac{dq_2}{dq_0}\right)^2}dq_0$$</span>
<span id="cb1-1175"><a href="#cb1-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1176"><a href="#cb1-1176" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Derivation</span></span>
<span id="cb1-1177"><a href="#cb1-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1178"><a href="#cb1-1178" aria-hidden="true" tabindex="-1"></a>Let's make the notation cleaner, by rewriting $q_0$ as $t$, $(q_1, q_2)$ as $q$, and using $v$ to mean $\left(\frac{dq_1}{dq_0}, \frac{dq_2}{dq_0}\right)$. Then we have</span>
<span id="cb1-1179"><a href="#cb1-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1180"><a href="#cb1-1180" aria-hidden="true" tabindex="-1"></a>$$L(t, q, v) = n(t, q) \sqrt{1 + <span class="sc">\|</span>v<span class="sc">\|</span>^2}$$</span>
<span id="cb1-1181"><a href="#cb1-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1182"><a href="#cb1-1182" aria-hidden="true" tabindex="-1"></a>Routine calculation yields</span>
<span id="cb1-1183"><a href="#cb1-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1184"><a href="#cb1-1184" aria-hidden="true" tabindex="-1"></a>$$\begin{cases}     </span>
<span id="cb1-1185"><a href="#cb1-1185" aria-hidden="true" tabindex="-1"></a>L(t, q, v) = n(t, q) \sqrt{1 + <span class="sc">\|</span>v<span class="sc">\|</span>^2}<span class="sc">\\</span>     </span>
<span id="cb1-1186"><a href="#cb1-1186" aria-hidden="true" tabindex="-1"></a>H(t, q, p) = -\sqrt{n^2 - <span class="sc">\|</span>p<span class="sc">\|</span>^2} </span>
<span id="cb1-1187"><a href="#cb1-1187" aria-hidden="true" tabindex="-1"></a>\end{cases} \quad </span>
<span id="cb1-1188"><a href="#cb1-1188" aria-hidden="true" tabindex="-1"></a>\begin{cases}     </span>
<span id="cb1-1189"><a href="#cb1-1189" aria-hidden="true" tabindex="-1"></a>p^\ast = \frac{nv}{\sqrt{1 + <span class="sc">\|</span>v<span class="sc">\|</span>^2}} <span class="sc">\\</span>     </span>
<span id="cb1-1190"><a href="#cb1-1190" aria-hidden="true" tabindex="-1"></a>v^\ast = \frac{p}{\sqrt{n^2 - <span class="sc">\|</span>p<span class="sc">\|</span>^2}} </span>
<span id="cb1-1191"><a href="#cb1-1191" aria-hidden="true" tabindex="-1"></a>\end{cases}$$</span>
<span id="cb1-1192"><a href="#cb1-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1193"><a href="#cb1-1193" aria-hidden="true" tabindex="-1"></a>we continue with the HJE, which simplifies to:</span>
<span id="cb1-1194"><a href="#cb1-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1195"><a href="#cb1-1195" aria-hidden="true" tabindex="-1"></a>$$(\partial_t S)^2 + <span class="sc">\|</span>\nabla_q S<span class="sc">\|</span>^2 = n^2$$</span>
<span id="cb1-1196"><a href="#cb1-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1197"><a href="#cb1-1197" aria-hidden="true" tabindex="-1"></a>Reverting notation back to $(q_0, q_1, q_2)$, we find the **eikonal equation**<span class="ot">[^eikonal-etymology]</span>:</span>
<span id="cb1-1198"><a href="#cb1-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1199"><a href="#cb1-1199" aria-hidden="true" tabindex="-1"></a><span class="ot">[^eikonal-etymology]: </span>From Greek εἰκών (*eikon*, "image"), from which the word "icon" derived.</span>
<span id="cb1-1200"><a href="#cb1-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1201"><a href="#cb1-1201" aria-hidden="true" tabindex="-1"></a>$$<span class="sc">\|</span>\nabla_q S<span class="sc">\|</span> = n(q)$$</span>
<span id="cb1-1202"><a href="#cb1-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1203"><a href="#cb1-1203" aria-hidden="true" tabindex="-1"></a>Why did the trick work? Well, if we look back to how we derived the Hamiltonian, we could see that what we called "time" is really just a special copy of $\R$, along which we organized all other state and control variables. We don't really need time to be anything more than the domain of functions, as in $q_i: \R \to \R$ and $v_i : \R\to \R$. It most definitely does not need to "flow", or flow only from the past to the future, or have any psychological significance.</span>
<span id="cb1-1204"><a href="#cb1-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1205"><a href="#cb1-1205" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interpretation</span></span>
<span id="cb1-1206"><a href="#cb1-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1207"><a href="#cb1-1207" aria-hidden="true" tabindex="-1"></a>Starting with Fermat's principle for light rays, we ended up with the eikonal equation for light waves. In general, we find the following duality between wave-field optics and particle-path optics.</span>
<span id="cb1-1208"><a href="#cb1-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1209"><a href="#cb1-1209" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> perspective <span class="pp">|</span>   particle-path <span class="pp">|</span>                   wave-field <span class="pp">|</span></span>
<span id="cb1-1210"><a href="#cb1-1210" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------------|--------------------------------|------------------------------------------|</span></span>
<span id="cb1-1211"><a href="#cb1-1211" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> action $S$ <span class="pp">|</span>    a function of particle path   <span class="pp">|</span>   a field on configuration-spacetime <span class="pp">|</span></span>
<span id="cb1-1212"><a href="#cb1-1212" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> equation    <span class="pp">|</span>   $<span class="sc">\|</span>\nabla_q S<span class="sc">\|</span> = n(q)$      <span class="pp">|</span>  $\partial_t S + H(t, q, \nabla_q S) = 0$ <span class="pp">|</span></span>
<span id="cb1-1213"><a href="#cb1-1213" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> in optics    <span class="pp">|</span>  light rays, Fermat's principle <span class="pp">|</span>  light waves, Huygens principle <span class="pp">|</span></span>
<span id="cb1-1214"><a href="#cb1-1214" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> in mechanics  <span class="pp">|</span> point particles                 <span class="pp">|</span> matter waves <span class="pp">|</span></span>
<span id="cb1-1215"><a href="#cb1-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1216"><a href="#cb1-1216" aria-hidden="true" tabindex="-1"></a>: The particle-wave duality.</span>
<span id="cb1-1217"><a href="#cb1-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1218"><a href="#cb1-1218" aria-hidden="true" tabindex="-1"></a><span class="fu">### Anisotropic case</span></span>
<span id="cb1-1219"><a href="#cb1-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1220"><a href="#cb1-1220" aria-hidden="true" tabindex="-1"></a>When the travel cost of light can depend on the direction of travel, we say that the medium is anisotropic. Now, you might expect </span>
<span id="cb1-1221"><a href="#cb1-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1222"><a href="#cb1-1222" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1223"><a href="#cb1-1223" aria-hidden="true" tabindex="-1"></a>S = \int n(\hat{\delta q}) \delta q</span>
<span id="cb1-1224"><a href="#cb1-1224" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1225"><a href="#cb1-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1226"><a href="#cb1-1226" aria-hidden="true" tabindex="-1"></a>but this is incorrect, not because there is anything necessarily wrong with the formalism, but because of how $n$ is defined by convention in anisotropic material. At this point, we must study the full particle-wave duality again.</span>
<span id="cb1-1227"><a href="#cb1-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1228"><a href="#cb1-1228" aria-hidden="true" tabindex="-1"></a>For a moment, let's pretend light is really a particle, and consider how it might appear to someone who believes light is a wave. We arrange an entire plane of photons, such that the plane is perpendicular to a unit vector $\hat k$. Now, let them move optimally for time $\delta$. Each of them would go in the same optimal direction $v^*(\hat k)$, to push the wavefront as far-out as possible.</span>
<span id="cb1-1229"><a href="#cb1-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1230"><a href="#cb1-1230" aria-hidden="true" tabindex="-1"></a><span class="al">![A plane of particles marching in sync at velocity $v$, but the collective effect is that the plane moves with group velocity $v_g$, which is different from the individual velocity $v$.](figure/planar_group_velocity.jpg)</span>{width="50%" fig-align="center"}</span>
<span id="cb1-1231"><a href="#cb1-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1232"><a href="#cb1-1232" aria-hidden="true" tabindex="-1"></a>Now, the wavefront does not move in the direction $v^*$, but in the direction $\hat k$. Therefore, the wavefront moves at **group velocity** $v_g(\hat k) = \lra{v^*(\hat k), \hat k} \hat k$.</span>
<span id="cb1-1233"><a href="#cb1-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1234"><a href="#cb1-1234" aria-hidden="true" tabindex="-1"></a>Since the photons are trying to push as far out as possible,</span>
<span id="cb1-1235"><a href="#cb1-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1236"><a href="#cb1-1236" aria-hidden="true" tabindex="-1"></a>$$v^*(\hat k) = \argmax_{v \in K_{particle}} \lra{\hat k, v}$$</span>
<span id="cb1-1237"><a href="#cb1-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1238"><a href="#cb1-1238" aria-hidden="true" tabindex="-1"></a>where we write $K_{particle}$ as the surface of all particle velocities in all directions. It is a sphere of radius $c$ in a vacuum, but in an anisotropic medium, we allow it to be any crazy shape.</span>
<span id="cb1-1239"><a href="#cb1-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1240"><a href="#cb1-1240" aria-hidden="true" tabindex="-1"></a>Instead of studying the group velocity, we actually need to use its inverse -- the wavevector $k = \frac{\hat k}{v_g}$.<span class="ot">[^wavevector]</span> We thus have</span>
<span id="cb1-1241"><a href="#cb1-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1242"><a href="#cb1-1242" aria-hidden="true" tabindex="-1"></a>$$k = \frac{\hat k}{\max_{v \in K_{particle} \lra{v, \hat k}}}$$</span>
<span id="cb1-1243"><a href="#cb1-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1244"><a href="#cb1-1244" aria-hidden="true" tabindex="-1"></a><span class="ot">[^wavevector]: </span>The typical definition is $k_{usual} = \frac{2\pi}{\lambda}\hat k = \nabla \phi$, where $\phi$ is the phase of the light, and $f$ is its temporal frequency. Our definition, which makes it cleaner, but somewhat different from typical definition, is $k_{ours} = \frac{\nabla \phi}{2\pi f} = \frac{\nabla \phi}{\omega}$.</span>
<span id="cb1-1245"><a href="#cb1-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1246"><a href="#cb1-1246" aria-hidden="true" tabindex="-1"></a>The reason we use this instead of the group velocity is that, a little simplification later, we have the beautifully simple relation</span>
<span id="cb1-1247"><a href="#cb1-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1248"><a href="#cb1-1248" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1249"><a href="#cb1-1249" aria-hidden="true" tabindex="-1"></a>\forall k \in K_{wave}, \quad \max_{v \in K_{particle}}\lra{v, k} = 1</span>
<span id="cb1-1250"><a href="#cb1-1250" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1251"><a href="#cb1-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1252"><a href="#cb1-1252" aria-hidden="true" tabindex="-1"></a>This is a suggestive symmetry, which practically demands us to write it as a duality:</span>
<span id="cb1-1253"><a href="#cb1-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1254"><a href="#cb1-1254" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1255"><a href="#cb1-1255" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb1-1256"><a href="#cb1-1256" aria-hidden="true" tabindex="-1"></a>v^*(k) = \argmax_{v \in K_{particle}}\lra{v, k} <span class="sc">\\</span></span>
<span id="cb1-1257"><a href="#cb1-1257" aria-hidden="true" tabindex="-1"></a>k^*(v) = \argmax_{k \in K_{wave}}\lra{v, k}</span>
<span id="cb1-1258"><a href="#cb1-1258" aria-hidden="true" tabindex="-1"></a>\end{cases}, \quad</span>
<span id="cb1-1259"><a href="#cb1-1259" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb1-1260"><a href="#cb1-1260" aria-hidden="true" tabindex="-1"></a>\lra{v^*(k), k} = 1<span class="sc">\\</span></span>
<span id="cb1-1261"><a href="#cb1-1261" aria-hidden="true" tabindex="-1"></a>\lra{v, k^*(v)} = 1<span class="sc">\\</span></span>
<span id="cb1-1262"><a href="#cb1-1262" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb1-1263"><a href="#cb1-1263" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1264"><a href="#cb1-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1265"><a href="#cb1-1265" aria-hidden="true" tabindex="-1"></a>This is the polar dual construction, often used in convex analysis.<span class="ot">[^polar-dual]</span> <span class="co">[</span><span class="ot">@hiriart-urrutyFundamentalsConvexAnalysis2001, Section C.3</span><span class="co">]</span>.</span>
<span id="cb1-1266"><a href="#cb1-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1267"><a href="#cb1-1267" aria-hidden="true" tabindex="-1"></a><span class="ot">[^polar-dual]: </span>What, just because we have not mentioned Legendre transform for a few pages, you would think that we're done with convex analysis? Too bad! If nature is the great optimizer, then convex analysis is inescapable at every turn.</span>
<span id="cb1-1268"><a href="#cb1-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1269"><a href="#cb1-1269" aria-hidden="true" tabindex="-1"></a>The best case is if $K_{particle}$ is convex. In this case, each $k \in K_{wave}$ defines a plane perpendicular to it, at a distance $<span class="sc">\|</span>k<span class="sc">\|</span>^{=1}$ from the origin, and the plane is tangent to $K_{particle}$ at precisely $v^*(k)$, and conversely so. In other words, $K_{particle}$ is the envelope of polar lines to points in $K_{wave}$, and conversely so. </span>
<span id="cb1-1270"><a href="#cb1-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1271"><a href="#cb1-1271" aria-hidden="true" tabindex="-1"></a>Conversely, we can pretend that light is really a wave, and consider how it might appear to someone who believes light is a particle. We would then go through the above argument, and obtain the same result.</span>
<span id="cb1-1272"><a href="#cb1-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1273"><a href="#cb1-1273" aria-hidden="true" tabindex="-1"></a><span class="al">![A pair of polar duals. Both surfaces are convex.](figure/polar_duals_convex.jpg)</span>{width="80%" fig-align="center"}</span>
<span id="cb1-1274"><a href="#cb1-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1275"><a href="#cb1-1275" aria-hidden="true" tabindex="-1"></a>However, we want to deal with more general cases than this, so we need to resolve two issues.</span>
<span id="cb1-1276"><a href="#cb1-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1277"><a href="#cb1-1277" aria-hidden="true" tabindex="-1"></a>First issue: $K_{particle}$ might be non-convex. Second issue: it might be double-sheeted, or even many-sheeted. For example, in crystal, light polarized in two different orientations can move at two different velocities even in the same direction. Thus, its $K_{wave}$ has two sheets, and so its polar dual, $K_{particle}$, also has two sheets.</span>
<span id="cb1-1278"><a href="#cb1-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1279"><a href="#cb1-1279" aria-hidden="true" tabindex="-1"></a>Both issues are solved by extending the definition of polar duality: replace the maximum with a stationarity. We can still construct $K_{particle}$ from $K_{wave}$ by taking a tangent plane for each $k \in K_{wave}$, but now instead of the intersection of the half-planes, we use their envelope. A picture shows what we mean:</span>
<span id="cb1-1280"><a href="#cb1-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1281"><a href="#cb1-1281" aria-hidden="true" tabindex="-1"></a><span class="al">![A pair of polar duals. The surfaces are no longer convex. Notice how the double tangent on the left becomes a double crossing point on the right.](figure/polar_duals_generic.jpg)</span>{width="60%" fig-align="center"}</span>
<span id="cb1-1282"><a href="#cb1-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1283"><a href="#cb1-1283" aria-hidden="true" tabindex="-1"></a><span class="al">![The curve on the right is a trefoil curve defined by $z = 0.3 e^{i\phi} + e^{-2i \phi}$, shifted to make the image clearer. The curve on the left is the polar dual of the trefoil curve. It is the envelope of the polar dual lines of each point on the trefoil curve.](figure/trefoil_dual.svg)</span></span>
<span id="cb1-1284"><a href="#cb1-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1285"><a href="#cb1-1285" aria-hidden="true" tabindex="-1"></a>We still have a duality between points on the two surfaces, defined by stationarity, not optimality. For example, for any wavevector $k \in K_{wave}$, its corresponding dual point $v^*(k)$ satisfies $\lra{v^*(k) + \delta v, k} = 0$ for any $\delta v$ in the tangent space of $K_{particle}$ at $v^*(k)$.</span>
<span id="cb1-1286"><a href="#cb1-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1287"><a href="#cb1-1287" aria-hidden="true" tabindex="-1"></a>The first application of Hamiltonian mechanics was done by Hamilton, who in 1832 predicted theoretically that if light enters a biaxial crystal in just the right way, it will not just refract in one direction, but in an entire *cone* of directions -- which he termed <span class="co">[</span><span class="ot">internal conical refraction</span><span class="co">](https://en.wikipedia.org/wiki/Conical_refraction)</span>. The theory of this is fascinating,<span class="ot">[^conical-neptune]</span> however, for lack of space, we will only give the barest description. </span>
<span id="cb1-1288"><a href="#cb1-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1289"><a href="#cb1-1289" aria-hidden="true" tabindex="-1"></a><span class="ot">[^conical-neptune]: </span>It was historically important as the first phenomenon predicted by mathematical reasoning before experimental observation <span class="co">[</span><span class="ot">@berryChapterConicalDiffraction2007</span><span class="co">]</span>, and it was often compared to the mathematical prediction of Neptune by Le Verrier (1845) <span class="co">[</span><span class="ot">@smithCambridgeNetworkAction1989</span><span class="co">]</span>.</span>
<span id="cb1-1290"><a href="#cb1-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1291"><a href="#cb1-1291" aria-hidden="true" tabindex="-1"></a>Simply put, it turns out that in a biaxial crystal, both $K_{particle}$ and $K_{wave}$ have the same shape of a large blob containing a smaller blob, touching each other at 4 cone-shaped points, as pictured.</span>
<span id="cb1-1292"><a href="#cb1-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1293"><a href="#cb1-1293" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">The shape of the $K_{wave}$ surface. The $K_{particle}$ surface is topologically the same, and can be obtained from $K_{wave}$ by squashing it *just right*. Figure from [@schaeferBandTeilElektrodynamik1949, page 485, figure 128]</span><span class="co">](figure/schaefer_1949_fig_128.png)</span></span>
<span id="cb1-1294"><a href="#cb1-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1295"><a href="#cb1-1295" aria-hidden="true" tabindex="-1"></a>Now, let $k_c \in K_{wave}$ be one of the cone-shaped points, then it corresponds to a tangent plane to $K_{particle}$. Each tangent point $v \in K_{particle}$, conversely, corresponds to a tangent plane to $k_c$.</span>
<span id="cb1-1296"><a href="#cb1-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1297"><a href="#cb1-1297" aria-hidden="true" tabindex="-1"></a>Since $k_c$ is a conical point, however, there are a whole *circle* of tangent planes to $K_{wave}$ at $k_c$. Consequently, the tangent plane to $K_{particle}$ is tangent to it on one entire circle. It is as if we throw a tire on the floor -- it will touch the floor not just at three points, but an entire circle of points. Now, suppose that we have a planar wave moving in the direction of $k_c$ inside the crystal, then each light-particle would have to move in a direction $\argmax_{v \in K_{particle}}\lra{v, k_c}$. But since there is an entire circle of such directions, we would have an entire circle of possible $v$, and thus, we obtain a hollow cone of light.</span>
<span id="cb1-1298"><a href="#cb1-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1299"><a href="#cb1-1299" aria-hidden="true" tabindex="-1"></a><span class="al">![When a planar wave travels in a crystal, such that $K_{particle}$ is tangent to the plane of the wave at an entire circle, then instead of choosing one among the entire circle of velocities, the particles simply take every single possible direction on the circle, resulting in conical refraction.](figure/conical_refraction_tangent_velocity.jpg)</span>{width="50%" fig-align="center"}</span>
<span id="cb1-1300"><a href="#cb1-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1301"><a href="#cb1-1301" aria-hidden="true" tabindex="-1"></a><span class="fu">## The particle-wave duality</span></span>
<span id="cb1-1302"><a href="#cb1-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1303"><a href="#cb1-1303" aria-hidden="true" tabindex="-1"></a><span class="fu">### Particle in free space</span></span>
<span id="cb1-1304"><a href="#cb1-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1305"><a href="#cb1-1305" aria-hidden="true" tabindex="-1"></a>Consider a particle of mass $m$ in free space $\R^n$. Its Lagrangian is $L(t, q, v) = \frac 12 m<span class="sc">\|</span>v<span class="sc">\|</span>^2$. By convex duality, we have</span>
<span id="cb1-1306"><a href="#cb1-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1307"><a href="#cb1-1307" aria-hidden="true" tabindex="-1"></a>$$\begin{cases} L(t, q, v) = \frac 12 m<span class="sc">\|</span>v<span class="sc">\|</span>^2<span class="sc">\\</span> H(t, q, p) = \frac{<span class="sc">\|</span>p<span class="sc">\|</span>^2}{2m} \end{cases}\quad  </span>
<span id="cb1-1308"><a href="#cb1-1308" aria-hidden="true" tabindex="-1"></a>\begin{cases} p^\ast(t, q, v) = mv<span class="sc">\\</span> v^\ast(t, q, p) = \frac{p}{m} \end{cases}$$</span>
<span id="cb1-1309"><a href="#cb1-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1310"><a href="#cb1-1310" aria-hidden="true" tabindex="-1"></a>For any $t_0, q_0, t, q$ with $t_0\neq t$, we can directly solve for the trajectory from $(t_0, q_0)$ to $(t, q)$, then find the action:</span>
<span id="cb1-1311"><a href="#cb1-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1312"><a href="#cb1-1312" aria-hidden="true" tabindex="-1"></a>$$S_{t_0, q_0}(t, q) = \frac 12 m \frac{<span class="sc">\|</span>q-q_0<span class="sc">\|</span>^2}{t-t_0}$$</span>
<span id="cb1-1313"><a href="#cb1-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1314"><a href="#cb1-1314" aria-hidden="true" tabindex="-1"></a>Each $S$ defines a paraboloid wavefront in spacetime, with apex $t_0, q_0$. The wavefront is translation-symmetric, so we set both to zero, yielding the equation of the wavefront:</span>
<span id="cb1-1315"><a href="#cb1-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1316"><a href="#cb1-1316" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1317"><a href="#cb1-1317" aria-hidden="true" tabindex="-1"></a>t = \frac{<span class="sc">\|</span>q<span class="sc">\|</span>^2}{2S/m}</span>
<span id="cb1-1318"><a href="#cb1-1318" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1319"><a href="#cb1-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1320"><a href="#cb1-1320" aria-hidden="true" tabindex="-1"></a>The wavefront of $S = 0$ is just the positive $t$-axis, and as $S$ increases, the wavefront widens out.</span>
<span id="cb1-1321"><a href="#cb1-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1322"><a href="#cb1-1322" aria-hidden="true" tabindex="-1"></a>Now, we interpret this wave from the HJE point of view. Let's say we have the wavefront at $S=S_0$, and we want to construct the wavefront at $S = S_0 + \delta S$. This we perform by rippling out a little wavelet at each point $(t', q')$ on the wavefront. The little wavelet has shape $(t-t') = \frac{<span class="sc">\|</span>q - q'<span class="sc">\|</span>^2}{2\delta S/m}$, and as we move $t', q'$ around the parabola of wavefront $S = S_0$, the envelope of these wavelets is the wavefront of $S = S_0 + \delta S$.</span>
<span id="cb1-1323"><a href="#cb1-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1324"><a href="#cb1-1324" aria-hidden="true" tabindex="-1"></a>This is the wave point of view. We can switch back to the particle point of view. What is the velocity of the particle passing the point $(t', q')$? We know that it must be traveling in the optimal direction, and the optimal direction allows it to go as far as possible. Therefore, we simply draw the wavelet of $\delta S$ at $(t', q')$, then find the intersection of the wavelet with the wavefront of $S = S_0 + \delta S$.</span>
<span id="cb1-1325"><a href="#cb1-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1326"><a href="#cb1-1326" aria-hidden="true" tabindex="-1"></a>The entire procedure is pictured below.</span>
<span id="cb1-1327"><a href="#cb1-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1328"><a href="#cb1-1328" aria-hidden="true" tabindex="-1"></a><span class="al">![The two red curves are two wavefronts $S = S_0$ and $S = S_0 + \delta S$. At select points on the first wavefront, we draw a wavelet of $\delta S$, which is tangent to the second wavefront. The particle trajectory connects the point and the tangent point of the wavelet with the second wavefront.](figure/free_particle_point_source.svg)</span></span>
<span id="cb1-1329"><a href="#cb1-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1330"><a href="#cb1-1330" aria-hidden="true" tabindex="-1"></a><span class="fu">### Particle-wave in free space</span></span>
<span id="cb1-1331"><a href="#cb1-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1332"><a href="#cb1-1332" aria-hidden="true" tabindex="-1"></a>The paraboloid-shaped solution for $S$ is interpretable in Newtonian mechanics, as the motion of a single particle moving from the origin. However, the HJE itself is merely a PDE with its own logic and meaning, and consequently, it may have different solutions that are hard to to interpret in Newtonian mechanics.</span>
<span id="cb1-1333"><a href="#cb1-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1334"><a href="#cb1-1334" aria-hidden="true" tabindex="-1"></a>From our 21st-century perspective, we can say that the HJE is generally true, and Newtonian mechanics is only a special case. Some solutions to the HJE may not be interpretable in Newtonian mechanics, but they are nevertheless physically real, since Newtonian mechanics is incomplete. Given that, we simply try to solve HJE, then try to interpret it, even if not in Newtonian mechanics.</span>
<span id="cb1-1335"><a href="#cb1-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1336"><a href="#cb1-1336" aria-hidden="true" tabindex="-1"></a>Because the Lagrangian is time-independent, so any <span class="co">[</span><span class="ot">time-independent solution</span><span class="co">](#eq-THJE)</span>:</span>
<span id="cb1-1337"><a href="#cb1-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1338"><a href="#cb1-1338" aria-hidden="true" tabindex="-1"></a>$$S(t, q) = W(q) - Et, \quad <span class="sc">\|</span> \nabla_q W <span class="sc">\|</span> = \sqrt{2mE}$$</span>
<span id="cb1-1339"><a href="#cb1-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1340"><a href="#cb1-1340" aria-hidden="true" tabindex="-1"></a>for any constant $E &gt; 0$ also gives a solution to the HJE. This is just the eikonal equation for a medium of constant wave speed! More on this in <span class="co">[</span><span class="ot">the section on geometric optics</span><span class="co">](#sec-geometric-optics)</span>. One can of course solve the eikonal equation by putting it into a numerical package and let it grind out the solution. However, we can interpret it by the Huygens principle.</span>
<span id="cb1-1341"><a href="#cb1-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1342"><a href="#cb1-1342" aria-hidden="true" tabindex="-1"></a>Suppose you know a surface of constant $W = W_0$, and you know that the arrows of $\nabla_q W$ point outwards, then since $\nabla W$ is perpendicular to the surface, and is of constant length $\sqrt{2mE}$, you can step out a small distance $ds$ perpendicularly out of the whole surface $W= W_0$, and arrive at the surface of $W=W_0 + \sqrt{2mE} ds$. Alternatively, you can draw small spheres of radius $ds$, and their outwards envelope is the $W=W_0+ \sqrt{2mE} ds$ surface. These procedures are equivalent, but in one, we constructed "rays" while the other we constructed "wave fronts".</span>
<span id="cb1-1343"><a href="#cb1-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1344"><a href="#cb1-1344" aria-hidden="true" tabindex="-1"></a>For the free particle, the simplest solution is the plane wave:</span>
<span id="cb1-1345"><a href="#cb1-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1346"><a href="#cb1-1346" aria-hidden="true" tabindex="-1"></a>$$W(q) = \sqrt{2mE} \langle \hat k, q \rangle$$</span>
<span id="cb1-1347"><a href="#cb1-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1348"><a href="#cb1-1348" aria-hidden="true" tabindex="-1"></a>where $\hat k$ is any unit-vector, interpreted as the direction of wave propagation. Plugging it back to @eq-HJ, we find that the "planar wave particle" has</span>
<span id="cb1-1349"><a href="#cb1-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1350"><a href="#cb1-1350" aria-hidden="true" tabindex="-1"></a>$$(\partial_t S, \nabla S) = (-H, p) = (-E, \sqrt{2mE}\hat k)$$</span>
<span id="cb1-1351"><a href="#cb1-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1352"><a href="#cb1-1352" aria-hidden="true" tabindex="-1"></a>where $\hat k$ is the direction of the group velocity of the wave. The group velocity of the wave is $\frac{\partial_t S}{\nabla S} = \frac{E}{\sqrt{2mE}}\hat k$.</span>
<span id="cb1-1353"><a href="#cb1-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1354"><a href="#cb1-1354" aria-hidden="true" tabindex="-1"></a><span class="al">![The two red curves are two wavefronts $S = S_0$ and $S = S_0 + \delta S$. At select points on the first wavefront, we draw a wavelet of $\delta S$, which is tangent to the second wavefront. The particle trajectory connects the point and the tangent point of the wavelet with the second wavefront.](figure/free_particle_planar_wave.svg)</span></span>
<span id="cb1-1355"><a href="#cb1-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1356"><a href="#cb1-1356" aria-hidden="true" tabindex="-1"></a>Taking the particle-wave analogy seriously, we say that:</span>
<span id="cb1-1357"><a href="#cb1-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1358"><a href="#cb1-1358" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>a planar wave is a particle with energy $E$ and momentum $p \propto k \propto \sqrt{2mE} \hat k$.</span>
<span id="cb1-1359"><a href="#cb1-1359" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>a particle with energy $E$ and momentum $p$ is a planar wave traveling at group velocity $E/p$.</span>
<span id="cb1-1360"><a href="#cb1-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1361"><a href="#cb1-1361" aria-hidden="true" tabindex="-1"></a>Typically, waves have a wavelength $\lambda$, which is related to the wave vector $k$ by $k \propto \lambda^{-1}$, we find that the particle has wavelength $\lambda \propto \frac 1k \propto \frac 1p$. Thus, we arrived at de Broglie's matter-wave hypothesis, which Schrödinger expanded into his equation. Both de Broglie and Schrödinger were inspired by Hamilton's optics-mechanics analogy, so we are treading the same path as them a century ago.</span>
<span id="cb1-1362"><a href="#cb1-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1363"><a href="#cb1-1363" aria-hidden="true" tabindex="-1"></a>In fact, we could start with an arbitrary wavefront in configuration-spacetime, and use Huygens' principle to construct the wavefront in the next moment. In general, we can't do Fourier analysis on such wavefronts -- they are not decomposable into planar waves, because the HJE is a nonlinear equation. Fourier analysis only works on linear differential equations.</span>
<span id="cb1-1364"><a href="#cb1-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1365"><a href="#cb1-1365" aria-hidden="true" tabindex="-1"></a><span class="al">![Given a wavefront in the shape of $t = q^3$, we can construct the next wavefront as the envelope of the parabolic wavelets at every point on the wavefront.](figure/free_particle_cubic_curve.svg)</span></span>
<span id="cb1-1366"><a href="#cb1-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1367"><a href="#cb1-1367" aria-hidden="true" tabindex="-1"></a><span class="fu">### Particle in a potential field</span></span>
<span id="cb1-1368"><a href="#cb1-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1369"><a href="#cb1-1369" aria-hidden="true" tabindex="-1"></a>A particle in a time-dependent potential field $V$ has Lagrangian $L(t, q, v) = \frac 12 m<span class="sc">\|</span>v<span class="sc">\|</span>^2 - V(t, q)$. By convex duality</span>
<span id="cb1-1370"><a href="#cb1-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1371"><a href="#cb1-1371" aria-hidden="true" tabindex="-1"></a>$$\begin{cases}     </span>
<span id="cb1-1372"><a href="#cb1-1372" aria-hidden="true" tabindex="-1"></a>L(t, q, v) = \frac 12 m<span class="sc">\|</span>v<span class="sc">\|</span>^2 - V(t, q)<span class="sc">\\</span>     </span>
<span id="cb1-1373"><a href="#cb1-1373" aria-hidden="true" tabindex="-1"></a>H(t, q, p) = \frac{<span class="sc">\|</span>p<span class="sc">\|</span>^2}{2m} + V(t, q) </span>
<span id="cb1-1374"><a href="#cb1-1374" aria-hidden="true" tabindex="-1"></a>\end{cases} \quad </span>
<span id="cb1-1375"><a href="#cb1-1375" aria-hidden="true" tabindex="-1"></a>\begin{cases}     </span>
<span id="cb1-1376"><a href="#cb1-1376" aria-hidden="true" tabindex="-1"></a>p^\ast = mv <span class="sc">\\</span>     </span>
<span id="cb1-1377"><a href="#cb1-1377" aria-hidden="true" tabindex="-1"></a>v^\ast = \frac pm </span>
<span id="cb1-1378"><a href="#cb1-1378" aria-hidden="true" tabindex="-1"></a>\end{cases}$$</span>
<span id="cb1-1379"><a href="#cb1-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1380"><a href="#cb1-1380" aria-hidden="true" tabindex="-1"></a>The HJE gives</span>
<span id="cb1-1381"><a href="#cb1-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1382"><a href="#cb1-1382" aria-hidden="true" tabindex="-1"></a>$$\partial_t S + \frac 1{2m} <span class="sc">\|</span>\nabla_q S<span class="sc">\|</span>^2 = -V(t, q)$$</span>
<span id="cb1-1383"><a href="#cb1-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1384"><a href="#cb1-1384" aria-hidden="true" tabindex="-1"></a>As before, if we interpret the equation as a wave equation, then the group velocity is $\frac{\partial_t S}{\nabla S} = \frac{-E}{p} \hat k$, with magnitude $v_g = \frac{E}{\sqrt{2m(E-V)}}$.</span>
<span id="cb1-1385"><a href="#cb1-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1386"><a href="#cb1-1386" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Example: particle in free fall" collapse="true"}</span>
<span id="cb1-1387"><a href="#cb1-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1388"><a href="#cb1-1388" aria-hidden="true" tabindex="-1"></a>We consider the classical problem of a body in free fall, thrown from the origin $(t, q) = (0, 0)$. Basic physics tells us that the position and velocity of the body are given by</span>
<span id="cb1-1389"><a href="#cb1-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1390"><a href="#cb1-1390" aria-hidden="true" tabindex="-1"></a>$$q(t) = v_0 t - \frac{1}{2}gt^2, \quad v = v_0 - gt = \frac{q}{t} - \frac{1}{2}gt$$</span>
<span id="cb1-1391"><a href="#cb1-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1392"><a href="#cb1-1392" aria-hidden="true" tabindex="-1"></a>Plugging these expressions into the Hamilton-Jacobi equation, we obtain a system of partial differential equations for the action function $S$:</span>
<span id="cb1-1393"><a href="#cb1-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1394"><a href="#cb1-1394" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1395"><a href="#cb1-1395" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb1-1396"><a href="#cb1-1396" aria-hidden="true" tabindex="-1"></a>\partial_t S &amp;= -H = -\frac{1}{2}m(\frac{q}{t} - \frac{gt}{2})^2 - mgq <span class="sc">\\</span></span>
<span id="cb1-1397"><a href="#cb1-1397" aria-hidden="true" tabindex="-1"></a>\partial_q S &amp;= m(\frac{q}{t} - gt)</span>
<span id="cb1-1398"><a href="#cb1-1398" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb1-1399"><a href="#cb1-1399" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1400"><a href="#cb1-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1401"><a href="#cb1-1401" aria-hidden="true" tabindex="-1"></a>Solving this system, we find the unique solution for the action:</span>
<span id="cb1-1402"><a href="#cb1-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1403"><a href="#cb1-1403" aria-hidden="true" tabindex="-1"></a>$$S = \frac{x^2}{y} - xy - \frac{y^3}{12}$$</span>
<span id="cb1-1404"><a href="#cb1-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1405"><a href="#cb1-1405" aria-hidden="true" tabindex="-1"></a>where we have introduced convenience variables $x = gq$, $y = gt$, and $s = \frac{2gS}{m}$.</span>
<span id="cb1-1406"><a href="#cb1-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1407"><a href="#cb1-1407" aria-hidden="true" tabindex="-1"></a>The contour lines of the action function satisfy the equation:</span>
<span id="cb1-1408"><a href="#cb1-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1409"><a href="#cb1-1409" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1410"><a href="#cb1-1410" aria-hidden="true" tabindex="-1"></a>x = \frac{1}{2}y^2 \pm \sqrt{\frac{1}{3}y^4 + sy}</span>
<span id="cb1-1411"><a href="#cb1-1411" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1412"><a href="#cb1-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1413"><a href="#cb1-1413" aria-hidden="true" tabindex="-1"></a>To analyze the wavelet associated with this system, we start by writing down the Lagrangian:</span>
<span id="cb1-1414"><a href="#cb1-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1415"><a href="#cb1-1415" aria-hidden="true" tabindex="-1"></a>$$L = T - V = \frac{1}{2}m(\frac{\delta q}{\delta t})^2 - mgq$$</span>
<span id="cb1-1416"><a href="#cb1-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1417"><a href="#cb1-1417" aria-hidden="true" tabindex="-1"></a>The wavelet equation is then given by:</span>
<span id="cb1-1418"><a href="#cb1-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1419"><a href="#cb1-1419" aria-hidden="true" tabindex="-1"></a>$$\delta S = L \delta t = \left(\frac{1}{2}m(\frac{\delta q}{\delta t})^2 - mgq\right)\delta t$$</span>
<span id="cb1-1420"><a href="#cb1-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1421"><a href="#cb1-1421" aria-hidden="true" tabindex="-1"></a>Simplifying this equation using our convenience variables, we get:</span>
<span id="cb1-1422"><a href="#cb1-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1423"><a href="#cb1-1423" aria-hidden="true" tabindex="-1"></a>$$(\delta x)^2 = 2x(\delta y)^2 + \delta s \delta y$$</span>
<span id="cb1-1424"><a href="#cb1-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1425"><a href="#cb1-1425" aria-hidden="true" tabindex="-1"></a>Solving for $\delta y$, we obtain:</span>
<span id="cb1-1426"><a href="#cb1-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1427"><a href="#cb1-1427" aria-hidden="true" tabindex="-1"></a>$$\delta y = \frac{-\delta s \pm \sqrt{(\delta s)^2 + 8x(\delta x)^2}}{4x}$$</span>
<span id="cb1-1428"><a href="#cb1-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1429"><a href="#cb1-1429" aria-hidden="true" tabindex="-1"></a>This equation reveals the nature of the wavelet. When $x &gt; 0$, the equation describes a hyperbola. For $x &lt; 0$, it describes an ellipse. At the boundary $x = 0$, the equation describes a parabola.</span>
<span id="cb1-1430"><a href="#cb1-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1431"><a href="#cb1-1431" aria-hidden="true" tabindex="-1"></a><span class="al">![](figure/falling_particle_point_source.svg)</span></span>
<span id="cb1-1432"><a href="#cb1-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1433"><a href="#cb1-1433" aria-hidden="true" tabindex="-1"></a>There is no planar wave solution, because a planar wave solution is both constant energy and unbounded, whereas if a particle can move infinitely far away, it must have infinite energy. If we attempt to force a planar wave solution, it would immediately break down:</span>
<span id="cb1-1434"><a href="#cb1-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1435"><a href="#cb1-1435" aria-hidden="true" tabindex="-1"></a><span class="al">![](figure/falling_particle_planar_wave.svg)</span></span>
<span id="cb1-1436"><a href="#cb1-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1437"><a href="#cb1-1437" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1438"><a href="#cb1-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1439"><a href="#cb1-1439" aria-hidden="true" tabindex="-1"></a>::: {#exr-0}</span>
<span id="cb1-1440"><a href="#cb1-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1441"><a href="#cb1-1441" aria-hidden="true" tabindex="-1"></a>Solve the time-independent HJE for the particle in free fall. It should be $S = W(q) - Et$, where $E$ is a constant, and $W$ is a <span class="co">[</span><span class="ot">semicubical parabola</span><span class="co">](https://en.wikipedia.org/wiki/Semicubical_parabola)</span>.</span>
<span id="cb1-1442"><a href="#cb1-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1443"><a href="#cb1-1443" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1444"><a href="#cb1-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1445"><a href="#cb1-1445" aria-hidden="true" tabindex="-1"></a>::: {#exr-0}</span>
<span id="cb1-1446"><a href="#cb1-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1447"><a href="#cb1-1447" aria-hidden="true" tabindex="-1"></a>In the same way, analyze the simple harmonic oscillator -- a particle in a potential well $V = \frac 12 kq^2$. Similarly, it cannot have a planar wave solution. Plot the wavelets along each point on a planar wave, and see how it breaks down. Find two families of solutions: The case where we have a point source at $(0, 0)$, and the case of time-independent HJE.</span>
<span id="cb1-1448"><a href="#cb1-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1449"><a href="#cb1-1449" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1450"><a href="#cb1-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1451"><a href="#cb1-1451" aria-hidden="true" tabindex="-1"></a><span class="fu">### Deriving the time-independent Schrödinger equation</span></span>
<span id="cb1-1452"><a href="#cb1-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1453"><a href="#cb1-1453" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">small</span><span class="dt">&gt;</span>This section based on <span class="co">[</span><span class="ot">@masoliverClassicalQuantumMechanics2009; @derbesFeynmanDerivationSchrodinger1996; @hamillStudentGuideLagrangians2013, section 6.4</span><span class="co">]</span>.<span class="dt">&lt;/</span><span class="kw">small</span><span class="dt">&gt;</span></span>
<span id="cb1-1454"><a href="#cb1-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1455"><a href="#cb1-1455" aria-hidden="true" tabindex="-1"></a>Assume that the potential is time-independent: $V(t, q) = V(q)$. Assume that the physical system can be described by a function</span>
<span id="cb1-1456"><a href="#cb1-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1457"><a href="#cb1-1457" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1458"><a href="#cb1-1458" aria-hidden="true" tabindex="-1"></a>\Psi(t, q) = \Psi_0(r) e^{iS(t, q)/\hbar}</span>
<span id="cb1-1459"><a href="#cb1-1459" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1460"><a href="#cb1-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1461"><a href="#cb1-1461" aria-hidden="true" tabindex="-1"></a>where the function $\Psi$ is typically called the "wave function".<span class="ot">[^wave-function-meaning]</span> We assume that the wave is a "standing wave", so that all of space is oscillating in sync. Let $S(t, q) = W(q) - Et$, so that the oscillation frequency is $E/\hbar$.<span class="ot">[^standing-wave]</span></span>
<span id="cb1-1462"><a href="#cb1-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1463"><a href="#cb1-1463" aria-hidden="true" tabindex="-1"></a><span class="ot">[^wave-function-meaning]: </span>What is a wave function? It is just some abstract mathematical object, that somehow allows us to calculate everything we want to know about this system. We have no idea what it is, but it works. The same applies to the function $S(t, q)$. We call it the "minimal cost" for arriving at $(t, q)$, but what really is a cost in physics? Particles do not really pay their paths with natural money. All this time, we have pretended that they pay some kind of cost and want to minimize the cost, but it is really just one big analogy. The same applies for the function $\Psi$. We might call it a "wave function", but it really is just one big analogy with the waves on an ocean. There is really no wave in quantum mechanics, only a function that we pretend is a wave, because it helps us calculate results that happen to be correct.</span>
<span id="cb1-1464"><a href="#cb1-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1465"><a href="#cb1-1465" aria-hidden="true" tabindex="-1"></a><span class="ot">[^standing-wave]: </span>The most important experimental result from quantum mechanics is that energy levels are quantized. Now, a quantized energy level is something like $E = h, 2h, 3h, \dots$. There is really just one kind of thing in classical mechanics that is quantized: standing waves! If you have a string, then its standing waves must have $0, 1, 2, 3, \dots$ nodes, i.e. quantized. Thus, it is natural to try out this "standing wave" assumption.</span>
<span id="cb1-1466"><a href="#cb1-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1467"><a href="#cb1-1467" aria-hidden="true" tabindex="-1"></a>So, we can separate the variables to</span>
<span id="cb1-1468"><a href="#cb1-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1469"><a href="#cb1-1469" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1470"><a href="#cb1-1470" aria-hidden="true" tabindex="-1"></a>\Psi(t, q) = \ub{e^{-i\frac{E}{\hbar}t}}{oscillation in sync} \ub{\psi(q)}{variation over space}, \quad \psi(q) = \Psi_0(q) e^{i\frac{W(q)}{\hbar}t}</span>
<span id="cb1-1471"><a href="#cb1-1471" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1472"><a href="#cb1-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1473"><a href="#cb1-1473" aria-hidden="true" tabindex="-1"></a>Since $\Psi$ should be a wave, it has better follow the wave equations:</span>
<span id="cb1-1474"><a href="#cb1-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1475"><a href="#cb1-1475" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1476"><a href="#cb1-1476" aria-hidden="true" tabindex="-1"></a>(\partial_t^2 - v_g^2 \nabla^2)\Psi = 0</span>
<span id="cb1-1477"><a href="#cb1-1477" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1478"><a href="#cb1-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1479"><a href="#cb1-1479" aria-hidden="true" tabindex="-1"></a>where $v_g$ is the group velocity of the wave. As we saw previously, $v_g = \frac{E}{\sqrt{2m(E-V)}}$ for a particle in a potential. Then we have</span>
<span id="cb1-1480"><a href="#cb1-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1481"><a href="#cb1-1481" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1482"><a href="#cb1-1482" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb1-1483"><a href="#cb1-1483" aria-hidden="true" tabindex="-1"></a>\Psi(t, q) &amp;= e^{-i\frac{E}{\hbar} t} \psi(q), <span class="sc">\\</span></span>
<span id="cb1-1484"><a href="#cb1-1484" aria-hidden="true" tabindex="-1"></a>0 &amp;= (\partial_t^2 - v_g^2 \nabla^2)\Psi, <span class="sc">\\</span></span>
<span id="cb1-1485"><a href="#cb1-1485" aria-hidden="true" tabindex="-1"></a>v_g &amp;= \frac{E}{\sqrt{2m(E-V)}},</span>
<span id="cb1-1486"><a href="#cb1-1486" aria-hidden="true" tabindex="-1"></a>\end{cases}\;\; \implies \frac{\hbar^2}{2 m} \nabla^2 \psi+(E-V) \psi = 0,</span>
<span id="cb1-1487"><a href="#cb1-1487" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1488"><a href="#cb1-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1489"><a href="#cb1-1489" aria-hidden="true" tabindex="-1"></a>which is the time-independent Schrödinger equation.</span>
<span id="cb1-1490"><a href="#cb1-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1491"><a href="#cb1-1491" aria-hidden="true" tabindex="-1"></a>::: {#exr-0}</span>
<span id="cb1-1492"><a href="#cb1-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1493"><a href="#cb1-1493" aria-hidden="true" tabindex="-1"></a>The time-dependent Schrödinger equation states that </span>
<span id="cb1-1494"><a href="#cb1-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1495"><a href="#cb1-1495" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1496"><a href="#cb1-1496" aria-hidden="true" tabindex="-1"></a>i\hbar\frac{\partial}{\partial t} \Psi(t, q) = \left <span class="co">[</span><span class="ot"> - \frac{\hbar^2}{2m}\nabla^2 + V(t, q)\right </span><span class="co">]</span> \Psi(t, q).</span>
<span id="cb1-1497"><a href="#cb1-1497" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1498"><a href="#cb1-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1499"><a href="#cb1-1499" aria-hidden="true" tabindex="-1"></a>Plug $\Psi(t, q) = \psi_0(t, q) e^{i S(t, q)/\hbar}$ back to the time-dependent Schrödinger equation, and check that at the $\hbar \to 0$ limit, we recover the HJE for $S(t, q)$. This is a simple example of the <span class="co">[</span><span class="ot">WKB approximation</span><span class="co">](https://en.wikipedia.org/wiki/WKB_approximation)</span>.</span>
<span id="cb1-1500"><a href="#cb1-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1501"><a href="#cb1-1501" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1502"><a href="#cb1-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1503"><a href="#cb1-1503" aria-hidden="true" tabindex="-1"></a>If the above derivation looks mildly suspect, and leaves you with a feeling of seeing a magic trick, it is not an accident. The analogy between classical mechanics and quantum mechanics is not exact, so we cannot logically derive quantum mechanics from classical mechanics. The simple problem is that classical mechanics, even when formulated in the form of Hamilton--Jacobi wave equations, cannot reproduce interference or diffractions. Consider the simple case of a straight-edge diffraction. If you aim a light beam at a sharp edge, then on the other side, there would be alternating bright and dark bands fading into the shadow. However, if light is going by the shortest path, then there should be no such banding, and the brightness should just drop off to zero monotonically.</span>
<span id="cb1-1504"><a href="#cb1-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1505"><a href="#cb1-1505" aria-hidden="true" tabindex="-1"></a><span class="al">![In classical mechanics, the shadow of a hard edge has no diffractive stripes.](figure/no_classical_diffraction.jpg)</span>{width="60%" fig-align="center"}</span>
<span id="cb1-1506"><a href="#cb1-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1507"><a href="#cb1-1507" aria-hidden="true" tabindex="-1"></a>The solution is to admit that geometric optics is insufficient, that Huygens' principle is insufficient, and we need a full theory of light wave in order to explain what happens on the smallest scales -- a diffraction theory. Similarly, classical mechanics is insufficient, and the HJE is insufficient, and we need a full theory of matter wave in order to explain what happens in the atomic world -- quantum mechanics.</span>
<span id="cb1-1508"><a href="#cb1-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1509"><a href="#cb1-1509" aria-hidden="true" tabindex="-1"></a><span class="al">![The optical-mechanical analogy at three levels. There is a question mark, because I'm not sure if that should be quantum field theory.](figure/optical-mechanical_analogy.png)</span></span>
<span id="cb1-1510"><a href="#cb1-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1511"><a href="#cb1-1511" aria-hidden="true" tabindex="-1"></a>Deriving quantum mechanics from classical mechanics is necessarily fraught with danger and luck, because in going from quantum mechanics to classical mechanics, something is irrevocably lost (and other things are irrevocably earned). It is about as difficult as going from geometric optics to wave optics. Still, several people have tried and succeeded, most famously, Schrödinger.</span>
<span id="cb1-1512"><a href="#cb1-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1513"><a href="#cb1-1513" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ... the conception of rays is thoroughly well defined only in pure abstract geometrical optics. It is wholly incapable of being applied to the fine structure of real optical phenomena, i.e. to the phenomena of diffraction. Even in extending geometrical optics somewhat by adding the notion of Huygens' principle, one is not able to account for the most simple phenomena of diffraction without adding some further very strange rules concerning the circumstances under which Huygens' envelope-surface is or is not physically significant. (I mean the construction of "Fresnel's zones".) These rules would be wholly incomprehensible to one versed in geometrical optics alone. Furthermore it may be observed that the notions which are fundamental to real physical optics, i.e. the wave-function itself ($W$ is merely the phase), the equation of wave-propagation, the wave length and frequency of the waves, do not enter at all into the above stated analogy. </span></span>
<span id="cb1-1514"><a href="#cb1-1514" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span></span>
<span id="cb1-1515"><a href="#cb1-1515" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="co">[</span><span class="ot">@schrodingerUndulatoryTheoryMechanics1926</span><span class="co">]</span></span>
<span id="cb1-1516"><a href="#cb1-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1517"><a href="#cb1-1517" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ... geometrical optics is only an approximation... when interference and diffraction phenomena are involved, it is quite inadequate. This prompted the thought that classical mechanics is also only an approximation relative to a vaster wave mechanics. ... A new mechanics must be developed which is to classical mechanics what wave optics is to geometrical optics. This new mechanics has since been developed, thanks mainly to the fine work done by Schrödinger.</span></span>
<span id="cb1-1518"><a href="#cb1-1518" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb1-1519"><a href="#cb1-1519" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Louis de Broglie's Nobel Prize Lecture </span><span class="co">[</span><span class="ot">@debroglieWaveNatureElectron1929</span><span class="co">]</span></span>
<span id="cb1-1520"><a href="#cb1-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1521"><a href="#cb1-1521" aria-hidden="true" tabindex="-1"></a><span class="fu">### Relativistic particle in free space</span></span>
<span id="cb1-1522"><a href="#cb1-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1523"><a href="#cb1-1523" aria-hidden="true" tabindex="-1"></a>Since the HJE is fully general for any function $L(t, q, v)$ that is smooth and strictly convex in $v$, we can simply write down the Lagrangian for relativistic particle in a field, and it would *just work*.</span>
<span id="cb1-1524"><a href="#cb1-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1525"><a href="#cb1-1525" aria-hidden="true" tabindex="-1"></a>Let's first consider particle in free space. In relativity, the one thing that is coordinate-independent is the proper time of a trajectory, so it is reasonable to *guess* that the action is the proper time, then deduce from it the Lagrangian. This is natural if we think of $S$ as the optimal cost of traveling.</span>
<span id="cb1-1526"><a href="#cb1-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1527"><a href="#cb1-1527" aria-hidden="true" tabindex="-1"></a>Let $t_0 = 0, q_0 = 0$, then by basic relativity, the proper time for the particle to arrive at $(t, q)$ is</span>
<span id="cb1-1528"><a href="#cb1-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1529"><a href="#cb1-1529" aria-hidden="true" tabindex="-1"></a>$$S(t, q) = \frac{<span class="sc">\|</span>q<span class="sc">\|</span>}{v\gamma} = \sqrt{t^2- \frac{<span class="sc">\|</span>q<span class="sc">\|</span>^2}{c^2}}$$</span>
<span id="cb1-1530"><a href="#cb1-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1531"><a href="#cb1-1531" aria-hidden="true" tabindex="-1"></a>where $\gamma = \frac{1}{\sqrt{1-v^2/c^2}}$ is the well-known factor used everywhere in special relativity.</span>
<span id="cb1-1532"><a href="#cb1-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1533"><a href="#cb1-1533" aria-hidden="true" tabindex="-1"></a>Taking $\nabla_q$, and simplifying, we find the relativistic momentum to be<span class="sc">\.</span>..</span>
<span id="cb1-1534"><a href="#cb1-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1535"><a href="#cb1-1535" aria-hidden="true" tabindex="-1"></a>$$p = \nabla_q S = -\frac{\gamma v}{c^2}$$</span>
<span id="cb1-1536"><a href="#cb1-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1537"><a href="#cb1-1537" aria-hidden="true" tabindex="-1"></a>However, we were expecting $p \to mv$ when $v \to 0$, so we fix this issue by multiplying the action with a constant factor $-mc^2$. Multiplying a constant factor in action has no effect on the calculus of variations, so we are free to do this. Thus we find that the action of a path is the proper time of the path multiplied by $-mc^2$:</span>
<span id="cb1-1538"><a href="#cb1-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1539"><a href="#cb1-1539" aria-hidden="true" tabindex="-1"></a>$$S(\text{path}) = -mc^2 \int_{\text{path}}d\tau = -mc^2 \int_{\text{path}}\frac 1\gamma dt$$</span>
<span id="cb1-1540"><a href="#cb1-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1541"><a href="#cb1-1541" aria-hidden="true" tabindex="-1"></a>With this, we can derive the familiar equations by the HJE and convex duality:</span>
<span id="cb1-1542"><a href="#cb1-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1543"><a href="#cb1-1543" aria-hidden="true" tabindex="-1"></a>$$\begin{cases}</span>
<span id="cb1-1544"><a href="#cb1-1544" aria-hidden="true" tabindex="-1"></a>L(q, v) = -\frac{mc^2}{\gamma}<span class="sc">\\</span>     </span>
<span id="cb1-1545"><a href="#cb1-1545" aria-hidden="true" tabindex="-1"></a>H(q, p) = \sqrt{(<span class="sc">\|</span>p<span class="sc">\|</span>c)^2 + (mc^2)^2}</span>
<span id="cb1-1546"><a href="#cb1-1546" aria-hidden="true" tabindex="-1"></a>\end{cases} \quad </span>
<span id="cb1-1547"><a href="#cb1-1547" aria-hidden="true" tabindex="-1"></a>\begin{cases}     </span>
<span id="cb1-1548"><a href="#cb1-1548" aria-hidden="true" tabindex="-1"></a>p^\ast = \gamma mv <span class="sc">\\</span>     </span>
<span id="cb1-1549"><a href="#cb1-1549" aria-hidden="true" tabindex="-1"></a>v^\ast = \frac{pc}{\sqrt{<span class="sc">\|</span>p<span class="sc">\|</span>^2 + (mc)^2}} </span>
<span id="cb1-1550"><a href="#cb1-1550" aria-hidden="true" tabindex="-1"></a>\end{cases}$$</span>
<span id="cb1-1551"><a href="#cb1-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1552"><a href="#cb1-1552" aria-hidden="true" tabindex="-1"></a>In particular, at low $v$, we have $L \approx -mc^2 + \frac 12 m<span class="sc">\|</span>v<span class="sc">\|</span>^2$. So somehow, by combining the *geometry* of spacetime with analytical mechanics, we have discovered the $E = mc^2$ formula, even though it seems like something we couldn't have discovered from mere geometry.</span>
<span id="cb1-1553"><a href="#cb1-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1554"><a href="#cb1-1554" aria-hidden="true" tabindex="-1"></a>The HJE then becomes</span>
<span id="cb1-1555"><a href="#cb1-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1556"><a href="#cb1-1556" aria-hidden="true" tabindex="-1"></a>$$\frac 1{c^2} \left(\partial_t S \right)^2 - <span class="sc">\|</span>\nabla S <span class="sc">\|</span>^2 = m^2 c^2$$</span>
<span id="cb1-1557"><a href="#cb1-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1558"><a href="#cb1-1558" aria-hidden="true" tabindex="-1"></a>In particular, the time-independent solutions are of the form</span>
<span id="cb1-1559"><a href="#cb1-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1560"><a href="#cb1-1560" aria-hidden="true" tabindex="-1"></a>$$S = W(q)-Et, \quad <span class="sc">\|</span> \nabla W <span class="sc">\|</span> = \frac 1c \sqrt{E^2 - m^2 c^4 }$$</span>
<span id="cb1-1561"><a href="#cb1-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1562"><a href="#cb1-1562" aria-hidden="true" tabindex="-1"></a>for any $E &gt; mc^2$. In particular, if we plug in the usual relativistic energy $E = \gamma mc^2$, we get</span>
<span id="cb1-1563"><a href="#cb1-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1564"><a href="#cb1-1564" aria-hidden="true" tabindex="-1"></a>$$<span class="sc">\|</span> \nabla W <span class="sc">\|</span> = \gamma mv$$</span>
<span id="cb1-1565"><a href="#cb1-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1566"><a href="#cb1-1566" aria-hidden="true" tabindex="-1"></a>which is similar to what we obtained for the free particle in classical mechanics, with $<span class="sc">\|</span>\nabla W <span class="sc">\|</span> = \sqrt{2mE}$, just with classical momentum upgraded to relativistic momentum.</span>
<span id="cb1-1567"><a href="#cb1-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1568"><a href="#cb1-1568" aria-hidden="true" tabindex="-1"></a>::: {#exr-0}</span>
<span id="cb1-1569"><a href="#cb1-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1570"><a href="#cb1-1570" aria-hidden="true" tabindex="-1"></a>Just as how the HJE of a classical particle can be derived as the $\hbar \to 0$ limit of the Schrödinger equation, one can derive the HJE of the non-quantum relativistic particle as the $\hbar \to 0$ limit of the Klein--Gordon equation. The Klein--Gordon equation is essentially the simplest possible way to combine special relativity with Schrödinger equation:</span>
<span id="cb1-1571"><a href="#cb1-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1572"><a href="#cb1-1572" aria-hidden="true" tabindex="-1"></a>$$\left( \frac{1}{c^2} \frac{\partial^2}{\partial t^2} - \nabla^2 + \frac{m^2 c^2}{\hbar^2} \right) \psi(t, \mathbf{x}) = 0$$</span>
<span id="cb1-1573"><a href="#cb1-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1574"><a href="#cb1-1574" aria-hidden="true" tabindex="-1"></a>Plug in $\psi(t, q) = \psi_0(q, t) e^{i S(t, q) / \hbar}$, and check that at $\hbar \to 0$ limit, we recover the HJE.</span>
<span id="cb1-1575"><a href="#cb1-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1576"><a href="#cb1-1576" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1577"><a href="#cb1-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1578"><a href="#cb1-1578" aria-hidden="true" tabindex="-1"></a><span class="al">![](figure/banner/3.png)</span></span>
<span id="cb1-1579"><a href="#cb1-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1580"><a href="#cb1-1580" aria-hidden="true" tabindex="-1"></a><span class="fu">## Periodic motion</span></span>
<span id="cb1-1581"><a href="#cb1-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1582"><a href="#cb1-1582" aria-hidden="true" tabindex="-1"></a><span class="fu">### Oscillator on a line</span></span>
<span id="cb1-1583"><a href="#cb1-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1584"><a href="#cb1-1584" aria-hidden="true" tabindex="-1"></a>Consider a simple harmonic oscillator (SHO), with Hamiltonian $H$ in the $(q, p)$ coordinates:</span>
<span id="cb1-1585"><a href="#cb1-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1586"><a href="#cb1-1586" aria-hidden="true" tabindex="-1"></a>$$H(t, q, p) = \frac{p^2}{2m} + \frac 12 kq^2$$</span>
<span id="cb1-1587"><a href="#cb1-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1588"><a href="#cb1-1588" aria-hidden="true" tabindex="-1"></a>The motion of the system is simply a circular motion around $(q, p) = (0, 0)$:</span>
<span id="cb1-1589"><a href="#cb1-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1590"><a href="#cb1-1590" aria-hidden="true" tabindex="-1"></a>$$\begin{cases} </span>
<span id="cb1-1591"><a href="#cb1-1591" aria-hidden="true" tabindex="-1"></a>\dot q = p/m <span class="sc">\\</span> </span>
<span id="cb1-1592"><a href="#cb1-1592" aria-hidden="true" tabindex="-1"></a>\dot p = - kq </span>
<span id="cb1-1593"><a href="#cb1-1593" aria-hidden="true" tabindex="-1"></a>\end{cases}\quad  </span>
<span id="cb1-1594"><a href="#cb1-1594" aria-hidden="true" tabindex="-1"></a>\begin{cases} </span>
<span id="cb1-1595"><a href="#cb1-1595" aria-hidden="true" tabindex="-1"></a>(q, p) = (q_0 \cos(\omega t), -m\omega q_0 \sin(\omega t)) <span class="sc">\\</span> </span>
<span id="cb1-1596"><a href="#cb1-1596" aria-hidden="true" tabindex="-1"></a>\omega = \sqrt{k/m} </span>
<span id="cb1-1597"><a href="#cb1-1597" aria-hidden="true" tabindex="-1"></a>\end{cases}$$</span>
<span id="cb1-1598"><a href="#cb1-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1599"><a href="#cb1-1599" aria-hidden="true" tabindex="-1"></a>Now consider the action of an entire cycle:</span>
<span id="cb1-1600"><a href="#cb1-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1601"><a href="#cb1-1601" aria-hidden="true" tabindex="-1"></a>$$S = \oint Ldt = \oint (pdq - Hdt)$$</span>
<span id="cb1-1602"><a href="#cb1-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1603"><a href="#cb1-1603" aria-hidden="true" tabindex="-1"></a>The $\oint pdq$ term is the area enclosed by the ellipse, so it is $\pi p_0 q_0$, and the $\oint Hdt$ term is just $HT = \frac{2\pi}{\omega} \frac 12 kq_0^2$, since the system conserves energy. Now direct computation shows</span>
<span id="cb1-1604"><a href="#cb1-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1605"><a href="#cb1-1605" aria-hidden="true" tabindex="-1"></a>$$\oint pdq = HT$$</span>
<span id="cb1-1606"><a href="#cb1-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1607"><a href="#cb1-1607" aria-hidden="true" tabindex="-1"></a>In particular, since $T$ does not depend on the energy of the oscillation, we can take derivative against energy, obtaining</span>
<span id="cb1-1608"><a href="#cb1-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1609"><a href="#cb1-1609" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1610"><a href="#cb1-1610" aria-hidden="true" tabindex="-1"></a>\frac{d}{dE}\oint_{\gamma_E} pdq = T</span>
<span id="cb1-1611"><a href="#cb1-1611" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1612"><a href="#cb1-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1613"><a href="#cb1-1613" aria-hidden="true" tabindex="-1"></a>where $\gamma_E$ is the path traced out by the oscillator with energy $E$. We show that this is generally true for 1D oscillators.</span>
<span id="cb1-1614"><a href="#cb1-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1615"><a href="#cb1-1615" aria-hidden="true" tabindex="-1"></a>::: {#thm-1d-oscillator-period}</span>
<span id="cb1-1616"><a href="#cb1-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1617"><a href="#cb1-1617" aria-hidden="true" tabindex="-1"></a>Given any 1D oscillator,</span>
<span id="cb1-1618"><a href="#cb1-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1619"><a href="#cb1-1619" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1620"><a href="#cb1-1620" aria-hidden="true" tabindex="-1"></a>\frac{d}{dE}\oint_{\gamma_E} pdq = T(E)</span>
<span id="cb1-1621"><a href="#cb1-1621" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1622"><a href="#cb1-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1623"><a href="#cb1-1623" aria-hidden="true" tabindex="-1"></a>where $\gamma_E$ is the path traced out by the oscillator when it has energy $E$, and $T(E)$ is the period.</span>
<span id="cb1-1624"><a href="#cb1-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1625"><a href="#cb1-1625" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1626"><a href="#cb1-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1627"><a href="#cb1-1627" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Proof" collapse="false"}</span>
<span id="cb1-1628"><a href="#cb1-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1629"><a href="#cb1-1629" aria-hidden="true" tabindex="-1"></a>Consider the phase space plot of a generic 1D oscillator. Every point in its phase space must go in a cycle, returning to the start again. Thus, its phase space is like an ugly onion: It is split into cycles, which are not generally circular in shape, and generally each cycle has a different cycling period.</span>
<span id="cb1-1630"><a href="#cb1-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1631"><a href="#cb1-1631" aria-hidden="true" tabindex="-1"></a><span class="al">![](figure/1doscillator.jpg)</span>{width="80%" fig-align="center"}</span>
<span id="cb1-1632"><a href="#cb1-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1633"><a href="#cb1-1633" aria-hidden="true" tabindex="-1"></a>Take a particular cycle as shown, starting and ending at $q_0 = q_1$. Now consider this variation that fixes $(t_0, q_0), (t_1, q_1)$: move from point 0 to point 1, then go around the larger cycle to point 1, then return to point 0. The action of the varied cycle consists of three parts: $0\to 1, 1 \to 1, 1 \to 0$. By (modified) Hamilton's principle, the variation of action is zero.</span>
<span id="cb1-1634"><a href="#cb1-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1635"><a href="#cb1-1635" aria-hidden="true" tabindex="-1"></a>Now, let $T(E) = t_1 - t_0$ be the cycle period for the cycle with energy $E$, then from our above argument, we have</span>
<span id="cb1-1636"><a href="#cb1-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1637"><a href="#cb1-1637" aria-hidden="true" tabindex="-1"></a>$$\oint_E pdq - E T(E) = \oint_{E + \delta E} pdq - (E + \delta E) T(E) + O(\delta E^2)$$</span>
<span id="cb1-1638"><a href="#cb1-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1639"><a href="#cb1-1639" aria-hidden="true" tabindex="-1"></a>where the $O(\delta E^2)$ term deals with the $0\to 1, 1\to 0$ parts of $\int -Hdt$. Thus we obtain</span>
<span id="cb1-1640"><a href="#cb1-1640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1641"><a href="#cb1-1641" aria-hidden="true" tabindex="-1"></a>$$\frac{d}{dE} \oint_E pdq = T(E)$$</span>
<span id="cb1-1642"><a href="#cb1-1642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1643"><a href="#cb1-1643" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1644"><a href="#cb1-1644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1645"><a href="#cb1-1645" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Worked example: pendulum in gravity" collapse="true"}</span>
<span id="cb1-1646"><a href="#cb1-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1647"><a href="#cb1-1647" aria-hidden="true" tabindex="-1"></a>The 1D pendulum in gravity, with length $l$ and mass $m$, has Lagrangian $L = \frac 12 m(l\dot q)^2 + mgl\cos q$, momentum $p = ml^2 \dot q$, and Hamiltonian</span>
<span id="cb1-1648"><a href="#cb1-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1649"><a href="#cb1-1649" aria-hidden="true" tabindex="-1"></a>$$H = \frac{p^2}{2ml^2} - mgl \cos(q)$$</span>
<span id="cb1-1650"><a href="#cb1-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1651"><a href="#cb1-1651" aria-hidden="true" tabindex="-1"></a>We know that the pendulum is not a SHO. Indeed, the cycle period $T(E)$ strictly increases with energy $E$ of the cycle, and it diverges as the pendulum swing approaches the highest point: $\lim_{E \to mgl} T(E) = +\infty$.</span>
<span id="cb1-1652"><a href="#cb1-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1653"><a href="#cb1-1653" aria-hidden="true" tabindex="-1"></a>Consider the cycle with maximum swing angle $\theta$. The cycle encloses an oval-shaped region in phase space, with equation $p^2 = 2m^2 gl^3(\cos q - \cos\theta)$. Consequently, we have the somewhat mysterious result:</span>
<span id="cb1-1654"><a href="#cb1-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1655"><a href="#cb1-1655" aria-hidden="true" tabindex="-1"></a>$$\int_0^{E(\theta)} T(E) dE = 4\sqrt{2m^2 gl^3} \int_0^\theta \sqrt{\cos q - \cos\theta} dq$$</span>
<span id="cb1-1656"><a href="#cb1-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1657"><a href="#cb1-1657" aria-hidden="true" tabindex="-1"></a>where $E(\theta) = -mgl \cos\theta$ is the energy of the system when it has maximum swing angle $\theta$.</span>
<span id="cb1-1658"><a href="#cb1-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1659"><a href="#cb1-1659" aria-hidden="true" tabindex="-1"></a>When $\theta$ is small, the integral is approximately</span>
<span id="cb1-1660"><a href="#cb1-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1661"><a href="#cb1-1661" aria-hidden="true" tabindex="-1"></a>$$\int_0^\theta \sqrt{\frac 12 (\theta^2 - q^2)}dq = \frac{\pi\theta^2}{4\sqrt 2}$$</span>
<span id="cb1-1662"><a href="#cb1-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1663"><a href="#cb1-1663" aria-hidden="true" tabindex="-1"></a>which does correspond to $T(E) \approx 2\pi\sqrt{\frac lg}$, and $\delta E = mgl(1 - \cos(\theta)) \approx \frac 12 mgl \theta^2$.</span>
<span id="cb1-1664"><a href="#cb1-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1665"><a href="#cb1-1665" aria-hidden="true" tabindex="-1"></a>When $\theta = \pi$, the integral can be exactly evaluated:</span>
<span id="cb1-1666"><a href="#cb1-1666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1667"><a href="#cb1-1667" aria-hidden="true" tabindex="-1"></a>$$\int_0^{mgl} T(E) dE = 16\sqrt{m^2 gl^3}$$</span>
<span id="cb1-1668"><a href="#cb1-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1669"><a href="#cb1-1669" aria-hidden="true" tabindex="-1"></a>We are unable to interpret this strange but satisfying equality.</span>
<span id="cb1-1670"><a href="#cb1-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1671"><a href="#cb1-1671" aria-hidden="true" tabindex="-1"></a>Taking $\partial_\theta$ under the integral sign, we get</span>
<span id="cb1-1672"><a href="#cb1-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1673"><a href="#cb1-1673" aria-hidden="true" tabindex="-1"></a>$$T(E) = \sqrt{\frac{8l}g} \int_0^\theta \frac{dq}{\sqrt{\cos q - \cos \theta}}$$</span>
<span id="cb1-1674"><a href="#cb1-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1675"><a href="#cb1-1675" aria-hidden="true" tabindex="-1"></a>which may be directly verified.</span>
<span id="cb1-1676"><a href="#cb1-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1677"><a href="#cb1-1677" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1678"><a href="#cb1-1678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1679"><a href="#cb1-1679" aria-hidden="true" tabindex="-1"></a><span class="fu">### Action-angle variables</span></span>
<span id="cb1-1680"><a href="#cb1-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1681"><a href="#cb1-1681" aria-hidden="true" tabindex="-1"></a>Now, it would be great if we could "unwind" the rotatory dynamics by a time-independent canonical transform to some $(Q, P)$, by where $P$ is constant along the cycles, and $Q$ is increasing. That is, we want $P$ to be the analog of "amplitude", and $Q$ to be the analog of "phase angle".</span>
<span id="cb1-1682"><a href="#cb1-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1683"><a href="#cb1-1683" aria-hidden="true" tabindex="-1"></a>Since the transform is time-independent and canonical, the Hamiltonian $H$ is unmodified, so $H$ is a function of $P$ only, not $Q$ (since $H$ is a conserved quantity of motion). Then, since the transform is canonical, Hamilton's equations of motion read $\dot Q = \partial_P H(P)$. Consequently, the Hamiltonian equations of motion would become</span>
<span id="cb1-1684"><a href="#cb1-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1685"><a href="#cb1-1685" aria-hidden="true" tabindex="-1"></a>$$\begin{cases} P(t) = P(0) <span class="sc">\\</span> Q(t) = Q(0) + H'(P) t \end{cases}$$</span>
<span id="cb1-1686"><a href="#cb1-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1687"><a href="#cb1-1687" aria-hidden="true" tabindex="-1"></a>as simple as it could be! It remains to find such a canonical transform.</span>
<span id="cb1-1688"><a href="#cb1-1688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1689"><a href="#cb1-1689" aria-hidden="true" tabindex="-1"></a>We are already mostly there: we know that $P$ is constant along the cycles, and $Q$ increasing along the cycles. It remains to find the right scaling, so that the transform is canonical, that is, the coordinates preserve area: $dP \wedge dQ = dp \wedge dq$.</span>
<span id="cb1-1690"><a href="#cb1-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1691"><a href="#cb1-1691" aria-hidden="true" tabindex="-1"></a>Define $P = \frac{1}{2\pi} \oint pdq$. Here the $2\pi$ factor is not essential, since we could always do a point transform, scale down $Q$ by $2\pi$, and scale up $P$ by $2\pi$. However, the factor will make many formulas look cleaner.</span>
<span id="cb1-1692"><a href="#cb1-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1693"><a href="#cb1-1693" aria-hidden="true" tabindex="-1"></a>From the proof of @thm-1d-oscillator-period, we know that increasing the energy of the cycle by $\delta H$ would increase the cycle area by $T(H)\delta H$, and the cycle area is $2\pi P$, thus</span>
<span id="cb1-1694"><a href="#cb1-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1695"><a href="#cb1-1695" aria-hidden="true" tabindex="-1"></a>$$\delta(2\pi P) = T(H) \delta H \implies \frac{2\pi}{T(H)} = H'(P)$$</span>
<span id="cb1-1696"><a href="#cb1-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1697"><a href="#cb1-1697" aria-hidden="true" tabindex="-1"></a>so we find that the equations of motion are:</span>
<span id="cb1-1698"><a href="#cb1-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1699"><a href="#cb1-1699" aria-hidden="true" tabindex="-1"></a>$$\begin{cases} P(t) = P(0) <span class="sc">\\</span> Q(t) = Q(0) + 2\pi \frac{t}{T(H)} \end{cases}$$</span>
<span id="cb1-1700"><a href="#cb1-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1701"><a href="#cb1-1701" aria-hidden="true" tabindex="-1"></a>This allows us to graphically construct the $(Q, P)$ coordinates on phase space:</span>
<span id="cb1-1702"><a href="#cb1-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1703"><a href="#cb1-1703" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Draw the cycles in phase space.</span>
<span id="cb1-1704"><a href="#cb1-1704" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Select a "line of longitude" arbitrarily as $Q = 0$ line. </span>
<span id="cb1-1705"><a href="#cb1-1705" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Follow the trajectory of each point on the line of longitude, and mark down a new line of longitude at equal phases-angles. So for example, if you are on the cycle of energy $E$, you would start the ride, and after $T(E)/3$ has passed, note down its phase-angle as $2\pi/3$. The set of all such points at every cycle is the line of longitude with $Q = 2\pi/3$.</span>
<span id="cb1-1706"><a href="#cb1-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1707"><a href="#cb1-1707" aria-hidden="true" tabindex="-1"></a><span class="al">![Constructing a canonical coordinate system over the phase space of the 1D oscillator.](figure/1doscillator-canonical.jpg)</span>{width="80%" fig-align="center"}</span>
<span id="cb1-1708"><a href="#cb1-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1709"><a href="#cb1-1709" aria-hidden="true" tabindex="-1"></a>Now, we can graphically see that this construction really preserves areas:</span>
<span id="cb1-1710"><a href="#cb1-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1711"><a href="#cb1-1711" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Take an infinitesimal parallelogram at $(Q, P)$ with sides $\delta Q, \delta P$, such that $\delta Q = \frac{2\pi}{N}$ for some infinite integer $N$.</span>
<span id="cb1-1712"><a href="#cb1-1712" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Evolve the system in discrete steps of $\frac{T(P)}{N}$, and follow the parallelogram along. </span>
<span id="cb1-1713"><a href="#cb1-1713" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Note that the parallelogram would tile the thin ring between $P$ and $P+ \delta P$. The thin ring has area $\delta \oint pdq = 2\pi \delta P$, so each parallelogram has area $2\pi \delta P/N = \delta P \delta Q$.</span>
<span id="cb1-1714"><a href="#cb1-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1715"><a href="#cb1-1715" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb1-1716"><a href="#cb1-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1717"><a href="#cb1-1717" aria-hidden="true" tabindex="-1"></a>This is not as trivial as it seems. The "area" in phase space was defined by $\oint pdq$, but we did not say that $p, q$ are perpendicular in any sense. Thus, it is not obvious that $\delta P \delta Q$ would be the area of the parallelogram. Indeed, we *should not* say that $p, q$ are perpendicular, because angles do not exist and *should not* exist in phase space.</span>
<span id="cb1-1718"><a href="#cb1-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1719"><a href="#cb1-1719" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1720"><a href="#cb1-1720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1721"><a href="#cb1-1721" aria-hidden="true" tabindex="-1"></a>The entire construction of $(Q, P)$ from $(q, p)$ is often done in one divinely-inspired move by a generating function.</span>
<span id="cb1-1722"><a href="#cb1-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1723"><a href="#cb1-1723" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adiabaticity</span></span>
<span id="cb1-1724"><a href="#cb1-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1725"><a href="#cb1-1725" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">small</span><span class="dt">&gt;</span>This section based on <span class="co">[</span><span class="ot">@duncanConstructingQuantumMechanics2019, chapter 5; @deoliveiraParametricInvariance2022</span><span class="co">]</span>.<span class="dt">&lt;/</span><span class="kw">small</span><span class="dt">&gt;</span></span>
<span id="cb1-1726"><a href="#cb1-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1727"><a href="#cb1-1727" aria-hidden="true" tabindex="-1"></a>The Lorentz pendulum is a famous example that connects the classical and the quantum world. In the early 1900s, as physicists were trying to explain various phenomena, such as the black body radiation spectrum, the atomic spectra, and such, they came to the **quantum hypothesis**. Consider a classical system undergoing periodic motion -- such as the electrons cycling around a proton in the hydrogen atom. Whereas classically, its $\oint pdq$ may be of any value, the quantum hypothesis states that it can only take values in</span>
<span id="cb1-1728"><a href="#cb1-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1729"><a href="#cb1-1729" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1730"><a href="#cb1-1730" aria-hidden="true" tabindex="-1"></a>\oint pdq = nh, \quad n = 1, 2, 3, \dots</span>
<span id="cb1-1731"><a href="#cb1-1731" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1732"><a href="#cb1-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1733"><a href="#cb1-1733" aria-hidden="true" tabindex="-1"></a>for a certain constant of nature $h$ -- later given the name of **Planck's constant**. For example, if we have a simple harmonic oscillator, then we have</span>
<span id="cb1-1734"><a href="#cb1-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1735"><a href="#cb1-1735" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1736"><a href="#cb1-1736" aria-hidden="true" tabindex="-1"></a>E\nu = n h</span>
<span id="cb1-1737"><a href="#cb1-1737" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1738"><a href="#cb1-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1739"><a href="#cb1-1739" aria-hidden="true" tabindex="-1"></a>where $\nu = 1/T$ is the frequency of the oscillator.</span>
<span id="cb1-1740"><a href="#cb1-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1741"><a href="#cb1-1741" aria-hidden="true" tabindex="-1"></a>At the 1911 Solvay Conference, where the great physicists grappled with the new quantum phenomena,<span class="ot">[^solvay-1911]</span> Einstein gave a presentation on the quantum hypothesis. At the end of the presentation, Lorentz asked a question about the pendulum. The conversation went as follows:</span>
<span id="cb1-1742"><a href="#cb1-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1743"><a href="#cb1-1743" aria-hidden="true" tabindex="-1"></a><span class="ot">[^solvay-1911]: </span>The entire conference is summarized in <span class="co">[</span><span class="ot">@straumannFirstSolvayCongress2011</span><span class="co">]</span>.</span>
<span id="cb1-1744"><a href="#cb1-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1745"><a href="#cb1-1745" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Mr. Lorentz recalls a conversation he had with Mr. Einstein some time ago, in which they discussed a simple pendulum that could be shortened by holding the string between two fingers and sliding them downwards. Suppose that initially, the pendulum has exactly one energy element corresponding to the frequency of its oscillations. It then seems that at the end of the experiment, its energy will be less than the element corresponding to the new frequency. </span></span>
<span id="cb1-1746"><a href="#cb1-1746" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span></span>
<span id="cb1-1747"><a href="#cb1-1747" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Mr. Einstein -- If the length of the pendulum is changed infinitely slowly, the energy of the oscillation remains equal to $h\nu$, if it was initially equal to  $h\nu$ ; it varies proportionally to the frequency. The same is true for a resistance-free oscillating electrical circuit, and also for free radiation.</span></span>
<span id="cb1-1748"><a href="#cb1-1748" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span></span>
<span id="cb1-1749"><a href="#cb1-1749" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Mr. Lorentz -- This result is very curious and removes the difficulty. In general, the hypothesis of energy elements gives rise to interesting problems in all cases where one can change the frequency of vibrations at will.</span></span>
<span id="cb1-1750"><a href="#cb1-1750" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb1-1751"><a href="#cb1-1751" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="co">[</span><span class="ot">@institutssolvayTheorieRayonnementQuanta1912, page 450</span><span class="co">]</span></span>
<span id="cb1-1752"><a href="#cb1-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1753"><a href="#cb1-1753" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">The adiabatic pendulum of Lorentz. Figure from [@fowler13AdiabaticInvariants2020]</span><span class="co">](figure/adiabatic-pendulum.png)</span>{width=30% fig-align="center"}</span>
<span id="cb1-1754"><a href="#cb1-1754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1755"><a href="#cb1-1755" aria-hidden="true" tabindex="-1"></a>Why is this interesting? The quantum hypothesis states that for quantum oscillators, $E/\nu = nh$, where $n$ can only take values in the natural numbers. The Lorentz pendulum seems to show that the quantity $E/\nu$ can change continuously. Thus, for example, we might start at a quantized value of $E/\nu = 100h$, and end up at $100.5h$, invalidating the quantum hypothesis for macroscopic systems. And if macroscopic systems do not follow the quantum hypothesis, then as the macroscopic system becomes microscopic, it seems the quantum hypothesis would be invalidated as well.</span>
<span id="cb1-1756"><a href="#cb1-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1757"><a href="#cb1-1757" aria-hidden="true" tabindex="-1"></a>Einstein replied that $E/\nu$ of the oscillator *is conserved* if the length of the pendulum is changed infinitely slowly. Surprising, but it saves the quantum hypothesis.</span>
<span id="cb1-1758"><a href="#cb1-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1759"><a href="#cb1-1759" aria-hidden="true" tabindex="-1"></a><span class="fu">#### The adiabatic theorem</span></span>
<span id="cb1-1760"><a href="#cb1-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1761"><a href="#cb1-1761" aria-hidden="true" tabindex="-1"></a>Consider a pendulum with a string length $\lambda$ that is slowly changed over time. How slow? Slow enough that the system completes many cycles before $\lambda$ makes any appreciable change. That is,</span>
<span id="cb1-1762"><a href="#cb1-1762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1763"><a href="#cb1-1763" aria-hidden="true" tabindex="-1"></a>$$\dot \lambda \ll \frac{\lambda}{T(\lambda)}$$</span>
<span id="cb1-1764"><a href="#cb1-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1765"><a href="#cb1-1765" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning title="Parametric resonance"}</span>
<span id="cb1-1766"><a href="#cb1-1766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1767"><a href="#cb1-1767" aria-hidden="true" tabindex="-1"></a>It is vitally important that the pulling on the pendulum is not only slow, but also "smeared", meaning that $\dot\lambda$ is equal over the entirety of a single oscillation. If it is not smeared, then we can break the theory. Consider for example a (spherical) child on a (frictionless) swing (in a vacuum). It is well-known that the child can, by swinging the legs in sync with the swing, get as high as possible. This is called parametric resonance.</span>
<span id="cb1-1768"><a href="#cb1-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1769"><a href="#cb1-1769" aria-hidden="true" tabindex="-1"></a>Compared to adiabatic change, parametric resonance differs in that it is discriminating about the states. When you adiabatically pull on the string of a pendulum, your rate of pulling is the same over the entire cycle of a pendulum swing. When you resonantly pull on the string of a pendulum, your rate of pulling differs over the cycle of a pendulum swing. In the language of thermodynamics, adiabaticity means treating all microstates equally, without discrimination.</span>
<span id="cb1-1770"><a href="#cb1-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1771"><a href="#cb1-1771" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1772"><a href="#cb1-1772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1773"><a href="#cb1-1773" aria-hidden="true" tabindex="-1"></a>Let the angular frequency of oscillation be $\omega = \sqrt{\frac g\lambda}$, then $E/\omega$ is constant over time.</span>
<span id="cb1-1774"><a href="#cb1-1774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1775"><a href="#cb1-1775" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Proof" collapse="true"}</span>
<span id="cb1-1776"><a href="#cb1-1776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1777"><a href="#cb1-1777" aria-hidden="true" tabindex="-1"></a>By basic physics, the force in the string is </span>
<span id="cb1-1778"><a href="#cb1-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1779"><a href="#cb1-1779" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1780"><a href="#cb1-1780" aria-hidden="true" tabindex="-1"></a>F = mg \cos \theta + m\dot \theta^2 / \lambda \approx mg - \ub{\frac 12 mg \theta^2}{$V/\lambda$} + \ub{m\lambda \dot\theta^2}{$2T/\lambda$}</span>
<span id="cb1-1781"><a href="#cb1-1781" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1782"><a href="#cb1-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1783"><a href="#cb1-1783" aria-hidden="true" tabindex="-1"></a>Because the system is undergoing simple harmonic oscillation, the time-average of $V$ and $T$ are both $\frac 12 E$, where $E$ is the oscillation energy. Therefore, the time-average force is $\bar F = mg + \frac 12 E/\lambda$.</span>
<span id="cb1-1784"><a href="#cb1-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1785"><a href="#cb1-1785" aria-hidden="true" tabindex="-1"></a>Thus, if we shorten the string by $\delta \lambda$, we would inject an energy of $\delta E = \bar F (-\delta\lambda) -( mg\delta\lambda)$ (we subtract away the gravitational energy at the lowest point, as it is irrelevant). This gives us </span>
<span id="cb1-1786"><a href="#cb1-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1787"><a href="#cb1-1787" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1788"><a href="#cb1-1788" aria-hidden="true" tabindex="-1"></a>\delta E + E \delta\lambda / 2\lambda = 0 \implies E\lambda^{1/2} = \Const</span>
<span id="cb1-1789"><a href="#cb1-1789" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1790"><a href="#cb1-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1791"><a href="#cb1-1791" aria-hidden="true" tabindex="-1"></a>Since the angular frequency of oscillation is $\omega = \sqrt{\frac g\lambda}$, we have the result.</span>
<span id="cb1-1792"><a href="#cb1-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1793"><a href="#cb1-1793" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1794"><a href="#cb1-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1795"><a href="#cb1-1795" aria-hidden="true" tabindex="-1"></a>::: {#exr-0}</span>
<span id="cb1-1796"><a href="#cb1-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1797"><a href="#cb1-1797" aria-hidden="true" tabindex="-1"></a>Perform the same analysis on a vibrating string. The string is fixed at both ends, and the length of the string is slowly changed. The string is in a standing wave pattern, and the length of the string is changed so slowly that the string completes many cycles before the length changes appreciably. What is the adiabatic invariant in this case? The answer is in <span class="co">[</span><span class="ot">@rayleighXXXIVPressureVibrations1902</span><span class="co">]</span>.</span>
<span id="cb1-1798"><a href="#cb1-1798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1799"><a href="#cb1-1799" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1800"><a href="#cb1-1800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1801"><a href="#cb1-1801" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Adiabatic invariance to all orders" collapse="false"}</span>
<span id="cb1-1802"><a href="#cb1-1802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1803"><a href="#cb1-1803" aria-hidden="true" tabindex="-1"></a>The adiabatic invariance is actually much stronger than what we have shown. It is not just that the enclosed action $I$ is conserved up to $O(\dot\lambda)$, but that it is conserved to all orders in $O(\dot \lambda^n)$ <span class="co">[</span><span class="ot">@lenardAdiabaticInvarianceAll1959</span><span class="co">]</span>. Under stronger restrictions, it is even conserved to order $O(e^{c/\dot \lambda})$. See <span class="co">[</span><span class="ot">@henrardAdiabaticInvariantClassical1993, section 4</span><span class="co">]</span> for more theorems in this style.</span>
<span id="cb1-1804"><a href="#cb1-1804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1805"><a href="#cb1-1805" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1806"><a href="#cb1-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1807"><a href="#cb1-1807" aria-hidden="true" tabindex="-1"></a>Generalizing from this experience, for an arbitrary 1D oscillator with Hamiltonian $H(q, p; \lambda)$, the phase space trajectory is a closed wobbly cycle. As we vary $\lambda$ adiabatically by external force, the cycle changes shape, both because the system has received energy from the external force, and because the Hamiltonian of the system has changed. Nevertheless, the area enclosed within should remain constant.</span>
<span id="cb1-1808"><a href="#cb1-1808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1809"><a href="#cb1-1809" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Proof" collapse="false"}</span>
<span id="cb1-1810"><a href="#cb1-1810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1811"><a href="#cb1-1811" aria-hidden="true" tabindex="-1"></a>In general, force is the energetic cost of changing a parameter. That is, $F = (\partial_{\lambda} H)_{p, q}$. Here, we are using a notation commonly used in thermodynamics: for partial derivatives, we write in the subscript the variables being held constant.</span>
<span id="cb1-1812"><a href="#cb1-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1813"><a href="#cb1-1813" aria-hidden="true" tabindex="-1"></a>Let us adiabatically vary $\lambda$. After many cycles have passed, the oscillator is orbiting around the cycle defined by $H(q, p; \lambda) = E$. After many more cycles have passed, we have varied $\lambda$ by $\delta \lambda$, and the oscillator would be orbiting around the cycle defined by $H(q, p; \lambda + \delta \lambda) = E + \delta E$, where $\delta E = \bar F \delta \lambda$ is the increase in oscillator energy due to the external force varying $\lambda$.</span>
<span id="cb1-1814"><a href="#cb1-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1815"><a href="#cb1-1815" aria-hidden="true" tabindex="-1"></a><span class="al">![](figure/adiabatic_theorem_proof.jpg)</span>{width=80% fig-align="center"}</span>
<span id="cb1-1816"><a href="#cb1-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1817"><a href="#cb1-1817" aria-hidden="true" tabindex="-1"></a>As pictured, for each point $(q_0, p_0)$ on the first cycle, we move by $\delta p$, to end up with point $(q_0, p_0 + \delta p)$ on the second cycle. The cycle area would change by </span>
<span id="cb1-1818"><a href="#cb1-1818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1819"><a href="#cb1-1819" aria-hidden="true" tabindex="-1"></a>$$\delta(\text{area}) = \oint (\delta p)dq = \int_0^T (\delta p )\dot q dt + O(\delta T \delta p)$$</span>
<span id="cb1-1820"><a href="#cb1-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1821"><a href="#cb1-1821" aria-hidden="true" tabindex="-1"></a>where $T$ is the cycle time of the first cycle, and $T + \delta t$ is the cycle time of the second cycle.</span>
<span id="cb1-1822"><a href="#cb1-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1823"><a href="#cb1-1823" aria-hidden="true" tabindex="-1"></a>Expanding and simplifying,</span>
<span id="cb1-1824"><a href="#cb1-1824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1825"><a href="#cb1-1825" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1826"><a href="#cb1-1826" aria-hidden="true" tabindex="-1"></a>H(q_0, p_0 + \delta p ; \lambda + \delta \lambda) = E + \ub{\delta E}{$= \bar F \delta \lambda$} \implies </span>
<span id="cb1-1827"><a href="#cb1-1827" aria-hidden="true" tabindex="-1"></a>(\partial_p H)_{\lambda, q}\delta p = [\overline{(\partial_\lambda H)_{q, p}} - (\partial_\lambda H)_{q, p}] \delta\lambda</span>
<span id="cb1-1828"><a href="#cb1-1828" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1829"><a href="#cb1-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1830"><a href="#cb1-1830" aria-hidden="true" tabindex="-1"></a>Now, integrate over a single cycle, and using the Hamilton equation of motion $\dot{q} = (\partial_p H)_{\lambda, q}$, </span>
<span id="cb1-1831"><a href="#cb1-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1832"><a href="#cb1-1832" aria-hidden="true" tabindex="-1"></a>$$\delta(\text{area}) =  \delta\lambda \int_0^T <span class="co">[</span><span class="ot">\overline{(\partial_\lambda H)_{q, p}} - (\partial_\lambda H)_{q, p}</span><span class="co">]</span> dt + O(\delta^2)$$</span>
<span id="cb1-1833"><a href="#cb1-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1834"><a href="#cb1-1834" aria-hidden="true" tabindex="-1"></a>By definition, $\overline{(\partial_\lambda H)_{q, p}} = \frac 1T \int_0^T (\partial_\lambda H)_{q, p}dt$, thus we have $\delta(\text{area}) = O(\delta^2)$. Thus, integrating over the entirety of the adiabatic process, $\Delta(\text{area}) = O(\delta)$, which converges to zero as the adiabatic process becomes infinitely slow.</span>
<span id="cb1-1835"><a href="#cb1-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1836"><a href="#cb1-1836" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1837"><a href="#cb1-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1838"><a href="#cb1-1838" aria-hidden="true" tabindex="-1"></a>::: {#multidimensional-adiabatic-theorem .callout-tip}</span>
<span id="cb1-1839"><a href="#cb1-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1840"><a href="#cb1-1840" aria-hidden="true" tabindex="-1"></a>For a multidimensional oscillating system, we have three possibilities.</span>
<span id="cb1-1841"><a href="#cb1-1841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1842"><a href="#cb1-1842" aria-hidden="true" tabindex="-1"></a>If the dimensions separate, like an $n$-dimensional oscillator $H = \frac{p_1^2 + \dots + p_n^2}{2m} + \frac 12 k (q_1^2 + \dots + q_n^2)$. In this case, the adiabatic theorem still applies along each dimension, with one adiabatic invariant per dimension.</span>
<span id="cb1-1843"><a href="#cb1-1843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1844"><a href="#cb1-1844" aria-hidden="true" tabindex="-1"></a>If all dimensions mix together, like a tank of hot, entangled gas. In this case, the adiabatic theorem states that if we start with the microcanonical ensemble, then the phase space volume enclosed by the surface of $H = E$ remains constant as we adiabatically vary $\lambda$. The volume is named the Gibbs invariant. <span class="co">[</span><span class="ot">@deoliveiraParametricInvariance2022</span><span class="co">]</span></span>
<span id="cb1-1845"><a href="#cb1-1845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1846"><a href="#cb1-1846" aria-hidden="true" tabindex="-1"></a>If the dimensions neither separate nor mix together, but have some kind of complicated dynamics, then what adiabaticity means in that case is still a current area of research.</span>
<span id="cb1-1847"><a href="#cb1-1847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1848"><a href="#cb1-1848" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1849"><a href="#cb1-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1850"><a href="#cb1-1850" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Connection to thermodynamics</span></span>
<span id="cb1-1851"><a href="#cb1-1851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1852"><a href="#cb1-1852" aria-hidden="true" tabindex="-1"></a>Consider a ball in a piston, bouncing elastically off its two ends. We hold one end of the piston constant, and slowly move the other. Assume the ball only moves in the $x$-direction for simplicity. Let the ball have speed $v$, and the walls of the piston have separation $L$.</span>
<span id="cb1-1853"><a href="#cb1-1853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1854"><a href="#cb1-1854" aria-hidden="true" tabindex="-1"></a>The phase space diagram of the system is a rectangle with $\Delta q = L, \Delta p = (mv) - (-mv) = 2mv$, enclosing an area of $I = 2mvL$. If we slowly move the wall of the piston, then the action is conserved, giving us</span>
<span id="cb1-1855"><a href="#cb1-1855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1856"><a href="#cb1-1856" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1857"><a href="#cb1-1857" aria-hidden="true" tabindex="-1"></a>2mv_0 L_0 = 2mvL \implies v = \frac{L_0}{L} v_0</span>
<span id="cb1-1858"><a href="#cb1-1858" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1859"><a href="#cb1-1859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1860"><a href="#cb1-1860" aria-hidden="true" tabindex="-1"></a>We can formulate this into the language of thermodynamics. First, expand our system to three dimensions -- from a piston to a box. Since the motion of the ball in the $x, y, z$ directions are independent, we can treat them separately. We also assume equipartition of energies, that is, the energy of the ball is equally distributed among the three dimensions, so $v_{x, 0} = v_{y, 0} = v_{z, 0}$. The conservation of action then states that</span>
<span id="cb1-1861"><a href="#cb1-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1862"><a href="#cb1-1862" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1863"><a href="#cb1-1863" aria-hidden="true" tabindex="-1"></a>v_i = \frac{L_{i, 0}}{L_i} v_{i, 0} \quad \text{for } i = x, y, z</span>
<span id="cb1-1864"><a href="#cb1-1864" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1865"><a href="#cb1-1865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1866"><a href="#cb1-1866" aria-hidden="true" tabindex="-1"></a>Imagine the ball is a gas molecule, and the piston is a wall of a container. Let $E = \sum_{i = x, y, z} \frac 12 mv_i^2$ be the energy of the gas molecule, and $V = \prod_{i = x, y, z}L_i$ be the volume of the gas. We then have</span>
<span id="cb1-1867"><a href="#cb1-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1868"><a href="#cb1-1868" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1869"><a href="#cb1-1869" aria-hidden="true" tabindex="-1"></a>V = V_0 \prod_i \frac{L_i}{L_{i, 0}} \approx V_0 \left(1 + \sum_i \frac{\delta L_{i}}{L_{i, 0}}\right), \quad</span>
<span id="cb1-1870"><a href="#cb1-1870" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb1-1871"><a href="#cb1-1871" aria-hidden="true" tabindex="-1"></a>E &amp;= \frac 12 m \sum_i \left(\frac{L_{i,0}}{L_i}\right)^2 v_{i, 0}^2<span class="sc">\\</span></span>
<span id="cb1-1872"><a href="#cb1-1872" aria-hidden="true" tabindex="-1"></a>&amp;= \frac 32 m v_0^2 \frac 13 \sum_i \left(\frac{L_{i,0}}{L_i}\right)^2 <span class="sc">\\</span></span>
<span id="cb1-1873"><a href="#cb1-1873" aria-hidden="true" tabindex="-1"></a>&amp;\approx E_0 \left(1 - \frac 23 \sum_i \frac{\delta L_{i}}{L_{i, 0}}\right)</span>
<span id="cb1-1874"><a href="#cb1-1874" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb1-1875"><a href="#cb1-1875" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1876"><a href="#cb1-1876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1877"><a href="#cb1-1877" aria-hidden="true" tabindex="-1"></a>These imply that $E^{3/2}V \approx E_0^{3/2}V_0$. Now, this is precisely what happens if you compress an ideal gas adiabatically. This is one connection between the concept of "adiabatic" in classical mechanics and thermodynamics.</span>
<span id="cb1-1878"><a href="#cb1-1878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1879"><a href="#cb1-1879" aria-hidden="true" tabindex="-1"></a>::: {#exr-0}</span>
<span id="cb1-1880"><a href="#cb1-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1881"><a href="#cb1-1881" aria-hidden="true" tabindex="-1"></a>Prove that $I$ is conserved: calculate the average force $\bar F$ on the piston, then calculate the work done by the piston.</span>
<span id="cb1-1882"><a href="#cb1-1882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1883"><a href="#cb1-1883" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1884"><a href="#cb1-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1885"><a href="#cb1-1885" aria-hidden="true" tabindex="-1"></a><span class="fu">#### More examples</span></span>
<span id="cb1-1886"><a href="#cb1-1886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1887"><a href="#cb1-1887" aria-hidden="true" tabindex="-1"></a>Given a Lorentz pendulum and a schedule for varying its arm length, we can plot the angle $x$ as a function of time, and see directly that $I = T (\frac 12 m \dot x_{max}^2)$ is conserved over many swings of the pendulum.</span>
<span id="cb1-1888"><a href="#cb1-1888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1889"><a href="#cb1-1889" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">A Lorentz pendulum with length increasing linearly with time. As its length increases, $\dot x_{max}$ decreases while $T$ increases, keeping $I$ conserved. Annotated from [@sanchez-sotoVariationsAdiabaticInvariance2013, figure 1]</span><span class="co">](figure/sanchez-soto_fig_1_annotated.png)</span>{width=80% fig-align="center"}</span>
<span id="cb1-1890"><a href="#cb1-1890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1891"><a href="#cb1-1891" aria-hidden="true" tabindex="-1"></a>For a more rigorous proof of adiabatic invariance at the level of first-year graduate student, see <span class="co">[</span><span class="ot">@wellsAdiabaticInvarianceAction2007</span><span class="co">]</span>. <span class="co">[</span><span class="ot">@henrardAdiabaticInvariantClassical1993</span><span class="co">]</span> is a good comprehensive review of adiabatic invariance in classical mechanics, and points to the literature on a lot of applications in celestial mechanics, magnetism, and the geometry of phase space plots. In textbooks on classical statistical mechanics, the adiabatic invariance theorem is used to derive many results. <span class="co">[</span><span class="ot">@fernandez-pinedaAdiabaticInvariancePhase1982</span><span class="co">]</span> gives some worked-out examples, such as the ideal gas and the photon gas. </span>
<span id="cb1-1892"><a href="#cb1-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1893"><a href="#cb1-1893" aria-hidden="true" tabindex="-1"></a><span class="fu">## Old quantum mechanics</span></span>
<span id="cb1-1894"><a href="#cb1-1894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1895"><a href="#cb1-1895" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Sommerfeld, in the new edition of his book </span><span class="co">[</span><span class="ot">*Atomic structure and spectral lines*</span><span class="co">]</span><span class="at">, has introduced the adiabatic hypothesis through a couple of very elegant changes and footnotes, in such a way that my participation in that can rather appear reduced to — a plagiarism. Lorentz and Einstein have founded the subject, I have given it a name and Burgers has put everything in order. I was first **very, very** depressed. I know that I have never discovered anything, and **quite surely never will discover anything**, that I can love so fervently as this line of thought which I found out with so large joy.</span></span>
<span id="cb1-1896"><a href="#cb1-1896" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb1-1897"><a href="#cb1-1897" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Ehrenfest's letter to Bohr, 8 May 1922. Emphasis in original. Quoted in </span><span class="co">[</span><span class="ot">@navarroPaulEhrenfestGenesis2006</span><span class="co">]</span></span>
<span id="cb1-1898"><a href="#cb1-1898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1899"><a href="#cb1-1899" aria-hidden="true" tabindex="-1"></a><span class="fu">### The adiabatic hypothesis</span></span>
<span id="cb1-1900"><a href="#cb1-1900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1901"><a href="#cb1-1901" aria-hidden="true" tabindex="-1"></a>There are two ways to interpret the word "adiabatic". In thermodynamics, "adiabatic" means "no exchange of heat". In mechanics, "adiabatic" means "gradual".<span class="ot">[^adiabatic-chinese]</span> It is a winding story of how one word "adiabatic" came to mean two things that fortuitously are connected after all, the details of which are given in <span class="co">[</span><span class="ot">@jammerConceptualDevelopmentQuantum1966, Chapter 3; @laidlerMeaningAdiabatic1994</span><span class="co">]</span>. The story is almost as interesting as that of the word "entropy", which also has two meanings that are fortuitously connected after all.</span>
<span id="cb1-1902"><a href="#cb1-1902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1903"><a href="#cb1-1903" aria-hidden="true" tabindex="-1"></a><span class="ot">[^adiabatic-chinese]: </span>Because "adiabatic" has two meanings in English, in Chinese, it also has two different translations based on the two meanings. There is 绝热, which means "no exchange of heat", and 浸渐, which means "gradually, like moisture soaking into something".</span>
<span id="cb1-1904"><a href="#cb1-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1905"><a href="#cb1-1905" aria-hidden="true" tabindex="-1"></a>Rankine first coined the term "adiabatic" in 1858, to denote a process in which no heat is exchanged with the surroundings. Later, Boltzmann and Clausius tried to explain the second law of thermodynamics mechanically, by using purely mechanical models of the microscopic world. In this sense, they defined an "adiabatic" mechanical process to be one where a certain variable is slowly changed (for example, if we have a box of little bouncing balls, and we slowly move its walls), because an adiabatic thermodynamic process in their view is actually an adiabatic mechanical process.</span>
<span id="cb1-1906"><a href="#cb1-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1907"><a href="#cb1-1907" aria-hidden="true" tabindex="-1"></a>"Adiabatic motion" in mechanics was introduced by Helmholtz and Hertz, to denote mechanical processes where external forces act upon a system, but only on a few parameters, with no action on the underlying details. For example, think back to the case of bouncing balls in a box. The external force only moves the walls of the box *on average*, with no attempt to move the walls to manipulate the precise location of the ball. They used the thermodynamic terminology, because the work done on the system during an adiabatic motion results exclusively in changes in its energy. <span class="co">[</span><span class="ot">@jammerConceptualDevelopmentQuantum1966, Chapter 3</span><span class="co">]</span></span>
<span id="cb1-1908"><a href="#cb1-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1909"><a href="#cb1-1909" aria-hidden="true" tabindex="-1"></a>In 1900, Pyotr Lebedev experimentally proved that radiation pressure exists, and follows Maxwell's theory of electromagnetism. Inspired by this, Lord Rayleigh <span class="co">[</span><span class="ot">@rayleighXXXIVPressureVibrations1902</span><span class="co">]</span> generalized the concept of radiation pressure to all kinds of vibrations, starting with the humble pendulum. Since his goal was to understand what happens when you adiabatically compress a photon gas, that is, <span class="co">[</span><span class="ot">Wien's displacement law</span><span class="co">](https://en.wikipedia.org/wiki/Wien's_displacement_law#Discovery)</span>,<span class="ot">[^kelvin-photon-gas]</span> he studied the effect of adiabatic motion on some simple mechanical systems undergoing wave motion, such as the Lorentz pendulum, a vibrating cord, a piston of gas with a standing acoustic ave, etc.</span>
<span id="cb1-1910"><a href="#cb1-1910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1911"><a href="#cb1-1911" aria-hidden="true" tabindex="-1"></a><span class="ot">[^kelvin-photon-gas]: </span>Since he didn't actually know what a photon was, it might be better to say that he was studying what would happen when you compress a hot chamber of light. Though Wien's displacement law is nowadays proved straight from quantum mechanics, back when ien discovered it in 1893, he used a thermodynamic argument using the adiabatic compression of a photon gas. For a brief presentation of how Rayleigh did it, see <span class="co">[</span><span class="ot">@terhaarAdiabaticInvarianceAdiabatic1966</span><span class="co">]</span>.</span>
<span id="cb1-1912"><a href="#cb1-1912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1913"><a href="#cb1-1913" aria-hidden="true" tabindex="-1"></a>Like Lord Kelvin, Paul Ehrenfest was also trying to explain Wien's displacement law. He was puzzled by the fact that while Wien's displacement law was derived without the quantum hypothesis, yet somehow, it remains true. Suppose we start with a box of light, then it follows a certain black body radiation, which can only be derived by the quantum hypothesis. Now suppose we adiabatically compress the box of light. Though the compression process is studied classically, without the quantum hypothesis, the final state of the light is still the black body radiation. So, it seems that if we start with a system following the quantum hypothesis, then any adiabatic *classical* process would give us a system that still follows the quantum hypothesis. This is his **adiabatic hypothesis**, for which he is famous.</span>
<span id="cb1-1914"><a href="#cb1-1914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1915"><a href="#cb1-1915" aria-hidden="true" tabindex="-1"></a>During the 1910s, Ehrenfest published a series of papers to subsume the many ad-hoc quantum rules under the framework of the adiabatic hypothesis. His idea is as follows: If, in a periodic system described by classical mechanics (such as an electron orbiting a proton), a certain quantity $I$ has units of joule-second, and is conserved as it undergoes adiabatic motion, then this quantity *should* be quantized, and only this quantity *can* be quantized. Only $I$ *can* be quantized, for the reason discussed by Lorentz and Einstein at the Solvay conference.</span>
<span id="cb1-1916"><a href="#cb1-1916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1917"><a href="#cb1-1917" aria-hidden="true" tabindex="-1"></a>Further, $I$ *should* be quantized, because otherwise, why else should $I$ be adiabatically conserved? The adiabaticity of $I$ in the classical world, on the surface, is a shadow of the discreteness of $I$ in the quantum world, deep down. Because $I$ is quantized, if we vary the system slowly enough, the system would have no reason to make a big jump from $I = nh$ to $I = (n+1)h$. This discreteness in the quantum world traps $I$ in its starting position, and this is why $I$ appears adiabatic in the classical world.</span>
<span id="cb1-1918"><a href="#cb1-1918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1919"><a href="#cb1-1919" aria-hidden="true" tabindex="-1"></a>Thus, quantized quantities are precisely adiabatic invariants. We can write down $I = nh$, where $n \in \N$, and proceed to calculate the properties of the system, such as its energy levels, its absorption and emission spectra, etc.</span>
<span id="cb1-1920"><a href="#cb1-1920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1921"><a href="#cb1-1921" aria-hidden="true" tabindex="-1"></a>In short, this is Ehrenfest's recipe for doing "old quantum mechanics":</span>
<span id="cb1-1922"><a href="#cb1-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1923"><a href="#cb1-1923" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Find a system that has a conserved quantity $I$ under adiabatic motion.</span>
<span id="cb1-1924"><a href="#cb1-1924" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>You can do this by solving the equations of motion, then integrate $\oint pdq$.</span>
<span id="cb1-1925"><a href="#cb1-1925" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Alternatively, you can start with a harmonic oscillator, and adiabatically deform the system until it becomes the system you want. Ehrenfest called such systems "adiabatically related to the harmonic oscillator" <span class="co">[</span><span class="ot">@jammerConceptualDevelopmentQuantum1966, page 99</span><span class="co">]</span>.</span>
<span id="cb1-1926"><a href="#cb1-1926" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Proclaim that $I = nh$ for some constant $h$.</span>
<span id="cb1-1927"><a href="#cb1-1927" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Calculate the properties of the system.</span>
<span id="cb1-1928"><a href="#cb1-1928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1929"><a href="#cb1-1929" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Bohr--Sommerfeld model</span></span>
<span id="cb1-1930"><a href="#cb1-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1931"><a href="#cb1-1931" aria-hidden="true" tabindex="-1"></a>As an example, consider the pinnacle of old quantum theory, the <span class="co">[</span><span class="ot">Bohr--Sommerfeld model</span><span class="co">](https://en.wikipedia.org/wiki/Bohr%E2%80%93Sommerfeld_model)</span> of the hydrogen atom. First, treat the hydrogen atom as if it is a relativistic solar system, with the electron as a planet, moving at relativistic speeds<span class="ot">[^relativistic-atom]</span> under the inverse-square force $F \propto \frac{1}{r^2}$. Next, assume that the adiabatic invariant is quantized:</span>
<span id="cb1-1932"><a href="#cb1-1932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1933"><a href="#cb1-1933" aria-hidden="true" tabindex="-1"></a><span class="ot">[^relativistic-atom]</span>:</span>
<span id="cb1-1934"><a href="#cb1-1934" aria-hidden="true" tabindex="-1"></a>    Because the electron moves faster closer to the atom than further away, it has more mass close to the atom than further away. This allows the orbit to precess in a way that is not predicted by Newtonian mechanics. Generally, any perturbation of the inverse-square force will cause the orbit to precess. Even special relativity would predict some precession for the perihelion of Mercury, though it predicts a value of $7''/\text{year}$ only $1/6$ of the correct value <span class="co">[</span><span class="ot">@mcdonaldSpecialRelativityPrecession2023; @goldsteinClassicalMechanics2008, exercise 7.27, page 332</span><span class="co">]</span>. Only general relativity predicts the correct value. Assuming that only special relativity contributes, the perihelion of Mercury would take $7.5 \times 10^7$ Mercury-years to go around the sun once.</span>
<span id="cb1-1935"><a href="#cb1-1935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1936"><a href="#cb1-1936" aria-hidden="true" tabindex="-1"></a><span class="in">    As the electron moves a lot faster than Mercury, it takes much shorter time, but still it takes $4\times 10^4$ electron-years to go around the nucleus once, as noted in Bohr's Nobel lecture [@bohrStructureAtom1923].</span></span>
<span id="cb1-1937"><a href="#cb1-1937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1938"><a href="#cb1-1938" aria-hidden="true" tabindex="-1"></a>$$\int_0^T p_r \,dq_r = n' h$$</span>
<span id="cb1-1939"><a href="#cb1-1939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1940"><a href="#cb1-1940" aria-hidden="true" tabindex="-1"></a>where $q_r$ is the radial position of the electron, $p_r$ is the momentum conjugate to it, $n'$ is the "auxiliary quantum number", and $T$ is the period of the electron's orbit. This, when combined with the hypothesis of quantized angular momentum $mvr = nh$ (here, $n$ is the "principal quantum number"), would predict the emission spectrum of the hydrogen atom.<span class="ot">[^sommerfeld-adiabatic]</span></span>
<span id="cb1-1941"><a href="#cb1-1941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1942"><a href="#cb1-1942" aria-hidden="true" tabindex="-1"></a><span class="ot">[^sommerfeld-adiabatic]: </span>Because the equation of motion for the electron separates into a radial component $q_r, p_r$ and an angular component $q_\theta, p_\theta$, we can apply the <span class="co">[</span><span class="ot">multidimensional adiabatic theorem</span><span class="co">](#multidimensional-adiabatic-theorem)</span> and find that both $\int_0^T p_r \,dq_r$ and $\int_0^T p_\theta \,dq_\theta$ are adiabatic invariants.</span>
<span id="cb1-1943"><a href="#cb1-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1944"><a href="#cb1-1944" aria-hidden="true" tabindex="-1"></a>Sommerfeld went further, piling epicycles upon epicycles, to explain the fine structure of atomic spectra. All those has been swept away by the new quantum theory like how the new astronomy of Kepler swept away the epicycles of Ptolemy. But the adiabatic hypothesis remains to this day a fruitful meeting point between the classical, the quantum, and the thermodynamic world.</span>
<span id="cb1-1945"><a href="#cb1-1945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1946"><a href="#cb1-1946" aria-hidden="true" tabindex="-1"></a>Have some cool pictures, because I like cool pictures.</span>
<span id="cb1-1947"><a href="#cb1-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1948"><a href="#cb1-1948" aria-hidden="true" tabindex="-1"></a>::: {#fig-atombau layout-ncol=1}</span>
<span id="cb1-1949"><a href="#cb1-1949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1950"><a href="#cb1-1950" aria-hidden="true" tabindex="-1"></a>Selections from <span class="co">[</span><span class="ot">@sommerfeldAtomicStructureSpectral1923</span><span class="co">]</span>.</span>
<span id="cb1-1951"><a href="#cb1-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1952"><a href="#cb1-1952" aria-hidden="true" tabindex="-1"></a><span class="al">![Quantization of the adiabatic invariant. Page 197.](figure/atombau_en_p_197.png)</span>{width=80% fig-align="center"}</span>
<span id="cb1-1953"><a href="#cb1-1953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1954"><a href="#cb1-1954" aria-hidden="true" tabindex="-1"></a><span class="al">![This looks familiar... it looks just like the phase space plot of a ball bouncing in a piston. Page 199.](figure/atombau_en_p_199.png)</span>{width=80% fig-align="center"}</span>
<span id="cb1-1955"><a href="#cb1-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1956"><a href="#cb1-1956" aria-hidden="true" tabindex="-1"></a><span class="al">![Orbits of the hydrogen atom with the same principal quantum number $n$, but different auxiliary quantum number $n'$. Page 240.](figure/atombau_en_p_240.png)</span>{width=80% fig-align="center"}</span>
<span id="cb1-1957"><a href="#cb1-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1958"><a href="#cb1-1958" aria-hidden="true" tabindex="-1"></a><span class="al">![5 electrons with the same principal and auxiliary quantum numbers, interacting by the pentagonal dance. Page 502.](figure/atombau_en_p_502.png)</span>{width=50% fig-align="center"}</span>
<span id="cb1-1959"><a href="#cb1-1959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1960"><a href="#cb1-1960" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1961"><a href="#cb1-1961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1962"><a href="#cb1-1962" aria-hidden="true" tabindex="-1"></a>::: {#fig-kramers layout-ncol=1}</span>
<span id="cb1-1963"><a href="#cb1-1963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1964"><a href="#cb1-1964" aria-hidden="true" tabindex="-1"></a>Selections from <span class="co">[</span><span class="ot">@kramersAtomBohrTheory1923</span><span class="co">]</span>.</span>
<span id="cb1-1965"><a href="#cb1-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1966"><a href="#cb1-1966" aria-hidden="true" tabindex="-1"></a><span class="al">![Orbits of the Bohr--Sommerfeld model of the hydrogen atom, labelled by their principal quantum numbers and auxiliary quantum numbers. The jumps from 3&lt;sub&gt;1&lt;/sub&gt;, 3&lt;sub&gt;2&lt;/sub&gt;, 3&lt;sub&gt;3&lt;/sub&gt; to 2&lt;sub&gt;2&lt;/sub&gt; all create the Balmer spectral line H&lt;sub&gt;α&lt;/sub&gt;, but they differ at the fine structure. Figure 27.](figure/fig_27_Kramer_Holst_1923.png)</span>{width=70% fig-align="center"}</span>
<span id="cb1-1967"><a href="#cb1-1967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1968"><a href="#cb1-1968" aria-hidden="true" tabindex="-1"></a><span class="al">![Orbits of the Bohr--Sommerfeld model of the Radium atom. First end plate. I find its fonts classy.](figure/structure_of_the_radium_figure_Kramer_Holst_1923.png)</span></span>
<span id="cb1-1969"><a href="#cb1-1969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1970"><a href="#cb1-1970" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">A modern redrawing. [@holtebekkAtomAtomteori2023]</span><span class="co">](figure/atomteori_vectorized_bohr_atoms.png)</span></span>
<span id="cb1-1971"><a href="#cb1-1971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1972"><a href="#cb1-1972" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1973"><a href="#cb1-1973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1974"><a href="#cb1-1974" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; What we are nowadays hearing of the language of spectra is a true “ music of the spheres ” within the atom, chords of integral relationships, an order and harmony that becomes ever more perfect in spite of the manifold variety. The theory of spectral lines will bear the name of Bohr for all time. But yet another name will be permanently associated with it, that of Planck. All integral laws of spectral lines and of atomic theory spring originally from the quantum theory. It is the mysterious organon on which Nature plays her music of the spectra, and according to the rhythm of which she regulates the structure of the atoms and nuclei.</span></span>
<span id="cb1-1975"><a href="#cb1-1975" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb1-1976"><a href="#cb1-1976" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Preface to the first edition of *Atomic structure and spectral lines*, Arnold Sommerfeld, 1919. </span><span class="co">[</span><span class="ot">@sommerfeldAtomicStructureSpectral1923</span><span class="co">]</span></span>
<span id="cb1-1977"><a href="#cb1-1977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1978"><a href="#cb1-1978" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Einstein---Brillouin--Keller quantization</span></span>
<span id="cb1-1979"><a href="#cb1-1979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1980"><a href="#cb1-1980" aria-hidden="true" tabindex="-1"></a>This topic is quite obscure and hard to find a simple reference for, yet I found it is absolutely necessary to treat this correctly, if only to soothe my mathematical conscience. I wrote it based on <span class="co">[</span><span class="ot">@stoneEinsteinUnknownInsight2005; @duncanConstructingQuantumMechanics2019, chapter 5</span><span class="co">]</span>.</span>
<span id="cb1-1981"><a href="#cb1-1981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1982"><a href="#cb1-1982" aria-hidden="true" tabindex="-1"></a>Let's take a more careful look at the Bohr--Sommerfeld model of a hydrogen atom. The electron orbits a proton, and the equation of motion is spherically symmetric. Therefore, we can write it in spherical coordinates $(r, \theta, \psi)$, where $r$ is the radius, $\theta$ is the co-latitude, and $\psi$ is the longitude. The Bohr--Sommerfeld quantization then states that</span>
<span id="cb1-1983"><a href="#cb1-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1984"><a href="#cb1-1984" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1985"><a href="#cb1-1985" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb1-1986"><a href="#cb1-1986" aria-hidden="true" tabindex="-1"></a>&amp; \oint p_r d r = n_r h <span class="sc">\\</span></span>
<span id="cb1-1987"><a href="#cb1-1987" aria-hidden="true" tabindex="-1"></a>&amp; \oint p_{\theta} d \theta=n_\theta h, <span class="sc">\\</span></span>
<span id="cb1-1988"><a href="#cb1-1988" aria-hidden="true" tabindex="-1"></a>&amp; \oint p_\psi d \psi=n_\psi h .</span>
<span id="cb1-1989"><a href="#cb1-1989" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb1-1990"><a href="#cb1-1990" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-1991"><a href="#cb1-1991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1992"><a href="#cb1-1992" aria-hidden="true" tabindex="-1"></a>for some positive integers $n_r, n_\theta, n_\psi$. However, we notice something deeply unsatisfying: How does the atom "know" which way is the sphere pointing? To define the spherical coordinates, we need to define the direction of the north and south pole. The Bohr--Sommerfeld quantization condition is thus creating an artificial direction in space where none should exist. Worse, if we solve the equations, we would find that this artificial direction has physically measurable consequences.</span>
<span id="cb1-1993"><a href="#cb1-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1994"><a href="#cb1-1994" aria-hidden="true" tabindex="-1"></a>Sommerfeld evaded the difficulty by arguing that as long as there is even a hair of magnetic field $B$ pointing in some direction $\hat z$, we can pick $\hat z$ as the north pole direction, and that since the field strength is nowhere zero, the problem will never occur in practice.</span>
<span id="cb1-1995"><a href="#cb1-1995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1996"><a href="#cb1-1996" aria-hidden="true" tabindex="-1"></a>We see the difficulty inherent in the old quantum theory. Suppose we have a hydrogen atom suspended in free space, then the tiniest change in the external magnetic field would create a large (for the atom, at least) change in its north-pole direction. The <span class="co">[</span><span class="ot">Stern--Gerlach experiment</span><span class="co">](https://en.wikipedia.org/wiki/Stern%E2%80%93Gerlach_experiment)</span>, performed in 1922, experimentally showed that the external field can determine the direction of $\hat z$, and thus the quantization of angular momentum. To see something in classical mechanics so jumpy is disconcerting, and certainly disturbed me greatly when I first understood the Stern--Gerlach experiment. In 4 years, Schrödinger would have proposed his equation, Heisenberg his matrix mechanics, and old quantum theory washed away by the new quantum mechanics.</span>
<span id="cb1-1997"><a href="#cb1-1997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1998"><a href="#cb1-1998" aria-hidden="true" tabindex="-1"></a>Einstein, in his only paper on the old quantum mechanics,<span class="ot">[^einstein-1916]</span> elegantly resolved the problem by using the <span class="co">[</span><span class="ot">Poincaré--Cartan integral invariant</span><span class="co">](@thm-poincare-cartan)</span> to construct quantization equations that do not depend on our arbitrary choices of coordinate systems.</span>
<span id="cb1-1999"><a href="#cb1-1999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2000"><a href="#cb1-2000" aria-hidden="true" tabindex="-1"></a><span class="ot">[^einstein-1916]: </span><span class="co">[</span><span class="ot">@einsteinQuantensatzSommerfeldUnd1917</span><span class="co">]</span>, reprinted and translated in <span class="co">[</span><span class="ot">@einsteinCollectedPapersAlbert1997, volume 6, pages 434--444</span><span class="co">]</span>.</span>
<span id="cb1-2001"><a href="#cb1-2001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2002"><a href="#cb1-2002" aria-hidden="true" tabindex="-1"></a>As we saw with @exr-zero-poincare-cartan, a contractable loop on the torus integrates to zero. Thus, we can attach and detach contractible loops at will, deform the cycle arbitrarily, and still get the same number. That is, the integral is determined by the topology of the cycle, not the exact shape of the cycle.<span class="ot">[^homology-torus]</span> This gives us the Einstein quantization:</span>
<span id="cb1-2003"><a href="#cb1-2003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2004"><a href="#cb1-2004" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-2005"><a href="#cb1-2005" aria-hidden="true" tabindex="-1"></a>\oint_{\gamma_i} \lra{p, dq} = n_i h</span>
<span id="cb1-2006"><a href="#cb1-2006" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-2007"><a href="#cb1-2007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2008"><a href="#cb1-2008" aria-hidden="true" tabindex="-1"></a>where $\gamma_1, \dots, \gamma_d$ range over the $d$ topologically distinct loops around the $n$-dimensional torus in phase space, and $n_1, \dots, n_d$ are positive integers. This was later modified by Brillouin and Keller to take account of singularities in the trajectory, such as a hard wall reflector, giving us the <span class="co">[</span><span class="ot">EBK quantization</span><span class="co">](https://en.wikipedia.org/wiki/Einstein%E2%80%93Brillouin%E2%80%93Keller_method)</span>.</span>
<span id="cb1-2009"><a href="#cb1-2009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2010"><a href="#cb1-2010" aria-hidden="true" tabindex="-1"></a><span class="ot">[^homology-torus]: </span>In the jargon of topology, this is a linear function on $T^d$, <span class="co">[</span><span class="ot">the homology group of the torus</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Homology_(mathematics)). Here, $d$ is the dimension of the torus.</span>
<span id="cb1-2011"><a href="#cb1-2011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2012"><a href="#cb1-2012" aria-hidden="true" tabindex="-1"></a><span class="al">![A particle moving in a central potential. Its angular momentum $p_\theta$ is conserved, so we do not plot it. Plotting its other three phase-space variables $(r, \theta, p_r)$, we see that its orbit makes a spiralling and rotating pattern on a torus. There are two fundamental ways to cycle around the torus, and each has a corresponding Poincaré--Cartan integral that is independent of the precise shape of the cycle. Both integrals are quantized. This is the meaning of the EBK quantization.](figure/EBK_quantization.jpg)</span></span>
<span id="cb1-2013"><a href="#cb1-2013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2014"><a href="#cb1-2014" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb1-2015"><a href="#cb1-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2016"><a href="#cb1-2016" aria-hidden="true" tabindex="-1"></a>The EBK quantization resembles the Bohr--Sommerfeld quantization condition, but it is quite different. In the Bohr--Sommerfeld quantization condition, the integral $\oint p_i dq_i$ integrates over a cycle of *physically real* trajectory in phase space. In EBK quantization, the integral $\oint_{\gamma_i} \lra{p, dq}$ integrates over a *geometric* cycle in phase space with *no physical reality at all*.</span>
<span id="cb1-2017"><a href="#cb1-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2018"><a href="#cb1-2018" aria-hidden="true" tabindex="-1"></a>Both conditions happen to be the same when we have a 1D oscillator, but that is because the only way to *physically* go around the torus is the only way to *geometrically* go around the torus. It is a misleading coincidence.</span>
<span id="cb1-2019"><a href="#cb1-2019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2020"><a href="#cb1-2020" aria-hidden="true" tabindex="-1"></a>In general, the physically real trajectories look like a braiding on the torus, and are not even closed cycles. They definitely do *not* go around the torus exactly once in exactly one direction.</span>
<span id="cb1-2021"><a href="#cb1-2021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2022"><a href="#cb1-2022" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-2023"><a href="#cb1-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2024"><a href="#cb1-2024" aria-hidden="true" tabindex="-1"></a>There is only one problem left: What happens when we don't have a torus? It is all well and good when we can construct a torus in phase space with as many dimensions as possible. However, when we have a classically chaotic system, such as the three-body problem, we cannot have something this simple.</span>
<span id="cb1-2025"><a href="#cb1-2025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2026"><a href="#cb1-2026" aria-hidden="true" tabindex="-1"></a>Consider the simplest case of the three-body problem: We put two suns in a circular orbit around each other, and a speck of dust orbiting them. The two suns' orbit is perfectly predictable, so we consider only the trajectory of the dust. We also assume the dust only moves in the plane of the suns. Thus, the system has only 2 dimensions of configuration, or 4 dimensions of phase.</span>
<span id="cb1-2027"><a href="#cb1-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2028"><a href="#cb1-2028" aria-hidden="true" tabindex="-1"></a>As the energy of the system is conserved, the motion of the dust is restricted to the constant energy surface $H(q_1, q_2, p_1 p_2) = E$, which is a 3-dimensional blob within the 4-dimensional phase space. However, in general, this is all we can say about it. The motion of the dust is chaotic, and would densely crisscross over a 3-dimensional subset of the blob.</span>
<span id="cb1-2029"><a href="#cb1-2029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2030"><a href="#cb1-2030" aria-hidden="true" tabindex="-1"></a>Without a torus in phase space, we cannot find trajectories around the torus, and so the integral $\oint_{\gamma}\lra{p, dq}$ is undefined. Einstein presciently pointed this out in his 1916 paper:</span>
<span id="cb1-2031"><a href="#cb1-2031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2032"><a href="#cb1-2032" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; If there exist fewer than $d$ </span><span class="sc">\[</span><span class="at">constants of motion</span><span class="sc">\]</span><span class="at">, as is the case, for example, according to Poincaré in the three-body problem, then the $p_i$ are not expressible by the $q_i$ and the quantum condition of Sommerfeld-Epstein fails also in the slightly generalized form that has been given here.</span></span>
<span id="cb1-2033"><a href="#cb1-2033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2034"><a href="#cb1-2034" aria-hidden="true" tabindex="-1"></a>This failure of the EBK quantization on classically chaotic systems was forgotten for many years, but eventually rediscovered.<span class="ot">[^einstein-quantum-chaos]</span> When it did, it became a seed of <span class="co">[</span><span class="ot">quantum chaos</span><span class="co">](https://en.wikipedia.org/wiki/Quantum_chaos)</span>, which I hope to explain clearly some day. In the mean time, I leave you with some beautiful pictures of quantum chaos instead.</span>
<span id="cb1-2035"><a href="#cb1-2035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2036"><a href="#cb1-2036" aria-hidden="true" tabindex="-1"></a><span class="ot">[^einstein-quantum-chaos]: </span>See <span class="co">[</span><span class="ot">@stoneEinsteinUnknownInsight2005</span><span class="co">]</span> for a brief history and more cool pictures. It was written in 2005, the "Einstein Year", the 100th anniversary of Einstein's *annus mirabilis*.</span>
<span id="cb1-2037"><a href="#cb1-2037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2038"><a href="#cb1-2038" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">The nonchaotic quantum circular billiard and the chaotic quantum cardioid billiard. Figure from [@backerQuantumChaosBilliards2007]</span><span class="co">](figure/chaotic_integrable_quantum_billiard.png)</span></span>
<span id="cb1-2039"><a href="#cb1-2039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2040"><a href="#cb1-2040" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">In a chaotic quantum "stadium" billiard, the standing wave functions look dark along certain lines. You can think of them as taking a classical billiard table, and using a knife to cut along the classical trajectories. The scars left behind are the [quantum scars](https://en.wikipedia.org/wiki/Quantum_scar) of departed classicality. Figure from [@kingExploringQuantumClassical2014]</span><span class="co">](figure/king_2009_quantum_scars.png)</span></span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block">Yuxi on the Wired</span></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><span class="faux-block">Everything <a href="https://en.wikipedia.org/wiki/Public_domainl">PD</a>; <a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode.en/">CC0</a> fallback.</span></p>
</div>
  </div>
</footer>




</body></html>